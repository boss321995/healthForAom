import React, { useState, useRef, useEffect } from 'react';
import axios from 'axios';
import { useAuth } from '../contexts/AuthContext';

const HealthChatbot = ({ userProfile, recentMetrics = [] }) => {
  const { token: authToken } = useAuth();
  const [assistantStatus, setAssistantStatus] = useState({
    mode: 'online',
    engine: 'Gemini',
    reason: null
  });
  const [lastAiError, setLastAiError] = useState(null);
  const [isOpen, setIsOpen] = useState(false);
  const [messages, setMessages] = useState([
    {
      id: 1,
      text: userProfile?.medical_conditions || userProfile?.medications
        ? `‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏ú‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û üè• ‡∏ú‡∏°‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ${userProfile?.medical_conditions ? '‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß' : ''}${userProfile?.medical_conditions && userProfile?.medications ? '‡πÅ‡∏•‡∏∞' : ''}${userProfile?.medications ? '‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡∏≤‡∏ô' : ''} ‡∏ú‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏±‡∏ö\n\n‡∏•‡∏≠‡∏á‡∏ñ‡∏≤‡∏°‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á "‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô" ‡∏´‡∏£‡∏∑‡∏≠ "‡∏â‡∏±‡∏ô‡∏Ñ‡∏ß‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£" ‡∏î‡∏π‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö üòä`
        : '‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏ú‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û üè• ‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏´‡∏°‡∏Ñ‡∏£‡∏±‡∏ö?\n\n‡∏•‡∏≠‡∏á‡∏ñ‡∏≤‡∏° "‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô" ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö üòä',
      sender: 'bot',
      timestamp: new Date()
    }
  ]);
  const [inputText, setInputText] = useState('');
  const [isTyping, setIsTyping] = useState(false);
  const messagesEndRef = useRef(null);

  const scrollToBottom = () => {
    messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
  };

  useEffect(scrollToBottom, [messages]);

  const quickResponses = [
    '‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?',
    '‡∏â‡∏±‡∏ô‡∏Ñ‡∏ß‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?',
    '‡∏¢‡∏≤‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô‡∏Å‡∏¥‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?',
    '‡∏Ñ‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?',
    '‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏â‡∏±‡∏ô',
    '‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏â‡∏±‡∏ô',
    '‡∏•‡∏î‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?',
    '‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏Å‡∏¥‡∏ô',
    '‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏î‡∏µ',
    '‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î',
    '‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à',
    '‡∏î‡∏π‡πÅ‡∏•‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á',
    '‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢',
    '‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û',
    '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£?',
    '‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏§‡∏î‡∏π‡∏ù‡∏ô',
    '‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏û‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£',
    '‡∏Å‡∏≤‡∏£‡∏ü‡∏∑‡πâ‡∏ô‡∏ü‡∏π‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢'
  ];

  const getAuthToken = () => {
    return authToken ?? localStorage.getItem('healthToken');
  };

  const buildConversationHistory = (historyMessages = [], newUserText = '') => {
    const trimmed = newUserText.trim();
    const recentHistory = historyMessages
      .slice(-8)
      .map((msg) => ({
        role: msg.sender === 'user' ? 'user' : 'assistant',
        content: msg.text
      }));

    if (trimmed) {
      recentHistory.push({ role: 'user', content: trimmed });
    }

    return recentHistory;
  };

  const requestAiResponse = async (userText, conversation) => {
    const token = getAuthToken();
    if (!token) {
      throw new Error('missing_token');
    }

    const response = await axios.post(
      '/api/health-analytics/chat',
      {
        message: userText,
        history: conversation
      },
      {
        headers: {
          Authorization: `Bearer ${token}`
        }
      }
    );

    return response.data;
  };

  const getHealthAdvice = (userMessage) => {
    const message = userMessage.toLowerCase();
    
    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß
    const hasCondition = (condition) => {
      const medicalConditions = userProfile?.medical_conditions?.toLowerCase() || '';
      if (condition === '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á') {
        return medicalConditions.includes('‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á') || 
               medicalConditions.includes('‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï‡∏™‡∏π‡∏á') ||
               medicalConditions.includes('hypertension') ||
               medicalConditions.includes('‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô');
      }
      if (condition === '‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô') {
        return medicalConditions.includes('‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô') || 
               medicalConditions.includes('diabetes') ||
               medicalConditions.includes('‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡πÉ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏™‡∏π‡∏á');
      }
      return medicalConditions.includes(condition.toLowerCase());
    };
    
    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ
    const takingMedication = (medication) => {
      return userProfile?.medications?.toLowerCase().includes(medication.toLowerCase()) || false;
    };
    
    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
    const getLatestMetrics = () => {
      return {
        weight: recentMetrics.find(m => m.weight_kg)?.weight_kg,
        systolic: recentMetrics.find(m => m.systolic_bp)?.systolic_bp,
        diastolic: recentMetrics.find(m => m.diastolic_bp)?.diastolic_bp,
        heartRate: recentMetrics.find(m => m.heart_rate)?.heart_rate,
        bloodSugar: recentMetrics.find(m => m.blood_sugar)?.blood_sugar
      };
    };
    
    // ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
    if (message.includes('‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô') || message.includes('‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏ú‡∏°') || message.includes('‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏î‡∏¥‡∏â‡∏±‡∏ô') || 
        message.includes('‡∏™‡∏†‡∏≤‡∏û‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û') || message.includes('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û') || message.includes('‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û')) {
      
      const latest = getLatestMetrics();
      let response = 'üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:\n\n';
      
      // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß
      if (userProfile?.medical_conditions) {
        response += `üè• ‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß: ${userProfile.medical_conditions}\n`;
      }
      
      if (userProfile?.medications) {
        response += `üíä ‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡∏≤‡∏ô: ${userProfile.medications}\n`;
      }
      
      response += '\nüìà ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:\n';
      
      // ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å
      if (latest.weight && userProfile?.height_cm) {
        const bmi = (latest.weight / Math.pow(userProfile.height_cm / 100, 2)).toFixed(1);
        let bmiStatus = '';
        if (bmi < 18.5) bmiStatus = '‡∏ú‡∏≠‡∏°‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ';
        else if (bmi < 25) bmiStatus = '‡∏õ‡∏Å‡∏ï‡∏¥';
        else if (bmi < 30) bmiStatus = '‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô';
        else bmiStatus = '‡∏≠‡πâ‡∏ß‡∏ô';
        
        response += `‚öñÔ∏è ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å: ${latest.weight} ‡∏Å‡∏Å. (BMI: ${bmi} - ${bmiStatus})\n`;
      }
      
      // ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô
      if (latest.systolic && latest.diastolic) {
        let bpStatus = '';
        if (latest.systolic < 120 && latest.diastolic < 80) bpStatus = '‡∏õ‡∏Å‡∏ï‡∏¥';
        else if (latest.systolic < 130 && latest.diastolic < 80) bpStatus = '‡∏™‡∏π‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢';
        else if (latest.systolic < 140 || latest.diastolic < 90) bpStatus = '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á‡∏£‡∏∞‡∏¢‡∏∞ 1';
        else bpStatus = '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á‡∏£‡∏∞‡∏¢‡∏∞ 2';
        
        response += `üíó ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô: ${latest.systolic}/${latest.diastolic} mmHg (${bpStatus})\n`;
      }
      
      // ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•
      if (latest.bloodSugar) {
        let sugarStatus = '';
        if (latest.bloodSugar < 100) sugarStatus = '‡∏õ‡∏Å‡∏ï‡∏¥';
        else if (latest.bloodSugar < 126) sugarStatus = '‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô';
        else sugarStatus = '‡∏™‡∏π‡∏á‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥';
        
        response += `üçØ ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•: ${latest.bloodSugar} mg/dL (${sugarStatus})\n`;
      }
      
      // ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏´‡∏±‡∏ß‡πÉ‡∏à
      if (latest.heartRate) {
        let hrStatus = '';
        if (latest.heartRate < 60) hrStatus = '‡∏ä‡πâ‡∏≤‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥';
        else if (latest.heartRate <= 100) hrStatus = '‡∏õ‡∏Å‡∏ï‡∏¥';
        else hrStatus = '‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥';
        
        response += `üíì ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡πâ‡∏ô‡∏´‡∏±‡∏ß‡πÉ‡∏à: ${latest.heartRate} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ô‡∏≤‡∏ó‡∏µ (${hrStatus})\n`;
      }
      
      // ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•
      response += '\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì:\n';
      
      if (hasCondition('‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á')) {
        response += '‚Ä¢ ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÉ‡∏´‡πâ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 140/90 mmHg\n';
        response += '‚Ä¢ ‡∏•‡∏î‡πÄ‡∏Å‡∏•‡∏∑‡∏≠ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏õ‡∏£‡∏£‡∏π‡∏õ\n';
        response += '‚Ä¢ ‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠ 30 ‡∏ô‡∏≤‡∏ó‡∏µ/‡∏ß‡∏±‡∏ô\n';
        response += '‚Ä¢ ‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤ ‡πÑ‡∏°‡πà‡∏Ç‡πâ‡∏≤‡∏°‡∏°‡∏∑‡πâ‡∏≠\n';
        response += '‚Ä¢ ‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô\n';
      } else if (hasCondition('‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô')) {
        response += '‚Ä¢ ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ 80-130 mg/dL\n';
        response += '‚Ä¢ ‡∏Å‡∏¥‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Ç‡∏ô‡∏°‡∏´‡∏ß‡∏≤‡∏ô\n';
        response += '‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥\n';
        response += '‚Ä¢ ‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ 30 ‡∏ô‡∏≤‡∏ó‡∏µ\n';
      } else {
        response += '‚Ä¢ ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏î‡∏µ‡∏ï‡πà‡∏≠‡πÑ‡∏õ ‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠\n';
        response += '‚Ä¢ ‡∏Å‡∏¥‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£ 5 ‡∏´‡∏°‡∏π‡πà ‡πÉ‡∏ô‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°\n';
        response += '‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥\n';
      }
      
      response += '\n‚ö†Ô∏è ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥ ‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå';
      
      return response;
    }
    
    // ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•
    if (message.includes('‡∏î‡∏π‡πÅ‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û') || message.includes('‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û') || message.includes('‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÇ‡∏£‡∏Ñ')) {
      let response = 'üåü ‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì:\n\n';
      
      if (hasCondition('‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô')) {
        response += 'üçØ ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô:\n';
        response += '‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£ ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô\n';
        response += '‚Ä¢ ‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤ ‡πÑ‡∏°‡πà‡∏Ç‡πâ‡∏≤‡∏°‡∏°‡∏∑‡πâ‡∏≠\n';
        response += '‚Ä¢ ‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ 30 ‡∏ô‡∏≤‡∏ó‡∏µ\n';
        response += '‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à HbA1c ‡∏ó‡∏∏‡∏Å 3 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô\n\n';
      }
      
      if (hasCondition('‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á')) {
        response += 'üíó ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á:\n';
        response += '‚Ä¢ ‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏î‡∏¥‡∏°\n';
        response += '‚Ä¢ ‡∏•‡∏î‡πÄ‡∏Å‡∏•‡∏∑‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 6 ‡∏Å‡∏£‡∏±‡∏°/‡∏ß‡∏±‡∏ô\n';
        response += '‚Ä¢ ‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏£‡πá‡∏ß 30 ‡∏ô‡∏≤‡∏ó‡∏µ ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô\n';
        response += '‚Ä¢ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î\n\n';
      }
      
      if (hasCondition('‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à')) {
        response += 'üíì ‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à:\n';
        response += '‚Ä¢ ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡πâ‡∏ô‡∏´‡∏±‡∏ß‡πÉ‡∏à\n';
        response += '‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ\n';
        response += '‚Ä¢ ‡∏•‡∏î‡πÑ‡∏Ç‡∏°‡∏±‡∏ô‡∏≠‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏±‡∏Å‡∏ú‡∏•‡πÑ‡∏°‡πâ\n';
        response += '‚Ä¢ ‡∏û‡∏Å‡∏¢‡∏≤‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡∏ß\n\n';
      }
      
      // ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
      response += 'üå± ‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ:\n';
      response += '‚Ä¢ ‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö 7-8 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á/‡∏ß‡∏±‡∏ô\n';
      response += '‚Ä¢ ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥ 8-10 ‡πÅ‡∏Å‡πâ‡∏ß/‡∏ß‡∏±‡∏ô\n';
      response += '‚Ä¢ ‡∏Å‡∏¥‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Ñ‡∏£‡∏ö 5 ‡∏´‡∏°‡∏π‡πà\n';
      response += '‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ\n';
      response += '‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà ‡πÅ‡∏≠‡∏•‡∏Å‡∏≠‡∏Æ‡∏≠‡∏•‡πå';
      
      return response;
    }
    
    // ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≤‡∏ô‡∏¢‡∏≤
    if (message.includes('‡∏¢‡∏≤‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô') || message.includes('‡∏Å‡∏≤‡∏£‡∏ó‡∏≤‡∏ô‡∏¢‡∏≤') || message.includes('‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡∏≤‡∏ô')) {
      let response = 'üíä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏≤‡∏ô‡∏¢‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:\n\n';
      
      if (!userProfile?.medications) {
        return '‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡∏≤‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå';
      }
      
      response += `üî∏ ‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡∏≤‡∏ô: ${userProfile.medications}\n\n`;
      
      if (takingMedication('amlodipine')) {
        response += '‚Ä¢ Amlodipine: ‡∏ó‡∏≤‡∏ô‡πÄ‡∏ä‡πâ‡∏≤ ‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ 1 ‡πÄ‡∏°‡πá‡∏î\n';
        response += '  - ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ö‡∏ß‡∏° ‡∏ß‡∏¥‡∏á‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô\n';
        response += '  - ‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≤‡∏ô‡∏¢‡∏≤\n\n';
      }
      
      if (takingMedication('metformin')) {
        response += '‚Ä¢ Metformin: ‡∏ó‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ ‡πÄ‡∏ä‡πâ‡∏≤-‡πÄ‡∏¢‡πá‡∏ô\n';
        response += '  - ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å\n';
        response += '  - ‡∏ï‡∏£‡∏ß‡∏à‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≤‡∏ô‡∏¢‡∏≤\n\n';
      }
      
      response += '‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô:\n';
      response += '‚Ä¢ ‡∏ó‡∏≤‡∏ô‡∏¢‡∏≤‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô\n';
      response += '‚Ä¢ ‡πÑ‡∏°‡πà‡∏´‡∏¢‡∏∏‡∏î‡∏¢‡∏≤‡πÄ‡∏≠‡∏á‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå\n';
      response += '‚Ä¢ ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏ú‡∏•‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á ‡πÅ‡∏à‡πâ‡∏á‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ\n';
      response += '‚Ä¢ ‡πÄ‡∏Å‡πá‡∏ö‡∏¢‡∏≤‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏´‡πâ‡∏á ‡πÄ‡∏¢‡πá‡∏ô ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏™‡∏á';
      
      return response;
    }
    
    // ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥
    if (message.includes('‡∏Ñ‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥') || message.includes('‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏õ‡∏Å‡∏ï‡∏¥') || message.includes('‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô')) {
      const latest = getLatestMetrics();
      let response = 'üìä ‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Ñ‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:\n\n';
      
      response += '‚öñÔ∏è ‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (BMI):\n';
      response += '‚Ä¢ ‡∏õ‡∏Å‡∏ï‡∏¥: 18.5-24.9\n';
      if (latest.weight && userProfile?.height_cm) {
        const bmi = (latest.weight / Math.pow(userProfile.height_cm / 100, 2)).toFixed(1);
        response += `‚Ä¢ ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: ${bmi}\n`;
      }
      
      response += '\nüíó ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï:\n';
      response += '‚Ä¢ ‡∏õ‡∏Å‡∏ï‡∏¥: ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 120/80 mmHg\n';
      response += '‚Ä¢ ‡∏™‡∏π‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢: 120-129/<80 mmHg\n';
      response += '‚Ä¢ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á: ‚â•130/80 mmHg\n';
      if (latest.systolic && latest.diastolic) {
        response += `‚Ä¢ ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: ${latest.systolic}/${latest.diastolic} mmHg\n`;
      }
      
      response += '\nüçØ ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡πÉ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î:\n';
      response += '‚Ä¢ ‡∏õ‡∏Å‡∏ï‡∏¥ (‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£): 70-99 mg/dL\n';
      response += '‚Ä¢ ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô: 100-125 mg/dL\n';
      response += '‚Ä¢ ‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô: ‚â•126 mg/dL\n';
      if (latest.bloodSugar) {
        response += `‚Ä¢ ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: ${latest.bloodSugar} mg/dL\n`;
      }
      
      response += '\nüíì ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡πâ‡∏ô‡∏´‡∏±‡∏ß‡πÉ‡∏à:\n';
      response += '‚Ä¢ ‡∏õ‡∏Å‡∏ï‡∏¥: 60-100 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ô‡∏≤‡∏ó‡∏µ\n';
      if (latest.heartRate) {
        response += `‚Ä¢ ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: ${latest.heartRate} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ô‡∏≤‡∏ó‡∏µ\n`;
      }
      
      return response;
    }
    
    // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ - ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•
    if (message.includes('amlodipine') || message.includes('amlopine') || message.includes('‡πÅ‡∏≠‡∏°‡πÇ‡∏•‡∏î‡∏¥‡∏õ‡∏µ‡∏ô')) {
      let response = 'Amlodipine (‡πÅ‡∏≠‡∏°‡πÇ‡∏•‡∏î‡∏¥‡∏õ‡∏µ‡∏ô) - ‡∏¢‡∏≤‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï: \nüíä ‡∏Å‡∏•‡∏∏‡πà‡∏°: Calcium Channel Blocker \nüéØ ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï‡∏™‡∏π‡∏á, ‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ç‡∏≤‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏î \n‚è∞ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ: ‡∏ß‡∏±‡∏ô‡∏•‡∏∞ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏Ñ‡∏ß‡∏£‡∏Å‡∏¥‡∏ô‡∏ï‡∏≠‡∏ô‡πÄ‡∏ä‡πâ‡∏≤ \n‚ö†Ô∏è ‡∏ú‡∏•‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á: ‡πÉ‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏ß‡∏° ‡∏Ç‡∏≤‡∏ö‡∏ß‡∏° ‡∏ß‡∏¥‡∏á‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô \n‚ùó ‡∏´‡πâ‡∏≤‡∏°‡∏´‡∏¢‡∏∏‡∏î‡∏¢‡∏≤‡πÄ‡∏≠‡∏á‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå';
      
      if (takingMedication('amlodipine')) {
        response += '\n\nüë§ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏â‡∏û‡∏≤‡∏∞:\n‚Ä¢ ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠\n‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏∏‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô‡∏¢‡∏∑‡∏ô‡πÄ‡∏£‡πá‡∏ß‡πÜ\n‚Ä¢ ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠\n‚Ä¢ ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ö‡∏ß‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô ‡∏Ñ‡∏ß‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÅ‡∏û‡∏ó‡∏¢‡πå';
      }
      
      return response;
    }
    
    if (message.includes('tb') || message.includes('‡∏ß‡∏±‡∏ì‡πÇ‡∏£‡∏Ñ') || message.includes('‡∏¢‡∏≤‡∏ß‡∏±‡∏ì‡πÇ‡∏£‡∏Ñ')) {
      let response = '‡∏¢‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ß‡∏±‡∏ì‡πÇ‡∏£‡∏Ñ - ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏¥‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏Å‡∏≥‡∏´‡∏ô‡∏î: \nüíä ‡∏¢‡∏≤‡∏´‡∏•‡∏±‡∏Å: Isoniazid, Rifampin, Ethambutol, Pyrazinamide \n‚è∞ ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤: ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 6-9 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô \nüçΩÔ∏è ‡∏Ñ‡∏ß‡∏£‡∏Å‡∏¥‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡πâ‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á (‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£ 1 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á) \n‚ö†Ô∏è ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å: ‡∏´‡πâ‡∏≤‡∏°‡∏´‡∏¢‡∏∏‡∏î‡∏¢‡∏≤‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏±‡∏ô ‡πÅ‡∏°‡πâ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô \nüè• ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Å‡∏±‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠';
      
      if (hasCondition('‡∏ß‡∏±‡∏ì‡πÇ‡∏£‡∏Ñ') || hasCondition('tb') || takingMedication('isoniazid') || takingMedication('rifampin')) {
        response += '\n\nüë§ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏â‡∏û‡∏≤‡∏∞:\n‚Ä¢ ‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡πÄ‡∏°‡πá‡∏î‡∏ï‡∏≤‡∏°‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏™‡∏±‡πà‡∏á\n‚Ä¢ ‡πÅ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ú‡πâ‡∏≤‡πÄ‡∏ä‡πá‡∏î‡∏´‡∏ô‡πâ‡∏≤ ‡πÅ‡∏Å‡πâ‡∏ß ‡∏ä‡πâ‡∏≠‡∏ô‡∏™‡πâ‡∏≠‡∏°\n‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏≠‡∏•‡∏Å‡∏≠‡∏Æ‡∏≠‡∏•‡πå\n‚Ä¢ ‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠\n‚Ä¢ ‡∏Å‡∏¥‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô‡∏™‡∏π‡∏á';
      }
      
      return response;
    }
    
    if (message.includes('metformin') || message.includes('‡πÄ‡∏°‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏¥‡∏ô') || message.includes('‡∏¢‡∏≤‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô')) {
      let response = 'Metformin (‡πÄ‡∏°‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏¥‡∏ô) - ‡∏¢‡∏≤‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô‡∏ä‡∏ô‡∏¥‡∏î 2: \nüíä ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö: ‡∏•‡∏î‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡πÉ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î ‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏î‡∏π‡∏î‡∏ã‡∏∂‡∏°‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏• \nüçΩÔ∏è ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ: ‡∏Å‡∏¥‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ \n‚ö†Ô∏è ‡∏ú‡∏•‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á: ‡∏ó‡πâ‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢ ‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡πÑ‡∏™‡πâ‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÅ‡∏£‡∏Å \n‚úÖ ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏ï‡πà‡∏≥‡πÄ‡∏≠‡∏á‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß \nüí° ‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢';
      
      if (hasCondition('‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô') || hasCondition('diabetes') || takingMedication('metformin')) {
        const latestSugar = recentMetrics.find(m => m.blood_sugar);
        response += '\n\nüë§ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏â‡∏û‡∏≤‡∏∞:\n‚Ä¢ ‡∏Å‡∏¥‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤ 3 ‡∏°‡∏∑‡πâ‡∏≠‡∏´‡∏•‡∏±‡∏Å\n‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏´‡∏ß‡∏≤‡∏ô ‡πÅ‡∏õ‡πâ‡∏á\n‚Ä¢ ‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠\n‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥';
        
        if (latestSugar && latestSugar.blood_sugar > 140) {
          response += '\n‚ö†Ô∏è ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ' + latestSugar.blood_sugar + ' mg/dL ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥ ‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£';
        }
      }
      
      return response;
    }
    
    // ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ - ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏™‡∏†‡∏≤‡∏û‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•
    if (message.includes('‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô') || message.includes('blood pressure')) {
      let response = '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï‡∏õ‡∏Å‡∏ï‡∏¥: \n‚Ä¢ ‡∏õ‡∏Å‡∏ï‡∏¥: ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 120/80 mmHg \n‚Ä¢ ‡∏™‡∏π‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢: 120-129/<80 mmHg \n‚Ä¢ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á‡∏£‡∏∞‡∏¢‡∏∞ 1: 130-139/80-89 mmHg \n‚Ä¢ ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠ \n‚ö†Ô∏è ‡∏´‡∏≤‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô 140/90 ‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á ‡∏Ñ‡∏ß‡∏£‡∏û‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå';
      
      if (hasCondition('‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á') || hasCondition('hypertension') || takingMedication('amlodipine')) {
        const latestBP = recentMetrics.find(m => m.systolic_bp && m.diastolic_bp);
        response += '\n\nüë§ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏â‡∏û‡∏≤‡∏∞:\n‚Ä¢ ‡∏•‡∏î‡πÄ‡∏Å‡∏•‡∏∑‡∏≠‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏õ‡∏£‡∏£‡∏π‡∏õ\n‚Ä¢ ‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡πÄ‡∏ö‡∏≤‡πÜ ‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠\n‚Ä¢ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î\n‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô';
        
        if (latestBP && (latestBP.systolic_bp >= 140 || latestBP.diastolic_bp >= 90)) {
          response += `\n‚ö†Ô∏è ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ${latestBP.systolic_bp}/${latestBP.diastolic_bp} ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥ ‡∏Ñ‡∏ß‡∏£‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤`;
        }
      }
      
      return response;
    }
    
    if (message.includes('‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•') || message.includes('sugar') || message.includes('‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô')) {
      let response = '‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡πÉ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏õ‡∏Å‡∏ï‡∏¥: \n‚Ä¢ ‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£: 70-99 mg/dL \n‚Ä¢ ‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ 2 ‡∏ä‡∏°: ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 140 mg/dL \n‚Ä¢ HbA1c: ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 5.7% \nüçé ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡πÅ‡∏•‡∏∞‡πÅ‡∏õ‡πâ‡∏á \n‚ö†Ô∏è ‡∏´‡∏≤‡∏Å‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô 126 mg/dL ‡∏Ñ‡∏ß‡∏£‡∏û‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå';
      
      if (hasCondition('‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô') || hasCondition('diabetes')) {
        const latestSugar = recentMetrics.find(m => m.blood_sugar);
        response += '\n\nÔøΩ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏â‡∏û‡∏≤‡∏∞:\n‚Ä¢ ‡∏Å‡∏¥‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡∏Å‡∏•‡πâ‡∏≠‡∏á ‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á‡πÇ‡∏Æ‡∏•‡∏ß‡∏µ‡∏ó\n‚Ä¢ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏±‡∏Å‡πÉ‡∏ö‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß\n‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏´‡∏ß‡∏≤‡∏ô‡∏à‡∏±‡∏î\n‚Ä¢ ‡πÅ‡∏ö‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô 5-6 ‡∏°‡∏∑‡πâ‡∏≠‡πÄ‡∏•‡πá‡∏Å';
        
        if (latestSugar) {
          if (latestSugar.blood_sugar > 180) {
            response += `\nüö® ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î ${latestSugar.blood_sugar} mg/dL ‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å ‡∏Ñ‡∏ß‡∏£‡∏û‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏î‡πà‡∏ß‡∏ô`;
          } else if (latestSugar.blood_sugar > 140) {
            response += `\n‚ö†Ô∏è ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î ${latestSugar.blood_sugar} mg/dL ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥ ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£`;
          }
        }
      }
      
      return response;
    }
    
    // ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°
    if (message.includes('‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞') || message.includes('‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏â‡∏±‡∏ô') || message.includes('‡∏Ñ‡∏ß‡∏£‡∏Å‡∏¥‡∏ô‡∏≠‡∏∞‡πÑ‡∏£')) {
      let response = 'üçΩÔ∏è ‡πÅ‡∏ú‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì:\n\n';
      
      if (hasCondition('‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô')) {
        response += 'üçØ ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô:\n';
        response += '‚úÖ ‡∏Ñ‡∏ß‡∏£‡∏Å‡∏¥‡∏ô:\n';
        response += '‚Ä¢ ‡∏Ç‡πâ‡∏≤‡∏ß‡∏Å‡∏•‡πâ‡∏≠‡∏á ‡∏Ç‡πâ‡∏≤‡∏ß‡∏ã‡πâ‡∏≠‡∏°‡∏°‡∏∑‡∏≠\n';
        response += '‚Ä¢ ‡∏ú‡∏±‡∏Å‡πÉ‡∏ö‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏°\n';
        response += '‚Ä¢ ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏õ‡∏•‡∏≤ ‡πÑ‡∏Å‡πà‡πÑ‡∏°‡πà‡∏ï‡∏¥‡∏î‡∏´‡∏ô‡∏±‡∏á\n';
        response += '‚Ä¢ ‡∏ñ‡∏±‡πà‡∏ß‡πÄ‡∏°‡∏•‡πá‡∏î‡πÅ‡∏´‡πâ‡∏á\n';
        response += '‚Ä¢ ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏£‡∏™‡πÄ‡∏õ‡∏£‡∏µ‡πâ‡∏¢‡∏ß (‡πÅ‡∏≠‡∏õ‡πÄ‡∏õ‡∏¥‡πâ‡∏• ‡∏™‡πâ‡∏°)\n\n';
        response += '‚ùå ‡∏Ñ‡∏ß‡∏£‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á:\n';
        response += '‚Ä¢ ‡∏Ç‡πâ‡∏≤‡∏ß‡∏Ç‡∏≤‡∏ß ‡πÅ‡∏õ‡πâ‡∏á‡∏Ç‡∏≤‡∏ß\n';
        response += '‚Ä¢ ‡∏Ç‡∏ô‡∏°‡∏´‡∏ß‡∏≤‡∏ô ‡∏ô‡πâ‡∏≥‡∏≠‡∏±‡∏î‡∏•‡∏°\n';
        response += '‚Ä¢ ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏´‡∏ß‡∏≤‡∏ô (‡∏ó‡∏∏‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏≠‡∏á‡∏∏‡πà‡∏ô)\n';
        response += '‚Ä¢ ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏≠‡∏î ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏õ‡∏£‡∏£‡∏π‡∏õ\n\n';
      }
      
      if (hasCondition('‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á')) {
        response += 'üíó ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á:\n';
        response += '‚úÖ ‡∏Ñ‡∏ß‡∏£‡∏Å‡∏¥‡∏ô:\n';
        response += '‚Ä¢ ‡∏ú‡∏±‡∏Å‡πÉ‡∏ö‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏™‡∏î\n';
        response += '‚Ä¢ ‡∏õ‡∏•‡∏≤‡∏ó‡∏∞‡πÄ‡∏• ‡∏≠‡∏±‡∏•‡∏°‡∏≠‡∏ô‡∏î‡πå\n';
        response += '‚Ä¢ ‡πÇ‡∏≠‡πä‡∏ï‡∏°‡∏µ‡∏• ‡∏ò‡∏±‡∏ç‡∏û‡∏∑‡∏ä‡πÄ‡∏ï‡πá‡∏°‡πÄ‡∏°‡∏•‡πá‡∏î\n';
        response += '‚Ä¢ ‡∏Å‡∏•‡πâ‡∏ß‡∏¢ ‡∏≠‡πÇ‡∏ß‡∏Ñ‡∏≤‡πÇ‡∏î (‡∏°‡∏µ‡πÇ‡∏û‡πÅ‡∏ó‡∏™‡πÄ‡∏ã‡∏µ‡∏¢‡∏°)\n\n';
        response += '‚ùå ‡∏Ñ‡∏ß‡∏£‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á:\n';
        response += '‚Ä¢ ‡πÄ‡∏Å‡∏•‡∏∑‡∏≠ ‡∏ô‡πâ‡∏≥‡∏õ‡∏•‡∏≤ ‡∏ã‡∏µ‡∏≠‡∏¥‡πä‡∏ß\n';
        response += '‚Ä¢ ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å\n';
        response += '‚Ä¢ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡πÅ‡∏≠‡∏•‡∏Å‡∏≠‡∏Æ‡∏≠‡∏•‡πå\n';
        response += '‚Ä¢ ‡∏Å‡∏≤‡πÅ‡∏ü‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô\n\n';
      }
      
      if (hasCondition('‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à')) {
        response += 'üíì ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à:\n';
        response += '‚úÖ ‡∏Ñ‡∏ß‡∏£‡∏Å‡∏¥‡∏ô:\n';
        response += '‚Ä¢ ‡∏õ‡∏•‡∏≤‡πÅ‡∏ã‡∏•‡∏°‡∏≠‡∏ô ‡∏õ‡∏•‡∏≤‡∏ó‡∏π‡∏ô‡πà‡∏≤\n';
        response += '‚Ä¢ ‡∏≠‡∏±‡∏•‡∏°‡∏≠‡∏ô‡∏î‡πå ‡∏ß‡∏≠‡∏•‡∏ô‡∏±‡∏ó\n';
        response += '‚Ä¢ ‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏°‡∏∞‡∏Å‡∏≠‡∏Å\n';
        response += '‚Ä¢ ‡∏ú‡∏±‡∏Å‡πÉ‡∏ö‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‡∏ú‡∏•‡πÄ‡∏ö‡∏≠‡∏£‡∏µ‡πà\n\n';
        response += '‚ùå ‡∏Ñ‡∏ß‡∏£‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á:\n';
        response += '‚Ä¢ ‡πÑ‡∏Ç‡∏°‡∏±‡∏ô‡∏≠‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß (‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÅ‡∏î‡∏á)\n';
        response += '‚Ä¢ ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏≠‡∏î\n';
        response += '‚Ä¢ ‡πÄ‡∏ô‡∏¢ ‡∏°‡∏≤‡∏£‡πå‡∏Å‡∏≤‡∏£‡∏µ‡∏ô\n';
        response += '‚Ä¢ ‡∏Ç‡∏≠‡∏á‡∏´‡∏ß‡∏≤‡∏ô‡∏°‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ\n\n';
      }
      
      if (!hasCondition('‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô') && !hasCondition('‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á') && !hasCondition('‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à')) {
        response += 'üåü ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ:\n';
        response += '‚Ä¢ ‡∏Å‡∏¥‡∏ô‡∏Ñ‡∏£‡∏ö 5 ‡∏´‡∏°‡∏π‡πà‡πÉ‡∏ô‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°\n';
        response += '‚Ä¢ ‡∏ú‡∏±‡∏Å‡∏ú‡∏•‡πÑ‡∏°‡πâ 5-9 ‡∏™‡πà‡∏ß‡∏ô/‡∏ß‡∏±‡∏ô\n';
        response += '‚Ä¢ ‡∏ò‡∏±‡∏ç‡∏û‡∏∑‡∏ä‡πÄ‡∏ï‡πá‡∏°‡πÄ‡∏°‡∏•‡πá‡∏î\n';
        response += '‚Ä¢ ‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô‡∏à‡∏≤‡∏Å‡∏õ‡∏•‡∏≤ ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏ß\n';
        response += '‚Ä¢ ‡∏ô‡∏°‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏ô‡∏°‡πÑ‡∏Ç‡∏°‡∏±‡∏ô‡∏ï‡πà‡∏≥\n\n';
      }
      
      response += 'üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ:\n';
      response += '‚Ä¢ ‡∏Å‡∏¥‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£ 3 ‡∏°‡∏∑‡πâ‡∏≠‡∏´‡∏•‡∏±‡∏Å 2 ‡∏ß‡πà‡∏≤‡∏á\n';
      response += '‚Ä¢ ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥ 8-10 ‡πÅ‡∏Å‡πâ‡∏ß/‡∏ß‡∏±‡∏ô\n';
      response += '‚Ä¢ ‡πÄ‡∏Ñ‡∏µ‡πâ‡∏¢‡∏ß‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î\n';
      response += '‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≠‡∏ô 2 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á';
      
      return response;
    }
    
    // ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•
    if (message.includes('‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏â‡∏±‡∏ô') || message.includes('‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£') || message.includes('exercise ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏â‡∏±‡∏ô')) {
      let response = 'üèÉ‚Äç‚ôÇÔ∏è ‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì:\n\n';
      
      if (hasCondition('‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô')) {
        response += 'üçØ ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô:\n';
        response += '‚è∞ ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤: ‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ 1-2 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á\n';
        response += 'üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: 150 ‡∏ô‡∏≤‡∏ó‡∏µ/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå\n\n';
        response += '‚úÖ ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:\n';
        response += '‚Ä¢ ‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏£‡πá‡∏ß 30 ‡∏ô‡∏≤‡∏ó‡∏µ/‡∏ß‡∏±‡∏ô\n';
        response += '‚Ä¢ ‡∏ß‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥ 3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå\n';
        response += '‚Ä¢ ‡∏¢‡∏∑‡∏î‡πÄ‡∏™‡πâ‡∏ô‡∏¢‡∏∑‡∏î‡∏™‡∏≤‡∏¢\n';
        response += '‚Ä¢ ‡πÇ‡∏¢‡∏Ñ‡∏∞ ‡πÑ‡∏ó‡πâ‡πÄ‡∏Å‡πä‡∏Å\n\n';
        response += '‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á:\n';
        response += '‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏Å‡πà‡∏≠‡∏ô-‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢\n';
        response += '‚Ä¢ ‡∏´‡∏¢‡∏∏‡∏î‡∏´‡∏≤‡∏Å‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 100 mg/dL\n';
        response += '‚Ä¢ ‡∏û‡∏Å‡∏Ç‡∏ô‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏ô‡πâ‡∏≥‡∏´‡∏ß‡∏≤‡∏ô‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡∏ß\n';
        response += '‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏´‡∏ô‡∏±‡∏Å‡∏à‡∏±‡∏î\n\n';
      }
      
      if (hasCondition('‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á')) {
        response += 'üíó ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á:\n';
        response += '‚è∞ ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤: ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ä‡πâ‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏¢‡πá‡∏ô\n';
        response += 'üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: 30 ‡∏ô‡∏≤‡∏ó‡∏µ/‡∏ß‡∏±‡∏ô 5 ‡∏ß‡∏±‡∏ô/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå\n\n';
        response += '‚úÖ ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:\n';
        response += '‚Ä¢ ‡πÄ‡∏î‡∏¥‡∏ô ‡∏à‡πä‡∏≠‡∏Å‡∏Å‡∏¥‡πâ‡∏á‡πÄ‡∏ö‡∏≤‡πÜ\n';
        response += '‚Ä¢ ‡∏õ‡∏±‡πà‡∏ô‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô\n';
        response += '‚Ä¢ ‡∏ß‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥\n';
        response += '‚Ä¢ ‡πÄ‡∏ï‡πâ‡∏ô‡πÅ‡∏≠‡πÇ‡∏£‡∏ö‡∏¥‡∏Å\n\n';
        response += '‚ùå ‡∏Ñ‡∏ß‡∏£‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á:\n';
        response += '‚Ä¢ ‡∏¢‡∏Å‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏´‡∏ô‡∏±‡∏Å\n';
        response += '‚Ä¢ ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏•‡∏±‡πâ‡∏ô‡∏•‡∏°‡∏´‡∏≤‡∏¢‡πÉ‡∏à\n';
        response += '‚Ä¢ ‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡πÉ‡∏ô‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏£‡πâ‡∏≠‡∏ô‡∏à‡∏±‡∏î\n\n';
        response += '‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á:\n';
        response += '‚Ä¢ ‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô-‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢\n';
        response += '‚Ä¢ ‡∏´‡∏¢‡∏∏‡∏î‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏á‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô\n';
        response += '‚Ä¢ ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥\n\n';
      }
      
      if (hasCondition('‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à')) {
        response += 'üíì ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à:\n';
        response += '‚ö†Ô∏è ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏Å‡πà‡∏≠‡∏ô\n';
        response += 'üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô 10-15 ‡∏ô‡∏≤‡∏ó‡∏µ/‡∏ß‡∏±‡∏ô\n\n';
        response += '‚úÖ ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢:\n';
        response += '‚Ä¢ ‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏ö‡∏≤‡πÜ\n';
        response += '‚Ä¢ ‡πÇ‡∏¢‡∏Ñ‡∏∞ ‡∏™‡∏ï‡∏¥‡πÄ‡∏ó‡∏ä‡∏±‡πà‡∏ô\n';
        response += '‚Ä¢ ‡∏¢‡∏∑‡∏î‡πÄ‡∏™‡πâ‡∏ô‡∏¢‡∏∑‡∏î‡∏™‡∏≤‡∏¢\n';
        response += '‚Ä¢ ‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏ö‡∏≥‡∏ö‡∏±‡∏î‡∏ï‡∏≤‡∏°‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥\n\n';
        response += 'üö´ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏´‡πâ‡∏≤‡∏°‡∏ó‡∏≥:\n';
        response += '‚Ä¢ ‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏´‡∏ô‡∏±‡∏Å‡∏à‡∏±‡∏î\n';
        response += '‚Ä¢ ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô\n';
        response += '‚Ä¢ ‡∏¢‡∏Å‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡∏±‡∏Å\n\n';
        response += '‚ö†Ô∏è ‡∏´‡∏¢‡∏∏‡∏î‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏´‡∏≤‡∏Å:\n';
        response += '‚Ä¢ ‡πÄ‡∏à‡πá‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏Å ‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡∏•‡∏≥‡∏ö‡∏≤‡∏Å\n';
        response += '‚Ä¢ ‡∏ß‡∏¥‡∏á‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô ‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡πÑ‡∏™‡πâ\n';
        response += '‚Ä¢ ‡πÉ‡∏à‡∏™‡∏±‡πà‡∏ô‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥\n\n';
      }
      
      if (!hasCondition('‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô') && !hasCondition('‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á') && !hasCondition('‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à')) {
        response += 'üåü ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ:\n';
        response += 'üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: 150 ‡∏ô‡∏≤‡∏ó‡∏µ/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå\n\n';
        response += 'üèÉ‚Äç‚ôÇÔ∏è ‡πÅ‡∏≠‡πÇ‡∏£‡∏ö‡∏¥‡∏Å (4-5 ‡∏ß‡∏±‡∏ô/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå):\n';
        response += '‚Ä¢ ‡πÄ‡∏î‡∏¥‡∏ô ‡∏à‡πä‡∏≠‡∏Å‡∏Å‡∏¥‡πâ‡∏á ‡∏ß‡∏¥‡πà‡∏á\n';
        response += '‚Ä¢ ‡∏ß‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥ ‡∏õ‡∏±‡πà‡∏ô‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô\n';
        response += '‚Ä¢ ‡πÄ‡∏ï‡πâ‡∏ô‡πÅ‡∏≠‡πÇ‡∏£‡∏ö‡∏¥‡∏Å ‡∏Å‡∏µ‡∏¨‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ\n\n';
        response += 'üí™ ‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠ (2-3 ‡∏ß‡∏±‡∏ô/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå):\n';
        response += '‚Ä¢ ‡∏¢‡∏Å‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å\n';
        response += '‚Ä¢ ‡πÅ‡∏ú‡∏•‡∏ô‡∏Ñ‡πå ‡∏™‡∏Ñ‡∏ß‡∏≠‡∏ó\n';
        response += '‚Ä¢ ‡∏î‡∏±‡∏°‡πÄ‡∏ö‡∏• ‡∏¢‡∏≤‡∏á‡∏¢‡∏∑‡∏î\n\n';
        response += 'üßò‚Äç‚ôÄÔ∏è ‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô (‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô):\n';
        response += '‚Ä¢ ‡∏¢‡∏∑‡∏î‡πÄ‡∏™‡πâ‡∏ô‡∏¢‡∏∑‡∏î‡∏™‡∏≤‡∏¢\n';
        response += '‚Ä¢ ‡πÇ‡∏¢‡∏Ñ‡∏∞ ‡∏û‡∏¥‡∏•‡∏≤‡∏ó‡∏¥‡∏™\n\n';
      }
      
      response += 'üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ:\n';
      response += '‚Ä¢ ‡∏ß‡∏≠‡∏£‡πå‡∏°‡∏≠‡∏±‡∏û 5-10 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°\n';
      response += '‚Ä¢ ‡∏Ñ‡∏π‡∏•‡∏î‡∏≤‡∏ß‡∏ô‡πå‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à\n';
      response += '‚Ä¢ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏±‡∏Å‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≠‡∏¢‡πÑ‡∏õ\n';
      response += '‚Ä¢ ‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠\n';
      response += '‚Ä¢ ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏Å‡πà‡∏≠‡∏ô ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á ‡πÅ‡∏•‡∏∞‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢';
      
      return response;
    }
    
    if (message.includes('‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢') || message.includes('exercise')) {
      let response = '‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: \n‚Ä¢ ‡∏Ñ‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ: 150 ‡∏ô‡∏≤‡∏ó‡∏µ/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå \n‚Ä¢ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô: 30 ‡∏ô‡∏≤‡∏ó‡∏µ/‡∏ß‡∏±‡∏ô 5 ‡∏ß‡∏±‡∏ô/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå \n‚Ä¢ ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡∏ó‡∏±‡πâ‡∏á‡πÅ‡∏≠‡πÇ‡∏£‡∏ö‡∏¥‡∏Å‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠ \n‚Ä¢ ‡∏ß‡∏≠‡∏£‡πå‡∏°‡∏≠‡∏±‡∏û‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢ \nüí™ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏ö‡∏≤‡πÜ ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏±‡∏Å';
      
      if (hasCondition('‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô') || hasCondition('diabetes')) {
        response += '\n\nüë§ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô:\n‚Ä¢ ‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏£‡πá‡∏ß 30 ‡∏ô‡∏≤‡∏ó‡∏µ/‡∏ß‡∏±‡∏ô\n‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏Å‡πà‡∏≠‡∏ô-‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢\n‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ\n‚Ä¢ ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠';
      }
      
      if (hasCondition('‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á') || hasCondition('hypertension')) {
        response += '\n\nüë§ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á:\n‚Ä¢ ‡πÄ‡∏î‡∏¥‡∏ô ‡∏ß‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥ ‡∏õ‡∏±‡πà‡∏ô‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô\n‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏¢‡∏Å‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡∏±‡∏Å\n‚Ä¢ ‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏´‡∏ô‡∏±‡∏Å‡∏à‡∏±‡∏î\n‚Ä¢ ‡∏´‡∏¢‡∏∏‡∏î‡∏û‡∏±‡∏Å‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏á‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô';
      }
      
      return response;
    }
    
    // ‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°...
    if (message.includes('paracetamol') || message.includes('‡∏û‡∏≤‡∏£‡∏≤‡πÄ‡∏ã‡∏ï‡∏≤‡∏°‡∏≠‡∏•') || message.includes('‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î')) {
      return 'Paracetamol (‡∏û‡∏≤‡∏£‡∏≤‡πÄ‡∏ã‡∏ï‡∏≤‡∏°‡∏≠‡∏•) - ‡∏¢‡∏≤‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î‡∏•‡∏î‡πÑ‡∏Ç‡πâ: \nüíä ‡∏Ç‡∏ô‡∏≤‡∏î: ‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà 500-1000 mg ‡∏ó‡∏∏‡∏Å 4-6 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á \nüìä ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 4000 mg ‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô (8 ‡πÄ‡∏°‡πá‡∏î 500mg) \n‚ö†Ô∏è ‡∏£‡∏∞‡∏ß‡∏±‡∏á: ‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏ï‡∏±‡∏ö‡∏´‡∏≤‡∏Å‡πÉ‡∏ä‡πâ‡πÄ‡∏Å‡∏¥‡∏ô‡∏Ç‡∏ô‡∏≤‡∏î \n‚úÖ ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏î‡πá‡∏Å‡πÅ‡∏•‡∏∞‡∏´‡∏ç‡∏¥‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡∏£‡∏£‡∏†‡πå \nüç∫ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏≠‡∏•‡∏Å‡∏≠‡∏Æ‡∏≠‡∏•‡πå‡∏Ç‡∏ì‡∏∞‡πÉ‡∏ä‡πâ‡∏¢‡∏≤';
    }
    
    if (message.includes('simvastatin') || message.includes('‡∏ã‡∏¥‡∏°‡∏ß‡∏≤‡∏™‡πÅ‡∏ï‡∏ï‡∏¥‡∏ô') || message.includes('‡∏¢‡∏≤‡∏Ñ‡∏≠‡πÄ‡∏•‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡∏≠‡∏•')) {
      return 'Simvastatin (‡∏ã‡∏¥‡∏°‡∏ß‡∏≤‡∏™‡πÅ‡∏ï‡∏ï‡∏¥‡∏ô) - ‡∏¢‡∏≤‡∏•‡∏î‡∏Ñ‡∏≠‡πÄ‡∏•‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡∏≠‡∏•: \nüíä ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö: ‡∏•‡∏î‡πÑ‡∏Ç‡∏°‡∏±‡∏ô‡πÉ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à \nüåô ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ: ‡∏Å‡∏¥‡∏ô‡∏ï‡∏≠‡∏ô‡πÄ‡∏¢‡πá‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≠‡∏ô \n‚ö†Ô∏è ‡∏ú‡∏•‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á: ‡∏õ‡∏ß‡∏î‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠ ‡∏≠‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏•‡∏µ‡∏¢ \n‚ùó ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏™‡πâ‡∏°‡πÇ‡∏≠ ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏ï‡∏£‡∏∞‡∏Å‡∏π‡∏•‡∏™‡πâ‡∏° \nüè• ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° CK, LFT';
    }
    
    if (message.includes('aspirin') || message.includes('‡πÅ‡∏≠‡∏™‡πÑ‡∏û‡∏£‡∏¥‡∏ô')) {
      return 'Aspirin (‡πÅ‡∏≠‡∏™‡πÑ‡∏û‡∏£‡∏¥‡∏ô) - ‡∏¢‡∏≤‡∏ï‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πá‡∏á‡∏ï‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏î: \nüíä ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö: ‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î ‡∏•‡∏î‡πÑ‡∏Ç‡πâ ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏•‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏î \n‚ö° ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡πà‡∏≥ (81-100 mg): ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à \n‚ö†Ô∏è ‡∏ú‡∏•‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á: ‡∏£‡∏∞‡∏Ñ‡∏≤‡∏¢‡πÄ‡∏Ñ‡∏∑‡∏≠‡∏á‡∏Å‡∏£‡∏∞‡πÄ‡∏û‡∏≤‡∏∞ ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏≠‡∏≠‡∏Å \n‚ùó ‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏î‡πá‡∏Å‡∏≠‡∏≤‡∏¢‡∏∏‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 16 ‡∏õ‡∏µ \nüçΩÔ∏è ‡∏Å‡∏¥‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏Ñ‡∏≤‡∏¢‡πÄ‡∏Ñ‡∏∑‡∏≠‡∏á';
    }
    
    if (message.includes('omeprazole') || message.includes('‡πÇ‡∏≠‡πÄ‡∏°‡∏û‡∏£‡∏≤‡πÇ‡∏ã‡∏•') || message.includes('‡∏¢‡∏≤‡∏Å‡∏£‡∏î‡πÑ‡∏´‡∏•‡∏¢‡πâ‡∏≠‡∏ô')) {
      return 'Omeprazole (‡πÇ‡∏≠‡πÄ‡∏°‡∏û‡∏£‡∏≤‡πÇ‡∏ã‡∏•) - ‡∏¢‡∏≤‡∏•‡∏î‡∏Å‡∏£‡∏î‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡πÄ‡∏û‡∏≤‡∏∞: \nüíä ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö: ‡πÅ‡∏Å‡πâ‡∏Å‡∏£‡∏î‡πÑ‡∏´‡∏•‡∏¢‡πâ‡∏≠‡∏ô ‡πÅ‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡πÄ‡∏û‡∏≤‡∏∞ \nüçΩÔ∏è ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ: ‡∏Å‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏ä‡πâ‡∏≤ 30-60 ‡∏ô‡∏≤‡∏ó‡∏µ \n‚è∞ ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤: ‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ‡∏ô‡∏≤‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô 8 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå \n‚ö†Ô∏è ‡∏ú‡∏•‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á: ‡∏õ‡∏ß‡∏î‡∏´‡∏±‡∏ß ‡∏ó‡πâ‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢ \nüí° ‡πÉ‡∏ä‡πâ‡∏ô‡∏≤‡∏ô‡∏≠‡∏≤‡∏à‡∏™‡πà‡∏á‡∏ú‡∏•‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏î‡∏π‡∏î‡∏ã‡∏∂‡∏°‡πÅ‡∏Ñ‡∏•‡πÄ‡∏ã‡∏µ‡∏¢‡∏°';
    }
    
    // ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
    if (message.includes('‡∏õ‡∏ß‡∏î‡∏´‡∏±‡∏ß')) {
      return '‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏õ‡∏ß‡∏î‡∏´‡∏±‡∏ß ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ: \n‚Ä¢ ‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ \n‚Ä¢ ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å \n‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏™‡∏á‡πÅ‡∏£‡∏á \n‚Ä¢ ‡∏ô‡∏ß‡∏î‡πÄ‡∏ö‡∏≤‡πÜ ‡∏ó‡∏µ‡πà‡∏Ç‡∏°‡∏±‡∏ö \n‚ö†Ô∏è ‡∏´‡∏≤‡∏Å‡∏õ‡∏ß‡∏î‡∏´‡∏±‡∏ß‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏ô‡∏≤‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô 3 ‡∏ß‡∏±‡∏ô ‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå';
    }

    // ‡∏Å‡∏≤‡∏£‡∏•‡∏î‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å
    if (message.includes('‡∏•‡∏î‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å') || message.includes('‡∏ú‡∏≠‡∏°') || message.includes('‡∏•‡∏î weight')) {
      let response = '‚öñÔ∏è ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏•‡∏î‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á:\n\n';
      response += 'üçΩÔ∏è ‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏ô:\n';
      response += '‚Ä¢ ‡∏•‡∏î‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà 500-750 kcal/‡∏ß‡∏±‡∏ô\n';
      response += '‚Ä¢ ‡∏Å‡∏¥‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡∏Å‡∏•‡πâ‡∏≠‡∏á ‡πÅ‡∏ó‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡∏Ç‡∏≤‡∏ß\n';
      response += '‚Ä¢ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏±‡∏Å ‡∏ú‡∏•‡πÑ‡∏°‡πâ ‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏¥‡∏î‡∏°‡∏±‡∏ô\n';
      response += '‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Ç‡∏≠‡∏á‡∏ó‡∏≤‡∏ô ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡∏´‡∏ß‡∏≤‡∏ô\n';
      response += '‚Ä¢ ‡∏Å‡∏¥‡∏ô‡∏ô‡πâ‡∏≠‡∏¢‡∏°‡∏∑‡πâ‡∏≠ ‡∏ö‡πà‡∏≠‡∏¢‡∏Ñ‡∏£‡∏±‡πâ‡∏á\n\n';
      
      response += 'üèÉ‚Äç‚ôÄÔ∏è ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á:\n';
      response += '‚Ä¢ ‡πÄ‡∏î‡∏¥‡∏ô-‡∏ß‡∏¥‡πà‡∏á 30-45 ‡∏ô‡∏≤‡∏ó‡∏µ/‡∏ß‡∏±‡∏ô\n';
      response += '‚Ä¢ ‡∏¢‡∏Å‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å 2-3 ‡∏ß‡∏±‡∏ô/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå\n';
      response += '‚Ä¢ ‡πÄ‡∏ï‡πâ‡∏ô‡πÅ‡∏≠‡πÇ‡∏£‡∏ö‡∏¥‡∏Ñ ‡∏™‡∏ß‡∏¥‡∏°‡∏°‡∏¥‡πà‡∏á\n\n';
      
      response += 'üìä ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: ‡∏•‡∏î 0.5-1 ‡∏Å‡∏Å./‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå\n';
      response += 'üíß ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥ 3-4 ‡∏•‡∏¥‡∏ï‡∏£/‡∏ß‡∏±‡∏ô\n';
      response += 'üò¥ ‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö 7-8 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á/‡∏Ñ‡∏∑‡∏ô';
      
      return response;
    }

    // ‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£
    if (message.includes('‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô') || message.includes('vitamin') || message.includes('‡∏™‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£')) {
      let response = 'üíä ‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£:\n\n';
      response += '‚òÄÔ∏è ‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô D:\n';
      response += '‚Ä¢ ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ï‡πà‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏π‡∏Å ‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏±‡∏ô\n';
      response += '‚Ä¢ ‡πÅ‡∏´‡∏•‡πà‡∏á: ‡πÅ‡∏™‡∏á‡πÅ‡∏î‡∏î ‡∏ô‡∏° ‡∏õ‡∏•‡∏≤\n';
      response += '‚Ä¢ ‡∏Ç‡∏ô‡∏≤‡∏î: 800-1000 IU/‡∏ß‡∏±‡∏ô\n\n';
      
      response += 'üçä ‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô C:\n';
      response += '‚Ä¢ ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏π‡∏•‡∏≠‡∏¥‡∏™‡∏£‡∏∞ ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏•‡∏•‡∏≤‡πÄ‡∏à‡∏ô\n';
      response += '‚Ä¢ ‡πÅ‡∏´‡∏•‡πà‡∏á: ‡∏™‡πâ‡∏° ‡∏°‡∏∞‡∏ô‡∏≤‡∏ß ‡∏ù‡∏£‡∏±‡πà‡∏á ‡∏û‡∏£‡∏¥‡∏Å‡∏´‡∏ß‡∏≤‡∏ô\n';
      response += '‚Ä¢ ‡∏Ç‡∏ô‡∏≤‡∏î: 90 mg/‡∏ß‡∏±‡∏ô (‡∏ä‡∏≤‡∏¢) 75 mg/‡∏ß‡∏±‡∏ô (‡∏´‡∏ç‡∏¥‡∏á)\n\n';
      
      response += 'üêü ‡πÇ‡∏≠‡πÄ‡∏°‡∏Å‡πâ‡∏≤ 3:\n';
      response += '‚Ä¢ ‡∏î‡∏µ‡∏ï‡πà‡∏≠‡∏´‡∏±‡∏ß‡πÉ‡∏à ‡∏™‡∏°‡∏≠‡∏á\n';
      response += '‚Ä¢ ‡πÅ‡∏´‡∏•‡πà‡∏á: ‡∏õ‡∏•‡∏≤‡∏ó‡∏∞‡πÄ‡∏• ‡∏ñ‡∏±‡πà‡∏ß‡∏ß‡∏≠‡∏•‡∏ô‡∏±‡∏ó ‡πÄ‡∏°‡∏•‡πá‡∏î‡πÄ‡∏ä‡∏µ‡∏¢\n';
      response += '‚Ä¢ ‡∏Ç‡∏ô‡∏≤‡∏î: 250-500 mg/‡∏ß‡∏±‡∏ô\n\n';
      
      response += 'ü•¨ ‡∏Å‡∏£‡∏î‡πÇ‡∏ü‡∏•‡∏¥‡∏Ñ:\n';
      response += '‚Ä¢ ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡πá‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏î\n';
      response += '‚Ä¢ ‡πÅ‡∏´‡∏•‡πà‡∏á: ‡∏ú‡∏±‡∏Å‡πÉ‡∏ö‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‡∏ñ‡∏±‡πà‡∏ß\n';
      response += '‚Ä¢ ‡∏Ç‡∏ô‡∏≤‡∏î: 400 mcg/‡∏ß‡∏±‡∏ô';
      
      return response;
    }

    // ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î‡πÅ‡∏•‡∏∞‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏à‡∏¥‡∏ï
    if (message.includes('‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î') || message.includes('stress') || message.includes('‡∏à‡∏¥‡∏ï‡πÉ‡∏à') || message.includes('‡∏ã‡∏∂‡∏°‡πÄ‡∏®‡∏£‡πâ‡∏≤')) {
      return 'üß† ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î‡πÅ‡∏•‡∏∞‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏à‡∏¥‡∏ï:\n\n' +
             'üòå ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏•‡∏î‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î:\n' +
             '‚Ä¢ ‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡∏•‡∏∂‡∏Å‡πÜ 4-7-8 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ\n' +
             '‚Ä¢ ‡∏™‡∏°‡∏≤‡∏ò‡∏¥ ‡∏ó‡∏≥‡πÉ‡∏à‡πÉ‡∏´‡πâ‡∏ß‡πà‡∏≤‡∏á 10-15 ‡∏ô‡∏≤‡∏ó‡∏µ/‡∏ß‡∏±‡∏ô\n' +
             '‚Ä¢ ‡∏ü‡∏±‡∏á‡πÄ‡∏û‡∏•‡∏á ‡∏≠‡πà‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠\n' +
             '‚Ä¢ ‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠\n\n' +
             'ü§ù ‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£:\n' +
             '‚Ä¢ ‡∏û‡∏π‡∏î‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ô‡πÉ‡∏Å‡∏•‡πâ‡∏ä‡∏¥‡∏î\n' +
             '‚Ä¢ ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏î‡∏≠‡∏≤‡∏£‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å\n' +
             '‚Ä¢ ‡∏´‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ä‡∏≠‡∏ö\n\n' +
             '‚ö†Ô∏è ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:\n' +
             '‚Ä¢ ‡πÄ‡∏®‡∏£‡πâ‡∏≤‡∏ô‡∏≤‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô 2 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå\n' +
             '‚Ä¢ ‡∏ô‡∏≠‡∏ô‡πÑ‡∏°‡πà‡∏´‡∏•‡∏±‡∏ö ‡∏Å‡∏¥‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ\n' +
             '‚Ä¢ ‡∏Ñ‡∏¥‡∏î‡∏£‡πâ‡∏≤‡∏¢ ‡∏Ñ‡∏¥‡∏î‡∏ó‡∏≥‡∏£‡πâ‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á\n' +
             '‚û°Ô∏è ‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏à‡∏¥‡∏ï‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ';
    }

    // ‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á
    if (message.includes('‡∏ú‡∏¥‡∏ß') || message.includes('skin') || message.includes('‡∏™‡∏¥‡∏ß') || message.includes('‡∏ú‡∏°')) {
      return '‚ú® ‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏™‡πâ‡∏ô‡∏ú‡∏°:\n\n' +
             'üß¥ ‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡πâ‡∏≤:\n' +
             '‚Ä¢ ‡∏•‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ß‡∏±‡∏ô‡∏•‡∏∞ 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á\n' +
             '‚Ä¢ ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏£‡∏µ‡∏°‡∏Å‡∏±‡∏ô‡πÅ‡∏î‡∏î SPF 30+ ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô\n' +
             '‚Ä¢ ‡∏°‡∏≠‡∏¢‡∏™‡πå‡πÄ‡∏à‡∏≠‡πÑ‡∏£‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ú‡∏¥‡∏ß\n' +
             '‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏ï‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏Ñ‡πâ‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô\n\n' +
             'üß¥ ‡πÄ‡∏™‡πâ‡∏ô‡∏ú‡∏°:\n' +
             '‚Ä¢ ‡∏™‡∏£‡∏∞‡∏ú‡∏°‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡∏±‡∏ô\n' +
             '‚Ä¢ ‡πÉ‡∏ä‡πâ‡πÅ‡∏ä‡∏°‡∏û‡∏π‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏™‡∏†‡∏≤‡∏û‡∏ú‡∏°\n' +
             '‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏ô‡πâ‡∏≥‡∏£‡πâ‡∏≠‡∏ô‡∏à‡∏±‡∏î\n' +
             '‚Ä¢ ‡∏ó‡∏£‡∏µ‡∏ó‡πÄ‡∏°‡∏ô‡∏ó‡πå‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏•‡∏∞ 1-2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á\n\n' +
             'üçé ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ï‡πà‡∏≠‡∏ú‡∏¥‡∏ß:\n' +
             '‚Ä¢ ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏™‡∏µ‡∏™‡πâ‡∏° ‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô A\n' +
             '‚Ä¢ ‡∏ñ‡∏±‡πà‡∏ß ‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô E\n' +
             '‚Ä¢ ‡∏õ‡∏•‡∏≤ ‡πÇ‡∏≠‡πÄ‡∏°‡∏Å‡πâ‡∏≤ 3\n' +
             '‚Ä¢ ‡∏ô‡πâ‡∏≥ 8-10 ‡πÅ‡∏Å‡πâ‡∏ß/‡∏ß‡∏±‡∏ô';
    }

    // ‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏û‡πâ
    if (message.includes('‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏û‡πâ') || message.includes('‡πÅ‡∏û‡πâ') || message.includes('allergy') || message.includes('‡∏Ñ‡∏±‡∏ô')) {
      return 'ü§ß ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏û‡πâ:\n\n' +
             'üîç ‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏û‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£:\n' +
             '‚Ä¢ ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Å‡∏¥‡∏ô\n' +
             '‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏∏‡πâ‡∏á ‡∏õ‡∏π ‡∏´‡∏≠‡∏¢ ‡∏ñ‡∏±‡πà‡∏ß\n' +
             '‚Ä¢ ‡∏≠‡πà‡∏≤‡∏ô‡∏â‡∏•‡∏≤‡∏Å‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î\n' +
             '‚Ä¢ ‡∏û‡∏Å EpiPen ‡∏ñ‡πâ‡∏≤‡πÅ‡∏û‡πâ‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á\n\n' +
             'üå∏ ‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏û‡πâ‡∏•‡∏∞‡∏≠‡∏≠‡∏á‡∏ü‡∏π‡∏ô:\n' +
             '‚Ä¢ ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ä‡πâ‡∏≤\n' +
             '‚Ä¢ ‡πÉ‡∏ä‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ü‡∏≠‡∏Å‡∏≠‡∏≤‡∏Å‡∏≤‡∏®\n' +
             '‚Ä¢ ‡∏•‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏ö‡πâ‡∏≤‡∏ô\n' +
             '‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏≠‡∏≠‡∏Å‡∏ô‡∏≠‡∏Å‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏ä‡πâ‡∏≤‡∏ï‡∏£‡∏π‡πà\n\n' +
             'üè† ‡∏ù‡∏∏‡πà‡∏ô ‡πÑ‡∏£‡∏ù‡∏∏‡πà‡∏ô:\n' +
             '‚Ä¢ ‡∏î‡∏π‡∏î‡∏ù‡∏∏‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå\n' +
             '‚Ä¢ ‡∏ã‡∏±‡∏Å‡∏ú‡πâ‡∏≤‡∏õ‡∏π‡∏ó‡∏µ‡πà‡∏ô‡∏≠‡∏ô‡∏ô‡πâ‡∏≥‡∏£‡πâ‡∏≠‡∏ô\n' +
             '‚Ä¢ ‡∏•‡∏î‡∏ï‡∏∏‡πä‡∏Å‡∏ï‡∏≤ ‡∏´‡∏°‡∏≠‡∏ô\n' +
             'üíä ‡∏¢‡∏≤‡πÅ‡∏Å‡πâ‡πÅ‡∏û‡πâ: Antihistamine';
    }

    // ‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏§‡∏î‡∏π
    if (message.includes('‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏§‡∏î‡∏π') || message.includes('‡πÑ‡∏Ç‡πâ‡∏´‡∏ß‡∏±‡∏î') || message.includes('‡πÑ‡∏Ç‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏≠‡∏≠‡∏Å') || message.includes('‡∏°‡∏∑‡∏≠‡πÄ‡∏ó‡πâ‡∏≤‡∏õ‡∏≤‡∏Å')) {
      return 'üåßÔ∏è ‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏§‡∏î‡∏π‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô:\n\n' +
             'ü¶† ‡πÑ‡∏Ç‡πâ‡∏´‡∏ß‡∏±‡∏î:\n' +
             '‚Ä¢ ‡∏•‡πâ‡∏≤‡∏á‡∏°‡∏∑‡∏≠‡∏ö‡πà‡∏≠‡∏¢‡πÜ\n' +
             '‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Ñ‡∏ô‡∏õ‡πà‡∏ß‡∏¢\n' +
             '‚Ä¢ ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏ó‡∏≤‡∏ô‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô C\n' +
             '‚Ä¢ ‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠\n\n' +
             'ü¶ü ‡πÑ‡∏Ç‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏≠‡∏≠‡∏Å:\n' +
             '‚Ä¢ ‡∏Å‡∏≥‡∏à‡∏±‡∏î‡πÅ‡∏´‡∏•‡πà‡∏á‡∏ô‡πâ‡∏≥‡∏Ç‡∏±‡∏á\n' +
             '‚Ä¢ ‡πÉ‡∏ä‡πâ‡∏°‡∏∏‡πâ‡∏á ‡∏¢‡∏≤‡πÑ‡∏•‡πà‡∏¢‡∏∏‡∏á\n' +
             '‚Ä¢ ‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏Ç‡πâ ‡∏õ‡∏ß‡∏î‡∏´‡∏±‡∏ß\n' +
             '‚Ä¢ ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏¢‡∏≠‡∏∞‡πÜ\n\n' +
             'üë∂ ‡∏°‡∏∑‡∏≠‡πÄ‡∏ó‡πâ‡∏≤‡∏õ‡∏≤‡∏Å:\n' +
             '‚Ä¢ ‡πÄ‡∏î‡πá‡∏Å‡πÄ‡∏•‡πá‡∏Å‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á\n' +
             '‚Ä¢ ‡∏•‡πâ‡∏≤‡∏á‡∏°‡∏∑‡∏≠‡∏Å‡πà‡∏≠‡∏ô-‡∏´‡∏•‡∏±‡∏á‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡πÄ‡∏î‡πá‡∏Å\n' +
             '‚Ä¢ ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô\n' +
             '‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏≠‡∏≠‡∏±‡∏î\n\n' +
             '‚ö†Ô∏è ‡∏°‡∏µ‡πÑ‡∏Ç‡πâ‡∏™‡∏π‡∏á ‡∏õ‡∏ß‡∏î‡∏´‡∏±‡∏ß‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á ‚û°Ô∏è ‡∏û‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå';
    }

    // ‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£
    if (message.includes('‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£') || message.includes('herb') || message.includes('‡∏Ç‡∏°‡∏¥‡πâ‡∏ô') || message.includes('‡∏Ç‡∏¥‡∏á')) {
      return 'üåø ‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û:\n\n' +
             'üü° ‡∏Ç‡∏°‡∏¥‡πâ‡∏ô‡∏ä‡∏±‡∏ô:\n' +
             '‚Ä¢ ‡∏ï‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö\n' +
             '‚Ä¢ ‡∏ä‡πà‡∏ß‡∏¢‡∏¢‡πà‡∏≠‡∏¢‡∏≠‡∏≤‡∏´‡∏≤‡∏£\n' +
             '‚Ä¢ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ: ‡∏ä‡∏á‡∏ô‡πâ‡∏≥‡∏î‡∏∑‡πà‡∏° ‡∏ú‡∏™‡∏°‡∏ô‡∏°\n\n' +
             'üü§ ‡∏Ç‡∏¥‡∏á:\n' +
             '‚Ä¢ ‡πÅ‡∏Å‡πâ‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡πÑ‡∏™‡πâ ‡∏´‡∏ß‡∏î\n' +
             '‚Ä¢ ‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î\n' +
             '‚Ä¢ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ: ‡∏ä‡∏á‡∏ä‡∏≤ ‡∏õ‡∏£‡∏∏‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£\n\n' +
             'üçØ ‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á:\n' +
             '‚Ä¢ ‡πÅ‡∏Å‡πâ‡πÑ‡∏≠ ‡∏ö‡∏£‡∏£‡πÄ‡∏ó‡∏≤‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö\n' +
             '‚Ä¢ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ: ‡∏ú‡∏™‡∏°‡∏ô‡πâ‡∏≥‡∏≠‡∏∏‡πà‡∏ô ‡∏°‡∏∞‡∏ô‡∏≤‡∏ß\n\n' +
             'üå± ‡πÉ‡∏ö‡∏ö‡∏±‡∏ß‡∏ö‡∏Å:\n' +
             '‚Ä¢ ‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏™‡∏°‡∏≠‡∏á ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥\n' +
             '‚Ä¢ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ: ‡∏ä‡∏á‡∏ä‡∏≤‡∏î‡∏∑‡πà‡∏°\n\n' +
             '‚ö†Ô∏è ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏´‡∏≤‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡πâ‡∏≠‡∏á\n' +
             'üíä ‡∏´‡∏≤‡∏Å‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤ ‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå';
    }

    // ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û
    if (message.includes('‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û') || message.includes('health check') || message.includes('‡∏ï‡∏£‡∏ß‡∏à‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ')) {
      let response = 'üè• ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:\n\n';
      response += 'üìÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ (‡∏≠‡∏≤‡∏¢‡∏∏ 35+ ‡∏õ‡∏µ):\n';
      response += '‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏Ñ‡∏£‡∏ö CBC, LFT, RFT\n';
      response += '‚Ä¢ ‡πÑ‡∏Ç‡∏°‡∏±‡∏ô‡πÉ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î Lipid profile\n';
      response += '‚Ä¢ ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡πÉ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î FBS\n';
      response += '‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞ Urine\n';
      response += '‚Ä¢ ‡πÄ‡∏≠‡πá‡∏Å‡∏ã‡πÄ‡∏£‡∏¢‡πå‡∏ó‡∏£‡∏ß‡∏á‡∏≠‡∏Å\n\n';
      
      response += 'üéØ ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°:\n';
      response += '‚Ä¢ ‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á: Pap smear, ‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏ô‡∏°\n';
      response += '‚Ä¢ ‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢: PSA (‡∏≠‡∏≤‡∏¢‡∏∏ 50+ ‡∏õ‡∏µ)\n';
      response += '‚Ä¢ ‡∏î‡∏ß‡∏á‡∏ï‡∏≤: ‡∏ï‡∏£‡∏ß‡∏à‡∏ó‡∏∏‡∏Å 2 ‡∏õ‡∏µ\n';
      response += '‚Ä¢ ‡∏ü‡∏±‡∏ô: ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏ó‡∏∏‡∏Å 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô\n\n';
      
      response += 'üîç ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß:\n';
      response += '‚Ä¢ ‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô: HbA1c ‡∏ó‡∏∏‡∏Å 3 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô\n';
      response += '‚Ä¢ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á: ‡∏ß‡∏±‡∏î‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô\n';
      response += '‚Ä¢ ‡∏´‡∏±‡∏ß‡πÉ‡∏à: Echo, EKG ‡∏ï‡∏≤‡∏°‡πÅ‡∏û‡∏ó‡∏¢‡πå\n';
      response += 'üí° ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÇ‡∏£‡∏Ñ‡πÑ‡∏î‡πâ‡∏î‡∏µ';
      
      return response;
    }

    // ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢
    if (message.includes('‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢') || message.includes('‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô') || message.includes('‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô')) {
      let response = 'üçΩÔ∏è ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢:\n\n';
      
      if (hasCondition('‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô')) {
        response += 'üçØ ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô:\n';
        response += '‚úÖ ‡∏Ñ‡∏ß‡∏£‡∏Å‡∏¥‡∏ô:\n';
        response += '‚Ä¢ ‡∏Ç‡πâ‡∏≤‡∏ß‡∏Å‡∏•‡πâ‡∏≠‡∏á ‡πÅ‡∏õ‡πâ‡∏á‡πÑ‡∏°‡πà‡∏Ç‡∏±‡∏î‡∏™‡∏µ\n';
        response += '‚Ä¢ ‡∏õ‡∏•‡∏≤ ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÑ‡∏°‡πà‡∏ï‡∏¥‡∏î‡∏°‡∏±‡∏ô\n';
        response += '‚Ä¢ ‡∏ú‡∏±‡∏Å‡πÉ‡∏ö‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß\n';
        response += '‚Ä¢ ‡∏ñ‡∏±‡πà‡∏ß ‡πÄ‡∏°‡∏•‡πá‡∏î‡∏ò‡∏±‡∏ç‡∏û‡∏∑‡∏ä\n\n';
        response += '‚ùå ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á:\n';
        response += '‚Ä¢ ‡∏Ç‡∏ô‡∏°‡∏´‡∏ß‡∏≤‡∏ô ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡∏´‡∏ß‡∏≤‡∏ô\n';
        response += '‚Ä¢ ‡∏Ç‡πâ‡∏≤‡∏ß‡∏Ç‡∏≤‡∏ß ‡πÅ‡∏õ‡πâ‡∏á‡∏Ç‡∏±‡∏î‡∏™‡∏µ\n';
        response += '‚Ä¢ ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏´‡∏ß‡∏≤‡∏ô‡∏°‡∏≤‡∏Å\n';
        response += '‚Ä¢ ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏≠‡∏î ‡∏°‡∏±‡∏ô‡πÄ‡∏¢‡∏≠‡∏∞\n\n';
      }
      
      if (hasCondition('‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á')) {
        response += 'üíó ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á:\n';
        response += '‚úÖ ‡∏Ñ‡∏ß‡∏£‡∏Å‡∏¥‡∏ô:\n';
        response += '‚Ä¢ ‡∏ú‡∏±‡∏Å‡∏ú‡∏•‡πÑ‡∏°‡πâ ‡∏°‡∏µ‡πÇ‡∏û‡πÅ‡∏ó‡∏™‡πÄ‡∏ã‡∏µ‡∏¢‡∏°\n';
        response += '‚Ä¢ ‡∏õ‡∏•‡∏≤ ‡∏ô‡∏° ‡πÇ‡∏¢‡πÄ‡∏Å‡∏¥‡∏£‡πå‡∏ï\n';
        response += '‚Ä¢ ‡∏ò‡∏±‡∏ç‡∏û‡∏∑‡∏ä‡πÄ‡∏ï‡πá‡∏°‡πÄ‡∏°‡∏•‡πá‡∏î\n';
        response += '‚Ä¢ ‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏°‡∏∞‡∏Å‡∏≠‡∏Å\n\n';
        response += '‚ùå ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á:\n';
        response += '‚Ä¢ ‡πÄ‡∏Å‡∏•‡∏∑‡∏≠ ‡∏ô‡πâ‡∏≥‡∏õ‡∏•‡∏≤ ‡∏ã‡∏≠‡∏™‡πÅ‡∏õ‡∏£‡∏£‡∏π‡∏õ\n';
        response += '‚Ä¢ ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á\n';
        response += '‚Ä¢ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡πÅ‡∏≠‡∏•‡∏Å‡∏≠‡∏Æ‡∏≠‡∏•‡πå\n';
        response += '‚Ä¢ ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ü‡∏≤‡∏™‡∏ï‡πå‡∏ü‡∏π‡∏î\n\n';
      }
      
      response += 'ü•ó ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ:\n';
      response += '‚Ä¢ ‡∏Å‡∏¥‡∏ô‡∏Ñ‡∏£‡∏ö 5 ‡∏´‡∏°‡∏π‡πà ‡πÉ‡∏ô‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°\n';
      response += '‚Ä¢ ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥ 8-10 ‡πÅ‡∏Å‡πâ‡∏ß/‡∏ß‡∏±‡∏ô\n';
      response += '‚Ä¢ ‡∏Å‡∏¥‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡∏ô‡πâ‡∏≠‡∏¢‡∏•‡∏á ‡∏ú‡∏±‡∏Å‡πÄ‡∏¢‡∏≠‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô\n';
      response += '‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏õ‡∏£‡∏£‡∏π‡∏õ';
      
      return response;
    }

    if (message.includes('‡πÅ‡∏Ñ‡∏•‡πÄ‡∏ã‡∏µ‡∏¢‡∏°') || message.includes('calcium')) {
      return '‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÅ‡∏Ñ‡∏•‡πÄ‡∏ã‡∏µ‡∏¢‡∏°: \n‚Ä¢ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£: 1000-1200 mg/‡∏ß‡∏±‡∏ô \n‚Ä¢ ‡πÅ‡∏´‡∏•‡πà‡∏á‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥: ‡∏ô‡∏°, ‡∏õ‡∏•‡∏≤‡πÄ‡∏•‡πá‡∏Å‡∏õ‡∏•‡∏≤‡∏ô‡πâ‡∏≠‡∏¢, ‡∏ú‡∏±‡∏Å‡πÉ‡∏ö‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß \n‚Ä¢ ‡∏Ñ‡∏ß‡∏£‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏ó‡∏≤‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô D \n‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡πÅ‡∏ü‡∏°‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ \n‚òÄÔ∏è ‡πÅ‡∏™‡∏á‡πÅ‡∏î‡∏î‡∏ä‡πà‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏î‡∏π‡∏î‡∏ã‡∏∂‡∏°';
    }
    
    if (message.includes('‡∏ô‡∏≠‡∏ô') || message.includes('sleep')) {
      return '‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏î‡∏µ: \n‚Ä¢ ‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà: 7-9 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á/‡∏Ñ‡∏∑‡∏ô \n‚Ä¢ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ô‡∏≠‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô \n‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≠‡∏ô 1 ‡∏ä‡∏° \n‚Ä¢ ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏¢‡πá‡∏ô ‡∏°‡∏∑‡∏î ‡πÄ‡∏á‡∏µ‡∏¢‡∏ö \nüò¥ ‡∏á‡∏µ‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 30 ‡∏ô‡∏≤‡∏ó‡∏µ';
    }
    
    // ‡∏Ñ‡∏≥‡∏ó‡∏±‡∏Å‡∏ó‡∏≤‡∏¢
    if (message.includes('‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ') || message.includes('‡∏´‡∏ß‡∏±‡∏î‡∏î‡∏µ') || message.includes('hello') || 
        message.includes('hi') || message.includes('‡∏î‡∏µ‡∏à‡πâ‡∏≤') || message.includes('‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö')) {
      let greeting = '‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏≤ üíä\n\nüîç ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö:\n‚Ä¢ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ\n‚Ä¢ ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û\n‚Ä¢ ‡∏Ñ‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢';
      
      if (userProfile?.medical_conditions || userProfile?.medications) {
        greeting += '\n\nüë§ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:';
        if (userProfile.medical_conditions) {
          greeting += `\n‚Ä¢ ‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß: ${userProfile.medical_conditions}`;
        }
        if (userProfile.medications) {
          greeting += `\n‚Ä¢ ‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ: ${userProfile.medications}`;
        }
        greeting += '\nüí° ‡∏â‡∏±‡∏ô‡∏à‡∏∞‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞';
      }
      
      greeting += '\n\n‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡∏≠‡∏¢‡∏≤‡∏Å‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡πÑ‡∏´‡∏°‡∏Ñ‡∏£‡∏±‡∏ö?';
      return greeting;
    }

    // ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏â‡∏•‡∏≤‡∏î‡∏Ç‡∏∂‡πâ‡∏ô - ‡πÉ‡∏ä‡πâ AI ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°
    const smartResponses = [
      // ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢
      {
        keywords: ['‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢', 'exercise', '‡∏ß‡∏¥‡πà‡∏á', '‡πÄ‡∏î‡∏¥‡∏ô', '‡∏¢‡∏¥‡∏°', '‡πÇ‡∏¢‡∏Ñ‡∏∞', '‡∏ß‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥'],
        response: () => {
          let response = 'üèÉ‚Äç‚ôÄÔ∏è ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢:\n\n';
          response += '‚è∞ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà: ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 150 ‡∏ô‡∏≤‡∏ó‡∏µ/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå\n';
          response += '‚Ä¢ ‡∏Ñ‡∏≤‡∏£‡πå‡∏î‡∏¥‡πÇ‡∏≠ 3-5 ‡∏ß‡∏±‡∏ô/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå\n';
          response += '‚Ä¢ ‡∏¢‡∏Å‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å 2-3 ‡∏ß‡∏±‡∏ô/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå\n';
          response += '‚Ä¢ ‡∏¢‡∏∑‡∏î‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏î ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô\n\n';
          
          if (userProfile?.age) {
            const age = parseInt(userProfile.age);
            if (age >= 65) {
              response += 'üëµ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏:\n';
              response += '‚Ä¢ ‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏£‡πá‡∏ß ‡∏ô‡πâ‡∏≥‡∏ï‡πâ‡∏≤‡∏ô ‡∏ï‡∏•‡∏≤‡∏î‡∏ô‡πâ‡∏≥\n';
              response += '‚Ä¢ ‡πÑ‡∏ó‡πÄ‡∏Å‡πá‡∏Å ‡πÇ‡∏¢‡∏Ñ‡∏∞\n';
              response += '‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏•‡πâ‡∏°\n\n';
            } else if (age <= 40) {
              response += 'üí™ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡∏´‡∏ô‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏ß:\n';
              response += '‚Ä¢ HIIT ‡∏ß‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥ ‡∏õ‡∏±‡πà‡∏ô‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô\n';
              response += '‚Ä¢ ‡∏¢‡∏Å‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å ‡∏ö‡∏¥‡∏î‡πÇ‡∏î‡πÑ‡∏ü‡πÑ‡∏ô‡∏ó‡πå\n';
              response += '‚Ä¢ ‡∏Å‡∏µ‡∏¨‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ï‡πà‡∏≤‡∏á‡πÜ\n\n';
            }
          }
          
          if (hasCondition('‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô')) {
            response += 'üçØ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô:\n';
            response += '‚Ä¢ ‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ 30 ‡∏ô‡∏≤‡∏ó\n';
            response += '‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏Å‡πà‡∏≠‡∏ô-‡∏´‡∏•‡∏±‡∏á\n';
            response += '‚Ä¢ ‡∏û‡∏Å‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏ï‡πà‡∏≥\n\n';
          }
          
          if (hasCondition('‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á')) {
            response += 'üíó ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á:\n';
            response += '‚Ä¢ ‡πÄ‡∏î‡∏¥‡∏ô ‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏ö‡∏≤‡πÜ ‡∏ß‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥\n';
            response += '‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏¢‡∏Å‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏´‡∏ô‡∏±‡∏Å\n';
            response += '‚Ä¢ ‡∏ß‡∏≠‡∏£‡πå‡∏°‡∏≠‡∏±‡∏û ‡∏Ñ‡∏π‡∏•‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÉ‡∏´‡πâ‡∏î‡∏µ\n\n';
          }
          
          response += '‚ö†Ô∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÑ‡∏õ‡∏°‡∏≤‡∏Å ‡∏´‡∏¢‡∏∏‡∏î‡∏´‡∏≤‡∏Å‡πÄ‡∏à‡πá‡∏ö';
          return response;
        }
      },
      
      // ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£
      {
        keywords: ['‡∏≠‡∏≤‡∏´‡∏≤‡∏£', '‡∏Å‡∏¥‡∏ô', 'food', '‡∏ó‡∏≤‡∏ô', '‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏ó‡∏≤‡∏ô', 'nutrition'],
        response: () => {
          let response = 'üçΩÔ∏è ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏ó‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£:\n\n';
          response += 'üåà ‡∏≠‡∏≤‡∏´‡∏≤‡∏£ 5 ‡∏´‡∏°‡∏π‡πà:\n';
          response += '‚Ä¢ ‡∏´‡∏°‡∏π‡πà 1: ‡∏Ç‡πâ‡∏≤‡∏ß‡∏Å‡∏•‡πâ‡∏≠‡∏á ‡∏Ç‡∏ô‡∏°‡∏à‡∏µ‡∏ô (25%)\n';
          response += '‚Ä¢ ‡∏´‡∏°‡∏π‡πà 2: ‡∏ú‡∏±‡∏Å ‡πÉ‡∏ö‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß (25%)\n';
          response += '‚Ä¢ ‡∏´‡∏°‡∏π‡πà 3: ‡∏õ‡∏•‡∏≤ ‡πÑ‡∏Ç‡πà ‡∏ñ‡∏±‡πà‡∏ß (25%)\n';
          response += '‚Ä¢ ‡∏´‡∏°‡∏π‡πà 4: ‡∏ú‡∏•‡πÑ‡∏°‡πâ (15%)\n';
          response += '‚Ä¢ ‡∏´‡∏°‡∏π‡πà 5: ‡∏ô‡∏° ‡∏î‡∏∑‡πà‡∏°‡∏ô‡∏° (10%)\n\n';
          
          response += '‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£:\n';
          response += '‚Ä¢ ‡πÄ‡∏ä‡πâ‡∏≤: 6-8 ‡πÇ‡∏°‡∏á (25% ‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà)\n';
          response += '‚Ä¢ ‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô: 12-13 ‡πÇ‡∏°‡∏á (40%)\n';
          response += '‚Ä¢ ‡πÄ‡∏¢‡πá‡∏ô: 18-19 ‡πÇ‡∏°‡∏á (35%)\n';
          response += '‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏¥‡∏ô‡∏î‡∏∂‡∏Å‡∏´‡∏•‡∏±‡∏á 20.00\n\n';
          
          if (hasCondition('‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô')) {
            response += 'üçØ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô:\n';
            response += '‚Ä¢ ‡∏Å‡∏¥‡∏ô‡∏Ñ‡∏£‡∏ö 3 ‡∏°‡∏∑‡πâ‡∏≠ ‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤\n';
            response += '‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°\n';
            response += '‚Ä¢ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≤‡∏ß‡∏Å‡∏•‡πâ‡∏≠‡∏á ‡πÅ‡∏õ‡πâ‡∏á‡πÑ‡∏°‡πà‡∏Ç‡∏±‡∏î‡∏™‡∏µ\n\n';
          }
          
          if (hasCondition('‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á')) {
            response += 'üíó ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á:\n';
            response += '‚Ä¢ ‡∏•‡∏î‡πÄ‡∏Å‡∏•‡∏∑‡∏≠ < 6 ‡∏Å‡∏£‡∏±‡∏°/‡∏ß‡∏±‡∏ô\n';
            response += '‚Ä¢ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏û‡πÅ‡∏ó‡∏™‡πÄ‡∏ã‡∏µ‡∏¢‡∏° (‡∏Å‡∏•‡πâ‡∏ß‡∏¢)\n';
            response += '‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏õ‡∏£‡∏£‡∏π‡∏õ\n\n';
          }
          
          response += 'üíß ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥ 8-10 ‡πÅ‡∏Å‡πâ‡∏ß/‡∏ß‡∏±‡∏ô\n';
          response += 'üö´ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á: ‡∏ó‡∏≠‡∏î ‡∏°‡∏±‡∏ô‡πÄ‡∏¢‡∏≠‡∏∞ ‡∏´‡∏ß‡∏≤‡∏ô‡∏à‡∏±‡∏î ‡πÄ‡∏Ñ‡πá‡∏°‡∏à‡∏±‡∏î';
          return response;
        }
      },
      
      // ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô
      {
        keywords: ['‡∏ô‡∏≠‡∏ô', 'sleep', '‡∏´‡∏•‡∏±‡∏ö', '‡∏ô‡∏≠‡∏ô‡πÑ‡∏°‡πà‡∏´‡∏•‡∏±‡∏ö', 'insomnia'],
        response: () => {
          let response = 'üò¥ ‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û:\n\n';
          response += '‚è∞ ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô:\n';
          response += '‚Ä¢ ‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà: 7-9 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á/‡∏Ñ‡∏∑‡∏ô\n';
          response += '‚Ä¢ ‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏: 7-8 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á/‡∏Ñ‡∏∑‡∏ô\n';
          response += '‚Ä¢ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ô‡∏≠‡∏ô 22.00-23.00 ‡∏ô.\n';
          response += '‚Ä¢ ‡∏ï‡∏∑‡πà‡∏ô 6.00-7.00 ‡∏ô.\n\n';
          
          response += 'üõèÔ∏è ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô:\n';
          response += '‚Ä¢ ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏¢‡πá‡∏ô 18-22¬∞C\n';
          response += '‚Ä¢ ‡∏°‡∏∑‡∏î ‡πÄ‡∏á‡∏µ‡∏¢‡∏ö ‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡∏™‡∏ö‡∏≤‡∏¢\n';
          response += '‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏™‡∏á‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô 1 ‡∏ä‡∏°.‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≠‡∏ô\n';
          response += '‚Ä¢ ‡∏≠‡πà‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ ‡∏ü‡∏±‡∏á‡πÄ‡∏û‡∏•‡∏á‡πÄ‡∏ö‡∏≤‡πÜ\n\n';
          
          response += '‚òï ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á:\n';
          response += '‚Ä¢ ‡∏Ñ‡∏≤‡πÄ‡∏ü‡∏≠‡∏µ‡∏ô‡∏´‡∏•‡∏±‡∏á 14.00 ‡∏ô.\n';
          response += '‚Ä¢ ‡πÅ‡∏≠‡∏•‡∏Å‡∏≠‡∏Æ‡∏≠‡∏•‡πå‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≠‡∏ô\n';
          response += '‚Ä¢ ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏´‡∏ô‡∏±‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≠‡∏ô 3 ‡∏ä‡∏°.\n';
          response += '‚Ä¢ ‡∏á‡∏µ‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô 30 ‡∏ô‡∏≤‡∏ó‡∏µ\n\n';
          
          response += 'üßò‚Äç‚ôÄÔ∏è ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏•‡∏±‡∏ö:\n';
          response += '‚Ä¢ ‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡∏•‡∏∂‡∏Å 4-7-8\n';
          response += '‚Ä¢ ‡∏ó‡∏≥‡∏™‡∏°‡∏≤‡∏ò‡∏¥\n';
          response += '‚Ä¢ ‡∏≠‡πà‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠\n';
          response += '‚ö†Ô∏è ‡∏ô‡∏≠‡∏ô‡πÑ‡∏°‡πà‡∏´‡∏•‡∏±‡∏ö >2 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå ‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå';
          return response;
        }
      },
      
      // ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÇ‡∏£‡∏Ñ
      {
        keywords: ['‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô', 'prevent', '‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏£‡∏Ñ', '‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û'],
        response: () => {
          let response = 'üõ°Ô∏è ‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÇ‡∏£‡∏Ñ‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û:\n\n';
          response += 'üíâ ‡∏Å‡∏≤‡∏£‡∏â‡∏µ‡∏î‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô:\n';
          response += '‚Ä¢ ‡πÑ‡∏Ç‡πâ‡∏´‡∏ß‡∏±‡∏î‡πÉ‡∏´‡∏ç‡πà ‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ\n';
          response += '‚Ä¢ ‡∏ö‡∏≤‡∏î‡∏ó‡∏∞‡∏¢‡∏±‡∏Å ‡∏ó‡∏∏‡∏Å 10 ‡∏õ‡∏µ\n';
          response += '‚Ä¢ ‡πÇ‡∏Ñ‡∏ß‡∏¥‡∏î-19 ‡∏ï‡∏≤‡∏°‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥\n';
          response += '‚Ä¢ ‡πÑ‡∏Ç‡πâ‡∏´‡∏ß‡∏±‡∏î‡∏ô‡∏Å ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á\n\n';
          
          response += 'üßº ‡∏™‡∏∏‡∏Ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•:\n';
          response += '‚Ä¢ ‡∏•‡πâ‡∏≤‡∏á‡∏°‡∏∑‡∏≠ 20 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ\n';
          response += '‚Ä¢ ‡πÅ‡∏õ‡∏£‡∏á‡∏ü‡∏±‡∏ô‡∏ß‡∏±‡∏ô‡∏•‡∏∞ 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á\n';
          response += '‚Ä¢ ‡∏≠‡∏≤‡∏ö‡∏ô‡πâ‡∏≥‡∏™‡∏∞‡∏≠‡∏≤‡∏î\n';
          response += '‚Ä¢ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô\n\n';
          
          response += 'üèÉ‚Äç‚ôÄÔ∏è ‡∏ß‡∏¥‡∏ñ‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏î‡∏µ:\n';
          response += '‚Ä¢ ‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠\n';
          response += '‚Ä¢ ‡∏Å‡∏¥‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Ñ‡∏£‡∏ö 5 ‡∏´‡∏°‡∏π‡πà\n';
          response += '‚Ä¢ ‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠\n';
          response += '‚Ä¢ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î\n';
          response += '‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà ‡πÄ‡∏´‡∏•‡πâ‡∏≤\n\n';
          
          response += 'üè• ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û:\n';
          response += '‚Ä¢ ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥\n';
          response += '‚Ä¢ ‡∏ó‡∏∏‡∏Å 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÄ‡∏£‡∏∑‡πâ‡∏≠‡∏£‡∏±‡∏á\n';
          response += '‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á ‡∏ï‡∏≤‡∏°‡∏≠‡∏≤‡∏¢‡∏∏‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°\n';
          response += 'üí° ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤!';
          return response;
        }
      }
    ];

    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö smart responses ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    for (const smartResponse of smartResponses) {
      if (smartResponse.keywords.some(keyword => message.includes(keyword))) {
        return smartResponse.response();
      }
    }

    // ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
    return '‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏ú‡∏°‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏¢‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏Ñ‡∏£‡∏±‡∏ö \n\nüìû ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô ‡πÇ‡∏ó‡∏£ 1669 \nüè• ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• ‡∏Ñ‡∏ß‡∏£‡∏û‡∏ö‡πÅ‡∏û‡∏ó‡∏¢‡πå \nüíä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏≤: ‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£\n\nüí° ‡∏•‡∏≠‡∏á‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö:\n‚Ä¢ "‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô" - ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß\n‚Ä¢ "‡∏•‡∏î‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å" - ‡∏ß‡∏¥‡∏ò‡∏µ‡∏•‡∏î‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á\n‚Ä¢ "‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢" - ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á\n‚Ä¢ "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô" - ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏£‡∏Ñ‡∏ï‡πà‡∏≤‡∏á‡πÜ';
  };

  const handleSendMessage = async () => {
    if (!inputText.trim() || isTyping) {
      return;
    }

    const trimmedText = inputText.trim();

    const userMessage = {
      id: Date.now(),
      text: trimmedText,
      sender: 'user',
      timestamp: new Date()
    };

    const conversationPayload = buildConversationHistory(messages, trimmedText);

    setMessages((prev) => [...prev, userMessage]);
    setInputText('');
    setIsTyping(true);
    setLastAiError(null);

    try {
      const aiResponse = await requestAiResponse(trimmedText, conversationPayload);
      const aiMessage = aiResponse?.message ? aiResponse.message.trim() : '';

      if (aiResponse?.success && aiMessage) {
        setAssistantStatus({
          mode: 'online',
          engine: aiResponse.model || 'Gemini',
          reason: null
        });

        const botResponse = {
          id: Date.now() + 1,
          text: aiMessage,
          sender: 'bot',
          timestamp: new Date()
        };

        setMessages((prev) => [...prev, botResponse]);
      } else {
        const reason = aiResponse?.reason || 'unknown';
        setAssistantStatus((prev) => ({
          ...prev,
          mode: 'fallback',
          reason
        }));

        const fallbackText = getHealthAdvice(trimmedText);
        const note = '‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡∏£‡∏∞‡∏ö‡∏ö AI ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏° ‡∏à‡∏∂‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö';
        const botResponse = {
          id: Date.now() + 1,
          text: `${note}\n\n${fallbackText}`,
          sender: 'bot',
          timestamp: new Date()
        };

        setMessages((prev) => [...prev, botResponse]);
      }
    } catch (error) {
      const reason = error?.message || 'unknown_error';
      setAssistantStatus((prev) => ({
        ...prev,
        mode: 'fallback',
        reason
      }));
      setLastAiError(reason);

      const fallbackText = getHealthAdvice(trimmedText);
      const note =
        reason === 'missing_token'
          ? '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢ AI'
          : '‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡∏£‡∏∞‡∏ö‡∏ö AI ‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏ä‡πâ‡∏≤‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥ ‡∏à‡∏∂‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö';

      const botResponse = {
        id: Date.now() + 1,
        text: `${note}\n\n${fallbackText}`,
        sender: 'bot',
        timestamp: new Date()
      };

      setMessages((prev) => [...prev, botResponse]);
    } finally {
      setIsTyping(false);
    }
  };

  const handleQuickResponse = (response) => {
    setInputText(response);
  };

  const handleKeyPress = (e) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      handleSendMessage();
    }
  };

  return (
    <>
      {/* Floating Chat Icon */}
      <div 
        className="fixed bottom-4 sm:bottom-6 right-4 sm:right-6 z-50"
        style={{ zIndex: 1000 }}
      >
        <button
          onClick={() => setIsOpen(!isOpen)}
          className="bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white p-3 sm:p-4 rounded-full shadow-2xl transition-all duration-300 transform hover:scale-110 border-4 border-white"
        >
          <span className="text-xl sm:text-2xl">üí¨</span>
          {!isOpen && (
            <div className="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 sm:w-6 sm:h-6 flex items-center justify-center font-bold animate-pulse">
              !
            </div>
          )}
        </button>
      </div>

      {/* Chat Popup */}
      {isOpen && (
        <div 
          className="fixed bottom-16 sm:bottom-24 right-2 sm:right-6 w-[calc(100vw-1rem)] max-w-md sm:w-96 h-[34rem] sm:h-[38rem] bg-white rounded-2xl shadow-2xl border-2 border-blue-200 flex flex-col z-50"
          style={{ zIndex: 1000 }}
        >
          {/* Header */}
          <div className="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-3 sm:p-4 rounded-t-2xl flex items-center justify-between">
            <div className="flex items-center space-x-2">
              <span className="text-lg sm:text-xl">üè•</span>
              <div>
                <h3 className="font-bold text-xs sm:text-sm">‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û AI</h3>
                <p
                  className={`text-xs ${
                    assistantStatus.mode === 'online'
                      ? 'text-blue-100'
                      : 'text-yellow-100 font-semibold'
                  }`}
                >
                  {assistantStatus.mode === 'online'
                    ? `‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ ${assistantStatus.engine || 'AI'} ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤`
                    : '‡πÇ‡∏´‡∏°‡∏î‡∏™‡∏≥‡∏£‡∏≠‡∏á: ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö'}
                </p>
              </div>
            </div>
            <button
              onClick={() => setIsOpen(false)}
              className="text-white hover:text-gray-200 text-lg sm:text-xl font-bold min-w-[44px] min-h-[44px] flex items-center justify-center"
            >
              √ó
            </button>
          </div>

          {assistantStatus.mode === 'fallback' && (
            <div className="bg-yellow-50 text-yellow-800 text-xs px-3 sm:px-4 py-2 border-b border-yellow-200">
              {lastAiError === 'missing_token'
                ? '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢ AI ‡∏ï‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå'
                : '‡∏£‡∏∞‡∏ö‡∏ö AI ‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß ‡∏à‡∏∂‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ó‡∏ô'}
            </div>
          )}

          {/* Messages */}
          <div className="flex-1 overflow-y-auto p-3 sm:p-4 space-y-2 sm:space-y-3 bg-gradient-to-b from-blue-50/30 to-white touch-scroll">
            {messages.map((message) => (
              <div
                key={message.id}
                className={`flex ${message.sender === 'user' ? 'justify-end' : 'justify-start'}`}
              >
                <div
                  className={`max-w-[85%] sm:max-w-xs px-3 sm:px-4 py-2 rounded-xl text-xs sm:text-sm shadow-sm ${
                    message.sender === 'user'
                      ? 'bg-blue-500 text-white rounded-br-md'
                      : 'bg-white text-gray-800 rounded-bl-md border border-gray-200'
                  }`}
                >
                  <p className="whitespace-pre-line leading-relaxed">{message.text}</p>
                  <span className="text-xs opacity-70 block mt-1">
                    {message.timestamp.toLocaleTimeString('th-TH', { 
                      hour: '2-digit', 
                      minute: '2-digit' 
                    })}
                  </span>
                </div>
              </div>
            ))}
            
            {isTyping && (
              <div className="flex justify-start">
                <div className="bg-white text-gray-800 px-3 sm:px-4 py-2 rounded-xl rounded-bl-md text-xs sm:text-sm border border-gray-200 shadow-sm">
                  <span className="inline-flex space-x-1">
                    <span className="animate-bounce">‚óè</span>
                    <span className="animate-bounce delay-100">‚óè</span>
                    <span className="animate-bounce delay-200">‚óè</span>
                  </span>
                </div>
              </div>
            )}
            <div ref={messagesEndRef} />
          </div>

          {/* Quick Responses */}
          <div className="px-2 sm:px-3 py-2 border-t border-gray-200 bg-gray-50">
            <div className="text-xs text-gray-600 mb-2 font-medium">üí° ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ñ‡∏≤‡∏°):</div>
            <div className="flex flex-wrap gap-1 max-h-20 overflow-y-auto">
              {quickResponses.map((response, index) => (
                <button
                  key={index}
                  onClick={() => handleQuickResponse(response)}
                  className="text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded-full hover:bg-blue-100 transition-colors border border-blue-200 min-h-[28px] hover:shadow-sm"
                >
                  {response}
                </button>
              ))}
            </div>
          </div>

          {/* Input */}
          <div className="p-3 sm:p-4 border-t border-gray-200 rounded-b-2xl bg-white">
            <div className="flex space-x-2">
              <input
                type="text"
                value={inputText}
                onChange={(e) => setInputText(e.target.value)}
                onKeyPress={handleKeyPress}
                placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û..."
                className="flex-1 px-3 sm:px-4 py-2 border border-gray-300 rounded-xl text-sm focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all"
              />
              <button
                onClick={handleSendMessage}
                disabled={!inputText.trim()}
                className="bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white px-3 sm:px-4 py-2 rounded-xl text-sm transition-colors shadow-sm min-w-[44px] min-h-[44px] flex items-center justify-center"
              >
                üì§
              </button>
            </div>
          </div>
        </div>
      )}
    </>
  );
};

export default HealthChatbot;
