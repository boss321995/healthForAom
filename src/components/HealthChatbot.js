import React, { useState, useRef, useEffect } from 'react';

const HealthChatbot = ({ userProfile, recentMetrics = [] }) => {
  const [isOpen, setIsOpen] = useState(false);
  const [messages, setMessages] = useState([
    {
      id: 1,
      text: userProfile?.medical_conditions || userProfile?.medications
        ? `р╕кр╕зр╕▒р╕кр╕Фр╕╡р╕Др╕гр╕▒р╕Ъ! р╕Ьр╕бр╣Ар╕Ыр╣Зр╕Щр╕Ьр╕╣р╣Йр╕Кр╣Ир╕зр╕вр╕Фр╣Йр╕▓р╕Щр╕кр╕╕р╕Вр╕ар╕▓р╕Ю ЁЯПе р╕Ьр╕бр╣Ар╕лр╣Зр╕Щр╕зр╣Ир╕▓р╕Др╕╕р╕Ур╕бр╕╡${userProfile?.medical_conditions ? 'р╣Вр╕гр╕Др╕Ыр╕гр╕░р╕Ир╕│р╕Хр╕▒р╕з' : ''}${userProfile?.medical_conditions && userProfile?.medications ? 'р╣Бр╕ер╕░' : ''}${userProfile?.medications ? 'р╕вр╕▓р╕Чр╕╡р╣Ир╕Чр╕▓р╕Щ' : ''} р╕Ьр╕бр╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Гр╕лр╣Йр╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│р╣Ар╕Йр╕Юр╕▓р╕░р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕╕р╕Ур╣Др╕Фр╣Йр╕Др╕гр╕▒р╕Ъ\n\nр╕ер╕нр╕Зр╕Цр╕▓р╕бр╣Ар╕гр╕╖р╣Ир╕нр╕З "р╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Вр╕нр╕Зр╕Йр╕▒р╕Щ" р╕лр╕гр╕╖р╕н "р╕Йр╕▒р╕Щр╕Др╕зр╕гр╕Фр╕╣р╣Бр╕ер╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕нр╕вр╣Ир╕▓р╕Зр╣Др╕г" р╕Фр╕╣р╕Щр╕░р╕Др╕гр╕▒р╕Ъ ЁЯШК`
        : 'р╕кр╕зр╕▒р╕кр╕Фр╕╡р╕Др╕гр╕▒р╕Ъ! р╕Ьр╕бр╣Ар╕Ыр╣Зр╕Щр╕Ьр╕╣р╣Йр╕Кр╣Ир╕зр╕вр╕Фр╣Йр╕▓р╕Щр╕кр╕╕р╕Вр╕ар╕▓р╕Ю ЁЯПе р╕бр╕╡р╕нр╕░р╣Др╕гр╣Гр╕лр╣Йр╕Кр╣Ир╕зр╕вр╣Ар╕лр╕ер╕╖р╕нр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ър╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Вр╕нр╕Зр╕Др╕╕р╕Ур╣Др╕лр╕бр╕Др╕гр╕▒р╕Ъ?\n\nр╕ер╕нр╕Зр╕Цр╕▓р╕б "р╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Вр╕нр╕Зр╕Йр╕▒р╕Щ" р╕лр╕гр╕╖р╕нр╕Др╕│р╕Цр╕▓р╕бр╕нр╕╖р╣Ир╕Щр╣Ж р╣Др╕Фр╣Йр╣Ар╕ер╕вр╕Др╕гр╕▒р╕Ъ ЁЯШК',
      sender: 'bot',
      timestamp: new Date()
    }
  ]);
  const [inputText, setInputText] = useState('');
  const [isTyping, setIsTyping] = useState(false);
  const messagesEndRef = useRef(null);

  const scrollToBottom = () => {
    messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
  };

  useEffect(scrollToBottom, [messages]);

  const quickResponses = [
    'р╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Вр╕нр╕Зр╕Йр╕▒р╕Щр╣Ар╕Ыр╣Зр╕Щр╕нр╕вр╣Ир╕▓р╕Зр╣Др╕г?',
    'р╕Йр╕▒р╕Щр╕Др╕зр╕гр╕Фр╕╣р╣Бр╕ер╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕нр╕вр╣Ир╕▓р╕Зр╣Др╕г?',
    'р╕вр╕▓р╕Вр╕нр╕Зр╕Йр╕▒р╕Щр╕Бр╕┤р╕Щр╕нр╕вр╣Ир╕▓р╕Зр╣Др╕г?',
    'р╕Др╣Ир╕▓р╕Ыр╕Бр╕Хр╕┤р╕Вр╕нр╕Зр╕Йр╕▒р╕Щр╣Ар╕Ыр╣Зр╕Щр╕нр╕вр╣Ир╕▓р╕Зр╣Др╕г?',
    'р╕нр╕▓р╕лр╕▓р╕гр╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░р╕Бр╕▒р╕Ър╕Йр╕▒р╕Щ',
    'р╕Бр╕▓р╕гр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Йр╕▒р╕Щ',
    'р╕ер╕Фр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╕нр╕вр╣Ир╕▓р╕Зр╣Др╕г?',
    'р╕зр╕┤р╕Хр╕▓р╕бр╕┤р╕Щр╕Чр╕╡р╣Ир╕Др╕зр╕гр╕Бр╕┤р╕Щ',
    'р╕Бр╕▓р╕гр╕Щр╕нр╕Щр╕лр╕ер╕▒р╕Ър╕Чр╕╡р╣Ир╕Фр╕╡',
    'р╕ер╕Фр╕Др╕зр╕▓р╕бр╣Ар╕Др╕гр╕╡р╕вр╕Ф',
    'р╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╣Вр╕гр╕Др╕лр╕▒р╕зр╣Гр╕И',
    'р╕Фр╕╣р╣Бр╕ер╕Ьр╕┤р╕зр╕лр╕Щр╕▒р╕З',
    'р╕нр╕▓р╕лр╕▓р╕гр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕╣р╣Йр╕Ыр╣Ир╕зр╕в',
    'р╕кр╕бр╕╕р╕Щр╣Др╕Юр╕гр╣Ар╕Юр╕╖р╣Ир╕нр╕кр╕╕р╕Вр╕ар╕▓р╕Ю',
    'р╕Хр╕гр╕зр╕Ир╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Др╕зр╕гр╕Чр╕│р╕нр╕░р╣Др╕г?',
    'р╣Вр╕гр╕Др╕Ыр╕гр╕░р╕Ир╕│р╕др╕Фр╕╣р╕Эр╕Щ',
    'р╕ар╕╣р╕бр╕┤р╣Бр╕Юр╣Йр╕нр╕▓р╕лр╕▓р╕г',
    'р╕Бр╕▓р╕гр╕Яр╕╖р╣Йр╕Щр╕Яр╕╣р╕гр╣Ир╕▓р╕Зр╕Бр╕▓р╕в'
  ];

  const getHealthAdvice = (userMessage) => {
    const message = userMessage.toLowerCase();
    
    // р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Кр╣Ир╕зр╕вр╣Гр╕Щр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Вр╕гр╕Др╕Ыр╕гр╕░р╕Ир╕│р╕Хр╕▒р╕з
    const hasCondition = (condition) => {
      const medicalConditions = userProfile?.medical_conditions?.toLowerCase() || '';
      if (condition === 'р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З') {
        return medicalConditions.includes('р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З') || 
               medicalConditions.includes('р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╣Вр╕ер╕лр╕┤р╕Хр╕кр╕╣р╕З') ||
               medicalConditions.includes('hypertension') ||
               medicalConditions.includes('р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щ');
      }
      if (condition === 'р╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ') {
        return medicalConditions.includes('р╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ') || 
               medicalConditions.includes('diabetes') ||
               medicalConditions.includes('р╕Щр╣Йр╕│р╕Хр╕▓р╕ер╣Гр╕Щр╣Ар╕ер╕╖р╕нр╕Фр╕кр╕╣р╕З');
      }
      return medicalConditions.includes(condition.toLowerCase());
    };
    
    // р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Кр╣Ир╕зр╕вр╣Гр╕Щр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕вр╕▓р╕Чр╕╡р╣Ир╣Гр╕Кр╣Й
    const takingMedication = (medication) => {
      return userProfile?.medications?.toLowerCase().includes(medication.toLowerCase()) || false;
    };
    
    // р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕кр╕│р╕лр╕гр╕▒р╕Ър╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕ер╣Ир╕▓р╕кр╕╕р╕Ф
    const getLatestMetrics = () => {
      return {
        weight: recentMetrics.find(m => m.weight_kg)?.weight_kg,
        systolic: recentMetrics.find(m => m.systolic_bp)?.systolic_bp,
        diastolic: recentMetrics.find(m => m.diastolic_bp)?.diastolic_bp,
        heartRate: recentMetrics.find(m => m.heart_rate)?.heart_rate,
        bloodSugar: recentMetrics.find(m => m.blood_sugar)?.blood_sugar
      };
    };
    
    // р╕Др╕│р╕Цр╕▓р╕бр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ър╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕кр╣Ир╕зр╕Щр╕Хр╕▒р╕з
    if (message.includes('р╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Вр╕нр╕Зр╕Йр╕▒р╕Щ') || message.includes('р╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Вр╕нр╕Зр╕Ьр╕б') || message.includes('р╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Вр╕нр╕Зр╕Фр╕┤р╕Йр╕▒р╕Щ') || 
        message.includes('р╕кр╕ар╕▓р╕Юр╕кр╕╕р╕Вр╕ар╕▓р╕Ю') || message.includes('р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕╕р╕Вр╕ар╕▓р╕Ю') || message.includes('р╕Хр╕гр╕зр╕Ир╕кр╕╕р╕Вр╕ар╕▓р╕Ю')) {
      
      const latest = getLatestMetrics();
      let response = 'ЁЯУК р╕кр╕гр╕╕р╕Ыр╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Вр╕нр╕Зр╕Др╕╕р╕У:\n\n';
      
      // р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Вр╕гр╕Др╕Ыр╕гр╕░р╕Ир╕│р╕Хр╕▒р╕з
      if (userProfile?.medical_conditions) {
        response += `ЁЯПе р╣Вр╕гр╕Др╕Ыр╕гр╕░р╕Ир╕│р╕Хр╕▒р╕з: ${userProfile.medical_conditions}\n`;
      }
      
      if (userProfile?.medications) {
        response += `ЁЯТК р╕вр╕▓р╕Чр╕╡р╣Ир╕Чр╕▓р╕Щ: ${userProfile.medications}\n`;
      }
      
      response += '\nЁЯУИ р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕ер╣Ир╕▓р╕кр╕╕р╕Ф:\n';
      
      // р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б
      if (latest.weight && userProfile?.height_cm) {
        const bmi = (latest.weight / Math.pow(userProfile.height_cm / 100, 2)).toFixed(1);
        let bmiStatus = '';
        if (bmi < 18.5) bmiStatus = 'р╕Ьр╕нр╕бр╣Ар╕Бр╕┤р╕Щр╣Др╕Ы';
        else if (bmi < 25) bmiStatus = 'р╕Ыр╕Бр╕Хр╕┤';
        else if (bmi < 30) bmiStatus = 'р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╣Ар╕Бр╕┤р╕Щ';
        else bmiStatus = 'р╕нр╣Йр╕зр╕Щ';
        
        response += `тЪЦя╕П р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б: ${latest.weight} р╕Бр╕Б. (BMI: ${bmi} - ${bmiStatus})\n`;
      }
      
      // р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щ
      if (latest.systolic && latest.diastolic) {
        let bpStatus = '';
        if (latest.systolic < 120 && latest.diastolic < 80) bpStatus = 'р╕Ыр╕Бр╕Хр╕┤';
        else if (latest.systolic < 130 && latest.diastolic < 80) bpStatus = 'р╕кр╕╣р╕Зр╣Ар╕ер╣Зр╕Бр╕Щр╣Йр╕нр╕в';
        else if (latest.systolic < 140 || latest.diastolic < 90) bpStatus = 'р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕Зр╕гр╕░р╕вр╕░ 1';
        else bpStatus = 'р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕Зр╕гр╕░р╕вр╕░ 2';
        
        response += `ЁЯТЧ р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щ: ${latest.systolic}/${latest.diastolic} mmHg (${bpStatus})\n`;
      }
      
      // р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╕Щр╣Йр╕│р╕Хр╕▓р╕е
      if (latest.bloodSugar) {
        let sugarStatus = '';
        if (latest.bloodSugar < 100) sugarStatus = 'р╕Ыр╕Бр╕Хр╕┤';
        else if (latest.bloodSugar < 126) sugarStatus = 'р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ';
        else sugarStatus = 'р╕кр╕╣р╕Зр╕Ьр╕┤р╕Фр╕Ыр╕Бр╕Хр╕┤';
        
        response += `ЁЯНп р╕Щр╣Йр╕│р╕Хр╕▓р╕е: ${latest.bloodSugar} mg/dL (${sugarStatus})\n`;
      }
      
      // р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╕лр╕▒р╕зр╣Гр╕И
      if (latest.heartRate) {
        let hrStatus = '';
        if (latest.heartRate < 60) hrStatus = 'р╕Кр╣Йр╕▓р╕Бр╕зр╣Ир╕▓р╕Ыр╕Бр╕Хр╕┤';
        else if (latest.heartRate <= 100) hrStatus = 'р╕Ыр╕Бр╕Хр╕┤';
        else hrStatus = 'р╣Ар╕гр╣Зр╕зр╕Бр╕зр╣Ир╕▓р╕Ыр╕Бр╕Хр╕┤';
        
        response += `ЁЯТУ р╕нр╕▒р╕Хр╕гр╕▓р╕Бр╕▓р╕гр╣Ар╕Хр╣Йр╕Щр╕лр╕▒р╕зр╣Гр╕И: ${latest.heartRate} р╕Др╕гр╕▒р╣Йр╕З/р╕Щр╕▓р╕Чр╕╡ (${hrStatus})\n`;
      }
      
      // р╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│р╣Ар╕Йр╕Юр╕▓р╕░р╕Ър╕╕р╕Др╕Др╕е
      response += '\nЁЯТб р╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕╕р╕У:\n';
      
      if (hasCondition('р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З')) {
        response += 'тАв р╕Др╕зр╕Ър╕Др╕╕р╕бр╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╣Гр╕лр╣Йр╕Хр╣Ир╕│р╕Бр╕зр╣Ир╕▓ 140/90 mmHg\n';
        response += 'тАв р╕ер╕Фр╣Ар╕Бр╕ер╕╖р╕н р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕нр╕▓р╕лр╕▓р╕гр╣Бр╕Ыр╕гр╕гр╕╣р╕Ы\n';
        response += 'тАв р╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╕кр╕бр╣Ир╕│р╣Ар╕кр╕бр╕н 30 р╕Щр╕▓р╕Чр╕╡/р╕зр╕▒р╕Щ\n';
        response += 'тАв р╕Бр╕┤р╕Щр╕вр╕▓р╕Хр╕гр╕Зр╣Ар╕зр╕ер╕▓ р╣Др╕бр╣Ир╕Вр╣Йр╕▓р╕бр╕бр╕╖р╣Йр╕н\n';
        response += 'тАв р╕зр╕▒р╕Фр╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╣Ар╕Ыр╣Зр╕Щр╕Ыр╕гр╕░р╕Ир╕│р╕Чр╕╕р╕Бр╕зр╕▒р╕Щ\n';
      } else if (hasCondition('р╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ')) {
        response += 'тАв р╕Др╕зр╕Ър╕Др╕╕р╕бр╕Щр╣Йр╕│р╕Хр╕▓р╕ер╣Гр╕лр╣Йр╕нр╕вр╕╣р╣Ир╣Гр╕Щр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в 80-130 mg/dL\n';
        response += 'тАв р╕Бр╕┤р╕Щр╕нр╕▓р╕лр╕▓р╕гр╕Хр╕гр╕Зр╣Ар╕зр╕ер╕▓ р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕Вр╕Щр╕бр╕лр╕зр╕▓р╕Щ\n';
        response += 'тАв р╕Хр╕гр╕зр╕Ир╕Щр╣Йр╕│р╕Хр╕▓р╕ер╣Ар╕Ыр╣Зр╕Щр╕Ыр╕гр╕░р╕Ир╕│\n';
        response += 'тАв р╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╕лр╕ер╕▒р╕Зр╕нр╕▓р╕лр╕▓р╕г 30 р╕Щр╕▓р╕Чр╕╡\n';
      } else {
        response += 'тАв р╕гр╕▒р╕Бр╕йр╕▓р╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Фр╕╡р╕Хр╣Ир╕нр╣Др╕Ы р╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╕кр╕бр╣Ир╕│р╣Ар╕кр╕бр╕н\n';
        response += 'тАв р╕Бр╕┤р╕Щр╕нр╕▓р╕лр╕▓р╕г 5 р╕лр╕бр╕╣р╣И р╣Гр╕Щр╕кр╕▒р╕Фр╕кр╣Ир╕зр╕Щр╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░р╕кр╕б\n';
        response += 'тАв р╕Хр╕гр╕зр╕Ир╕кр╕╕р╕Вр╕ар╕▓р╕Юр╣Ар╕Ыр╣Зр╕Щр╕Ыр╕гр╕░р╕Ир╕│\n';
      }
      
      response += '\nтЪая╕П р╕лр╕▓р╕Бр╕бр╕╡р╕нр╕▓р╕Бр╕▓р╕гр╕Ьр╕┤р╕Фр╕Ыр╕Бр╕Хр╕┤ р╕Др╕зр╕гр╕Ыр╕гр╕╢р╕Бр╕йр╕▓р╣Бр╕Юр╕Чр╕вр╣М';
      
      return response;
    }
    
    // р╕Др╕│р╕Цр╕▓р╕бр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ър╕Бр╕▓р╕гр╕Фр╕╣р╣Бр╕ер╕кр╕╕р╕Вр╕ар╕▓р╕Юр╣Ар╕Йр╕Юр╕▓р╕░р╕Ър╕╕р╕Др╕Др╕е
    if (message.includes('р╕Фр╕╣р╣Бр╕ер╕кр╕╕р╕Вр╕ар╕▓р╕Ю') || message.includes('р╕гр╕▒р╕Бр╕йр╕▓р╕кр╕╕р╕Вр╕ар╕▓р╕Ю') || message.includes('р╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╣Вр╕гр╕Д')) {
      let response = 'ЁЯМЯ р╣Бр╕Ьр╕Щр╕Бр╕▓р╕гр╕Фр╕╣р╣Бр╕ер╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕╕р╕У:\n\n';
      
      if (hasCondition('р╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ')) {
        response += 'ЁЯНп р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ:\n';
        response += 'тАв р╕Хр╕гр╕зр╕Ир╕Щр╣Йр╕│р╕Хр╕▓р╕ер╕Бр╣Ир╕нр╕Щр╕нр╕▓р╕лр╕▓р╕г р╕Чр╕╕р╕Бр╕зр╕▒р╕Щ\n';
        response += 'тАв р╕Бр╕┤р╕Щр╕вр╕▓р╕Хр╕гр╕Зр╣Ар╕зр╕ер╕▓ р╣Др╕бр╣Ир╕Вр╣Йр╕▓р╕бр╕бр╕╖р╣Йр╕н\n';
        response += 'тАв р╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╕лр╕ер╕▒р╕Зр╕нр╕▓р╕лр╕▓р╕г 30 р╕Щр╕▓р╕Чр╕╡\n';
        response += 'тАв р╕Хр╕гр╕зр╕И HbA1c р╕Чр╕╕р╕Б 3 р╣Ар╕Фр╕╖р╕нр╕Щ\n\n';
      }
      
      if (hasCondition('р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З')) {
        response += 'ЁЯТЧ р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З:\n';
        response += 'тАв р╕зр╕▒р╕Фр╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕Чр╕╕р╕Бр╕зр╕▒р╕Щ р╣Ар╕зр╕ер╕▓р╣Ар╕Фр╕┤р╕б\n';
        response += 'тАв р╕ер╕Фр╣Ар╕Бр╕ер╕╖р╕нр╣Гр╕лр╣Йр╣Ар╕лр╕ер╕╖р╕н 6 р╕Бр╕гр╕▒р╕б/р╕зр╕▒р╕Щ\n';
        response += 'тАв р╣Ар╕Фр╕┤р╕Щр╣Ар╕гр╣Зр╕з 30 р╕Щр╕▓р╕Чр╕╡ р╕Чр╕╕р╕Бр╕зр╕▒р╕Щ\n';
        response += 'тАв р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Др╕зр╕▓р╕бр╣Ар╕Др╕гр╕╡р╕вр╕Ф\n\n';
      }
      
      if (hasCondition('р╣Вр╕гр╕Др╕лр╕▒р╕зр╣Гр╕И')) {
        response += 'ЁЯТУ р╕Бр╕▓р╕гр╕Фр╕╣р╣Бр╕ер╣Вр╕гр╕Др╕лр╕▒р╕зр╣Гр╕И:\n';
        response += 'тАв р╕Хр╕┤р╕Фр╕Хр╕▓р╕бр╕нр╕▒р╕Хр╕гр╕▓р╕Бр╕▓р╕гр╣Ар╕Хр╣Йр╕Щр╕лр╕▒р╕зр╣Гр╕И\n';
        response += 'тАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕бр╕лр╕Щр╕▒р╕Бр╣Ар╕Бр╕┤р╕Щр╣Др╕Ы\n';
        response += 'тАв р╕ер╕Фр╣Др╕Вр╕бр╕▒р╕Щр╕нр╕┤р╣Ир╕бр╕Хр╕▒р╕з р╣Ар╕Юр╕┤р╣Ир╕бр╕Ьр╕▒р╕Бр╕Ьр╕ер╣Др╕бр╣Й\n';
        response += 'тАв р╕Юр╕Бр╕вр╕▓р╕Йр╕╕р╕Бр╣Ар╕Йр╕┤р╕Щр╕Хр╕┤р╕Фр╕Хр╕▒р╕з\n\n';
      }
      
      // р╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│р╕Чр╕▒р╣Ир╕зр╣Др╕Ы
      response += 'ЁЯМ▒ р╕Бр╕▓р╕гр╕Фр╕╣р╣Бр╕ер╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Чр╕▒р╣Ир╕зр╣Др╕Ы:\n';
      response += 'тАв р╕Щр╕нр╕Щр╕лр╕ер╕▒р╕Ъ 7-8 р╕Кр╕▒р╣Ир╕зр╣Вр╕бр╕З/р╕зр╕▒р╕Щ\n';
      response += 'тАв р╕Фр╕╖р╣Ир╕бр╕Щр╣Йр╕│ 8-10 р╣Бр╕Бр╣Йр╕з/р╕зр╕▒р╕Щ\n';
      response += 'тАв р╕Бр╕┤р╕Щр╕нр╕▓р╕лр╕▓р╕гр╕Др╕гр╕Ъ 5 р╕лр╕бр╕╣р╣И\n';
      response += 'тАв р╕Хр╕гр╕зр╕Ир╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Ыр╕гр╕░р╕Ир╕│р╕Ыр╕╡\n';
      response += 'тАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕Ър╕╕р╕лр╕гр╕╡р╣И р╣Бр╕нр╕ер╕Бр╕нр╕ор╕нр╕ер╣М';
      
      return response;
    }
    
    // р╕Др╕│р╕Цр╕▓р╕бр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ър╕Бр╕▓р╕гр╕Чр╕▓р╕Щр╕вр╕▓
    if (message.includes('р╕вр╕▓р╕Вр╕нр╕Зр╕Йр╕▒р╕Щ') || message.includes('р╕Бр╕▓р╕гр╕Чр╕▓р╕Щр╕вр╕▓') || message.includes('р╕вр╕▓р╕Чр╕╡р╣Ир╕Чр╕▓р╕Щ')) {
      let response = 'ЁЯТК р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Бр╕▓р╕гр╕Чр╕▓р╕Щр╕вр╕▓р╕Вр╕нр╕Зр╕Др╕╕р╕У:\n\n';
      
      if (!userProfile?.medications) {
        return 'р╕Др╕╕р╕Ур╕вр╕▒р╕Зр╣Др╕бр╣Ир╣Др╕Фр╣Йр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕вр╕▓р╕Чр╕╡р╣Ир╕Чр╕▓р╕Щ р╕Бр╕гр╕╕р╕Ур╕▓р╕нр╕▒р╕Юр╣Ар╕Фр╕Чр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕Щр╣Вр╕Ыр╕гр╣Др╕Яр╕ер╣М';
      }
      
      response += `ЁЯФ╕ р╕вр╕▓р╕Чр╕╡р╣Ир╕Чр╕▓р╕Щ: ${userProfile.medications}\n\n`;
      
      if (takingMedication('amlodipine')) {
        response += 'тАв Amlodipine: р╕Чр╕▓р╕Щр╣Ар╕Кр╣Йр╕▓ р╕лр╕ер╕▒р╕Зр╕нр╕▓р╕лр╕▓р╕г 1 р╣Ар╕бр╣Зр╕Ф\n';
        response += '  - р╕гр╕░р╕зр╕▒р╕Зр╕нр╕▓р╕Бр╕▓р╕гр╕Ър╕зр╕б р╕зр╕┤р╕Зр╣Ар╕зр╕╡р╕вр╕Щ\n';
        response += '  - р╕зр╕▒р╕Фр╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕Бр╣Ир╕нр╕Щр╕Чр╕▓р╕Щр╕вр╕▓\n\n';
      }
      
      if (takingMedication('metformin')) {
        response += 'тАв Metformin: р╕Чр╕▓р╕Щр╕лр╕ер╕▒р╕Зр╕нр╕▓р╕лр╕▓р╕г р╣Ар╕Кр╣Йр╕▓-р╣Ар╕вр╣Зр╕Щ\n';
        response += '  - р╕Фр╕╖р╣Ир╕бр╕Щр╣Йр╕│р╣Гр╕лр╣Йр╕бр╕▓р╕Б\n';
        response += '  - р╕Хр╕гр╕зр╕Ир╕Щр╣Йр╕│р╕Хр╕▓р╕ер╕Бр╣Ир╕нр╕Щр╕Чр╕▓р╕Щр╕вр╕▓\n\n';
      }
      
      response += 'тЪая╕П р╕Др╕│р╣Ар╕Хр╕╖р╕нр╕Щ:\n';
      response += 'тАв р╕Чр╕▓р╕Щр╕вр╕▓р╕Хр╕гр╕Зр╣Ар╕зр╕ер╕▓р╕Чр╕╕р╕Бр╕зр╕▒р╕Щ\n';
      response += 'тАв р╣Др╕бр╣Ир╕лр╕вр╕╕р╕Фр╕вр╕▓р╣Ар╕нр╕Зр╣Вр╕Фр╕вр╣Др╕бр╣Ир╕Ыр╕гр╕╢р╕Бр╕йр╕▓р╣Бр╕Юр╕Чр╕вр╣М\n';
      response += 'тАв р╕лр╕▓р╕Бр╕бр╕╡р╕Ьр╕ер╕Вр╣Йр╕▓р╕Зр╣Ар╕Др╕╡р╕вр╕З р╣Бр╕Ир╣Йр╕Зр╣Бр╕Юр╕Чр╕вр╣Мр╕Чр╕▒р╕Щр╕Чр╕╡\n';
      response += 'тАв р╣Ар╕Бр╣Зр╕Ър╕вр╕▓р╣Гр╕Щр╕Чр╕╡р╣Ир╣Бр╕лр╣Йр╕З р╣Ар╕вр╣Зр╕Щ р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╣Бр╕кр╕З';
      
      return response;
    }
    
    // р╕Др╕│р╕Цр╕▓р╕бр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ър╕Др╣Ир╕▓р╕Ыр╕Бр╕Хр╕┤
    if (message.includes('р╕Др╣Ир╕▓р╕Ыр╕Бр╕Хр╕┤') || message.includes('р╣Ар╕Бр╕Ур╕Ср╣Мр╕Ыр╕Бр╕Хр╕┤') || message.includes('р╕бр╕▓р╕Хр╕гр╕Рр╕▓р╕Щ')) {
      const latest = getLatestMetrics();
      let response = 'ЁЯУК р╣Ар╕Бр╕Ур╕Ср╣Мр╕Др╣Ир╕▓р╕Ыр╕Бр╕Хр╕┤р╣Бр╕ер╕░р╕Др╣Ир╕▓р╕Вр╕нр╕Зр╕Др╕╕р╕У:\n\n';
      
      response += 'тЪЦя╕П р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б (BMI):\n';
      response += 'тАв р╕Ыр╕Бр╕Хр╕┤: 18.5-24.9\n';
      if (latest.weight && userProfile?.height_cm) {
        const bmi = (latest.weight / Math.pow(userProfile.height_cm / 100, 2)).toFixed(1);
        response += `тАв р╕Др╣Ир╕▓р╕Вр╕нр╕Зр╕Др╕╕р╕У: ${bmi}\n`;
      }
      
      response += '\nЁЯТЧ р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╣Вр╕ер╕лр╕┤р╕Х:\n';
      response += 'тАв р╕Ыр╕Бр╕Хр╕┤: р╕Щр╣Йр╕нр╕вр╕Бр╕зр╣Ир╕▓ 120/80 mmHg\n';
      response += 'тАв р╕кр╕╣р╕Зр╣Ар╕ер╣Зр╕Бр╕Щр╣Йр╕нр╕в: 120-129/<80 mmHg\n';
      response += 'тАв р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З: тЙе130/80 mmHg\n';
      if (latest.systolic && latest.diastolic) {
        response += `тАв р╕Др╣Ир╕▓р╕Вр╕нр╕Зр╕Др╕╕р╕У: ${latest.systolic}/${latest.diastolic} mmHg\n`;
      }
      
      response += '\nЁЯНп р╕Щр╣Йр╕│р╕Хр╕▓р╕ер╣Гр╕Щр╣Ар╕ер╕╖р╕нр╕Ф:\n';
      response += 'тАв р╕Ыр╕Бр╕Хр╕┤ (р╕Бр╣Ир╕нр╕Щр╕нр╕▓р╕лр╕▓р╕г): 70-99 mg/dL\n';
      response += 'тАв р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ: 100-125 mg/dL\n';
      response += 'тАв р╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ: тЙе126 mg/dL\n';
      if (latest.bloodSugar) {
        response += `тАв р╕Др╣Ир╕▓р╕Вр╕нр╕Зр╕Др╕╕р╕У: ${latest.bloodSugar} mg/dL\n`;
      }
      
      response += '\nЁЯТУ р╕нр╕▒р╕Хр╕гр╕▓р╕Бр╕▓р╕гр╣Ар╕Хр╣Йр╕Щр╕лр╕▒р╕зр╣Гр╕И:\n';
      response += 'тАв р╕Ыр╕Бр╕Хр╕┤: 60-100 р╕Др╕гр╕▒р╣Йр╕З/р╕Щр╕▓р╕Чр╕╡\n';
      if (latest.heartRate) {
        response += `тАв р╕Др╣Ир╕▓р╕Вр╕нр╕Зр╕Др╕╕р╕У: ${latest.heartRate} р╕Др╕гр╕▒р╣Йр╕З/р╕Щр╕▓р╕Чр╕╡\n`;
      }
      
      return response;
    }
    
    // р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕вр╕▓р╕Хр╣Ир╕▓р╕Зр╣Ж - р╣Ар╕Юр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╣Бр╕Щр╕░р╕Щр╕│р╣Ар╕Йр╕Юр╕▓р╕░р╕Ър╕╕р╕Др╕Др╕е
    if (message.includes('amlodipine') || message.includes('amlopine') || message.includes('р╣Бр╕нр╕бр╣Вр╕ер╕Фр╕┤р╕Ыр╕╡р╕Щ')) {
      let response = 'Amlodipine (р╣Бр╕нр╕бр╣Вр╕ер╕Фр╕┤р╕Ыр╕╡р╕Щ) - р╕вр╕▓р╕ер╕Фр╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╣Вр╕ер╕лр╕┤р╕Х: \nЁЯТК р╕Бр╕ер╕╕р╣Ир╕б: Calcium Channel Blocker \nЁЯОп р╣Гр╕Кр╣Йр╕кр╕│р╕лр╕гр╕▒р╕Ъ: р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╣Вр╕ер╕лр╕┤р╕Хр╕кр╕╣р╕З, р╣Вр╕гр╕Др╕лр╕▒р╕зр╣Гр╕Ир╕Вр╕▓р╕Фр╣Ар╕ер╕╖р╕нр╕Ф \nтП░ р╕зр╕┤р╕Шр╕╡р╣Гр╕Кр╣Й: р╕зр╕▒р╕Щр╕ер╕░ 1 р╕Др╕гр╕▒р╣Йр╕З р╕Др╕зр╕гр╕Бр╕┤р╕Щр╕Хр╕нр╕Щр╣Ар╕Кр╣Йр╕▓ \nтЪая╕П р╕Ьр╕ер╕Вр╣Йр╕▓р╕Зр╣Ар╕Др╕╡р╕вр╕З: р╣Гр╕Ър╕лр╕Щр╣Йр╕▓р╕Ър╕зр╕б р╕Вр╕▓р╕Ър╕зр╕б р╕зр╕┤р╕Зр╣Ар╕зр╕╡р╕вр╕Щ \nтЭЧ р╕лр╣Йр╕▓р╕бр╕лр╕вр╕╕р╕Фр╕вр╕▓р╣Ар╕нр╕Зр╣Вр╕Фр╕вр╣Др╕бр╣Ир╕Ыр╕гр╕╢р╕Бр╕йр╕▓р╣Бр╕Юр╕Чр╕вр╣М';
      
      if (takingMedication('amlodipine')) {
        response += '\n\nЁЯСд р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕╕р╕Ур╣Ар╕Йр╕Юр╕▓р╕░:\nтАв р╕Др╕зр╕гр╕Хр╕гр╕зр╕Ир╕зр╕▒р╕Фр╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕бр╣Ир╕│р╣Ар╕кр╕бр╕н\nтАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕Бр╕▓р╕гр╕ер╕╕р╕Бр╕Вр╕╢р╣Йр╕Щр╕вр╕╖р╕Щр╣Ар╕гр╣Зр╕зр╣Ж\nтАв р╕Фр╕╖р╣Ир╕бр╕Щр╣Йр╕│р╣Гр╕лр╣Йр╣Ар╕Юр╕╡р╕вр╕Зр╕Юр╕н\nтАв р╕лр╕▓р╕Бр╕бр╕╡р╕нр╕▓р╕Бр╕▓р╕гр╕Ър╕зр╕бр╣Ар╕Юр╕┤р╣Ир╕бр╕Вр╕╢р╣Йр╕Щ р╕Др╕зр╕гр╣Бр╕Ир╣Йр╕Зр╣Бр╕Юр╕Чр╕вр╣М';
      }
      
      return response;
    }
    
    if (message.includes('tb') || message.includes('р╕зр╕▒р╕Ур╣Вр╕гр╕Д') || message.includes('р╕вр╕▓р╕зр╕▒р╕Ур╣Вр╕гр╕Д')) {
      let response = 'р╕вр╕▓р╕гр╕▒р╕Бр╕йр╕▓р╕зр╕▒р╕Ур╣Вр╕гр╕Д - р╕Хр╣Йр╕нр╕Зр╕Бр╕┤р╕Щр╕Хр╣Ир╕нр╣Ар╕Щр╕╖р╣Ир╕нр╕Зр╕Хр╕▓р╕бр╣Бр╕Юр╕Чр╕вр╣Мр╕Бр╕│р╕лр╕Щр╕Ф: \nЁЯТК р╕вр╕▓р╕лр╕ер╕▒р╕Б: Isoniazid, Rifampin, Ethambutol, Pyrazinamide \nтП░ р╕гр╕░р╕вр╕░р╣Ар╕зр╕ер╕▓: р╕нр╕вр╣Ир╕▓р╕Зр╕Щр╣Йр╕нр╕в 6-9 р╣Ар╕Фр╕╖р╕нр╕Щ \nЁЯН╜я╕П р╕Др╕зр╕гр╕Бр╕┤р╕Щр╕Хр╕нр╕Щр╕Чр╣Йр╕нр╕Зр╕зр╣Ир╕▓р╕З (р╕Бр╣Ир╕нр╕Щр╕нр╕▓р╕лр╕▓р╕г 1 р╕Кр╕▒р╣Ир╕зр╣Вр╕бр╕З) \nтЪая╕П р╕кр╕│р╕Др╕▒р╕Нр╕бр╕▓р╕Б: р╕лр╣Йр╕▓р╕бр╕лр╕вр╕╕р╕Фр╕вр╕▓р╕Бр╕ер╕▓р╕Зр╕Др╕▒р╕Щ р╣Бр╕бр╣Йр╕нр╕▓р╕Бр╕▓р╕гр╕Фр╕╡р╕Вр╕╢р╣Йр╕Щ \nЁЯПе р╕Др╕зр╕гр╕Хр╕┤р╕Фр╕Хр╕▓р╕бр╕Ьр╕ер╕Бр╕▓р╕гр╕гр╕▒р╕Бр╕йр╕▓р╕Бр╕▒р╕Ър╣Бр╕Юр╕Чр╕вр╣Мр╕кр╕бр╣Ир╕│р╣Ар╕кр╕бр╕н';
      
      if (hasCondition('р╕зр╕▒р╕Ур╣Вр╕гр╕Д') || hasCondition('tb') || takingMedication('isoniazid') || takingMedication('rifampin')) {
        response += '\n\nЁЯСд р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕╕р╕Ур╣Ар╕Йр╕Юр╕▓р╕░:\nтАв р╕Бр╕┤р╕Щр╕вр╕▓р╣Гр╕лр╣Йр╕Др╕гр╕Ър╕Чр╕╕р╕Бр╣Ар╕бр╣Зр╕Фр╕Хр╕▓р╕бр╣Бр╕Юр╕Чр╕вр╣Мр╕кр╕▒р╣Ир╕З\nтАв р╣Бр╕вр╕Бр╣Гр╕Кр╣Йр╕Ьр╣Йр╕▓р╣Ар╕Кр╣Зр╕Фр╕лр╕Щр╣Йр╕▓ р╣Бр╕Бр╣Йр╕з р╕Кр╣Йр╕нр╕Щр╕кр╣Йр╕нр╕б\nтАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╣Бр╕нр╕ер╕Бр╕нр╕ор╕нр╕ер╣М\nтАв р╕Юр╕▒р╕Бр╕Ьр╣Ир╕нр╕Щр╣Гр╕лр╣Йр╣Ар╕Юр╕╡р╕вр╕Зр╕Юр╕н\nтАв р╕Бр╕┤р╕Щр╕нр╕▓р╕лр╕▓р╕гр╕Чр╕╡р╣Ир╕бр╕╡р╣Вр╕Ыр╕гр╕Хр╕╡р╕Щр╕кр╕╣р╕З';
      }
      
      return response;
    }
    
    if (message.includes('metformin') || message.includes('р╣Ар╕бр╕Хр╕Яр╕нр╕гр╣Мр╕бр╕┤р╕Щ') || message.includes('р╕вр╕▓р╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ')) {
      let response = 'Metformin (р╣Ар╕бр╕Хр╕Яр╕нр╕гр╣Мр╕бр╕┤р╕Щ) - р╕вр╕▓р╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щр╕Кр╕Щр╕┤р╕Ф 2: \nЁЯТК р╣Гр╕Кр╣Йр╕кр╕│р╕лр╕гр╕▒р╕Ъ: р╕ер╕Фр╕Щр╣Йр╕│р╕Хр╕▓р╕ер╣Гр╕Щр╣Ар╕ер╕╖р╕нр╕Ф р╕ер╕Фр╕Бр╕▓р╕гр╕Фр╕╣р╕Фр╕Лр╕╢р╕бр╕Щр╣Йр╕│р╕Хр╕▓р╕е \nЁЯН╜я╕П р╕зр╕┤р╕Шр╕╡р╣Гр╕Кр╣Й: р╕Бр╕┤р╕Щр╕Юр╕гр╣Йр╕нр╕бр╕нр╕▓р╕лр╕▓р╕гр╕лр╕гр╕╖р╕нр╕лр╕ер╕▒р╕Зр╕нр╕▓р╕лр╕▓р╕г \nтЪая╕П р╕Ьр╕ер╕Вр╣Йр╕▓р╕Зр╣Ар╕Др╕╡р╕вр╕З: р╕Чр╣Йр╕нр╕Зр╣Ар╕кр╕╡р╕в р╕Др╕ер╕╖р╣Ир╕Щр╣Др╕кр╣Йр╣Гр╕Щр╕Кр╣Ир╕зр╕Зр╣Бр╕гр╕Б \nтЬЕ р╣Др╕бр╣Ир╕Чр╕│р╣Гр╕лр╣Йр╕Щр╣Йр╕│р╕Хр╕▓р╕ер╕Хр╣Ир╕│р╣Ар╕нр╕Зр╕Цр╣Йр╕▓р╣Гр╕Кр╣Йр╕Др╕Щр╣Ар╕Фр╕╡р╕вр╕з \nЁЯТб р╕Кр╣Ир╕зр╕вр╕ер╕Фр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╣Ар╕ер╣Зр╕Бр╕Щр╣Йр╕нр╕в';
      
      if (hasCondition('р╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ') || hasCondition('diabetes') || takingMedication('metformin')) {
        const latestSugar = recentMetrics.find(m => m.blood_sugar);
        response += '\n\nЁЯСд р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕╕р╕Ур╣Ар╕Йр╕Юр╕▓р╕░:\nтАв р╕Бр╕┤р╕Щр╕нр╕▓р╕лр╕▓р╕гр╕Хр╕гр╕Зр╣Ар╕зр╕ер╕▓ 3 р╕бр╕╖р╣Йр╕нр╕лр╕ер╕▒р╕Б\nтАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕нр╕▓р╕лр╕▓р╕гр╕лр╕зр╕▓р╕Щ р╣Бр╕Ыр╣Йр╕З\nтАв р╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╕кр╕бр╣Ир╕│р╣Ар╕кр╕бр╕н\nтАв р╕Хр╕гр╕зр╕Ир╕Щр╣Йр╕│р╕Хр╕▓р╕ер╣Ар╕Ыр╣Зр╕Щр╕Ыр╕гр╕░р╕Ир╕│';
        
        if (latestSugar && latestSugar.blood_sugar > 140) {
          response += '\nтЪая╕П р╕Щр╣Йр╕│р╕Хр╕▓р╕ер╕ер╣Ир╕▓р╕кр╕╕р╕Фр╕Вр╕нр╕Зр╕Др╕╕р╕У ' + latestSugar.blood_sugar + ' mg/dL р╕кр╕╣р╕Зр╕Бр╕зр╣Ир╕▓р╕Ыр╕Бр╕Хр╕┤ р╕Др╕зр╕гр╕гр╕░р╕зр╕▒р╕Зр╕нр╕▓р╕лр╕▓р╕г';
        }
      }
      
      return response;
    }
    
    // р╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│р╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Чр╕▒р╣Ир╕зр╣Др╕Ы - р╕Ыр╕гр╕▒р╕Ър╕Хр╕▓р╕бр╕кр╕ар╕▓р╕Юр╕кр╣Ир╕зр╕Щр╕Ър╕╕р╕Др╕Др╕е
    if (message.includes('р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щ') || message.includes('blood pressure')) {
      let response = 'р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╣Вр╕ер╕лр╕┤р╕Хр╕Ыр╕Бр╕Хр╕┤: \nтАв р╕Ыр╕Бр╕Хр╕┤: р╕Хр╣Ир╕│р╕Бр╕зр╣Ир╕▓ 120/80 mmHg \nтАв р╕кр╕╣р╕Зр╣Ар╕ер╣Зр╕Бр╕Щр╣Йр╕нр╕в: 120-129/<80 mmHg \nтАв р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕Зр╕гр╕░р╕вр╕░ 1: 130-139/80-89 mmHg \nтАв р╕Др╕зр╕гр╕Хр╕гр╕зр╕Ир╕кр╕бр╣Ир╕│р╣Ар╕кр╕бр╕н \nтЪая╕П р╕лр╕▓р╕Бр╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕Зр╣Ар╕Бр╕┤р╕Щ 140/90 р╕Хр╣Ир╕нр╣Ар╕Щр╕╖р╣Ир╕нр╕З р╕Др╕зр╕гр╕Юр╕Ър╣Бр╕Юр╕Чр╕вр╣М';
      
      if (hasCondition('р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З') || hasCondition('hypertension') || takingMedication('amlodipine')) {
        const latestBP = recentMetrics.find(m => m.systolic_bp && m.diastolic_bp);
        response += '\n\nЁЯСд р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕╕р╕Ур╣Ар╕Йр╕Юр╕▓р╕░:\nтАв р╕ер╕Фр╣Ар╕Бр╕ер╕╖р╕нр╣Бр╕ер╕░р╕нр╕▓р╕лр╕▓р╕гр╣Бр╕Ыр╕гр╕гр╕╣р╕Ы\nтАв р╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╣Ар╕Ър╕▓р╣Ж р╕кр╕бр╣Ир╕│р╣Ар╕кр╕бр╕н\nтАв р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Др╕зр╕▓р╕бр╣Ар╕Др╕гр╕╡р╕вр╕Ф\nтАв р╕Хр╕гр╕зр╕Ир╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕Чр╕╕р╕Бр╕зр╕▒р╕Щ';
        
        if (latestBP && (latestBP.systolic_bp >= 140 || latestBP.diastolic_bp >= 90)) {
          response += `\nтЪая╕П р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕ер╣Ир╕▓р╕кр╕╕р╕Фр╕Вр╕нр╕Зр╕Др╕╕р╕У ${latestBP.systolic_bp}/${latestBP.diastolic_bp} р╕кр╕╣р╕Зр╕Бр╕зр╣Ир╕▓р╕Ыр╕Бр╕Хр╕┤ р╕Др╕зр╕гр╕Юр╕▒р╕Бр╕Ьр╣Ир╕нр╕Щр╣Бр╕ер╕░р╕Бр╕┤р╕Щр╕вр╕▓р╕Хр╕гр╕Зр╣Ар╕зр╕ер╕▓`;
        }
      }
      
      return response;
    }
    
    if (message.includes('р╕Щр╣Йр╕│р╕Хр╕▓р╕е') || message.includes('sugar') || message.includes('р╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ')) {
      let response = 'р╕гр╕░р╕Фр╕▒р╕Ър╕Щр╣Йр╕│р╕Хр╕▓р╕ер╣Гр╕Щр╣Ар╕ер╕╖р╕нр╕Фр╕Ыр╕Бр╕Хр╕┤: \nтАв р╕Бр╣Ир╕нр╕Щр╕нр╕▓р╕лр╕▓р╕г: 70-99 mg/dL \nтАв р╕лр╕ер╕▒р╕Зр╕нр╕▓р╕лр╕▓р╕г 2 р╕Кр╕б: р╕Хр╣Ир╕│р╕Бр╕зр╣Ир╕▓ 140 mg/dL \nтАв HbA1c: р╕Хр╣Ир╕│р╕Бр╕зр╣Ир╕▓ 5.7% \nЁЯНО р╕Др╕зр╕Ър╕Др╕╕р╕бр╕нр╕▓р╕лр╕▓р╕г р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕Щр╣Йр╕│р╕Хр╕▓р╕ер╣Бр╕ер╕░р╣Бр╕Ыр╣Йр╕З \nтЪая╕П р╕лр╕▓р╕Бр╕кр╕╣р╕Зр╣Ар╕Бр╕┤р╕Щ 126 mg/dL р╕Др╕зр╕гр╕Юр╕Ър╣Бр╕Юр╕Чр╕вр╣М';
      
      if (hasCondition('р╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ') || hasCondition('diabetes')) {
        const latestSugar = recentMetrics.find(m => m.blood_sugar);
        response += '\n\nя┐╜ р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕╕р╕Ур╣Ар╕Йр╕Юр╕▓р╕░:\nтАв р╕Бр╕┤р╕Щр╕Вр╣Йр╕▓р╕зр╕Бр╕ер╣Йр╕нр╕З р╕Вр╕Щр╕бр╕Ыр╕▒р╕Зр╣Вр╕ор╕ер╕зр╕╡р╕Ч\nтАв р╣Ар╕Юр╕┤р╣Ир╕бр╕Ьр╕▒р╕Бр╣Гр╕Ър╣Ар╕Вр╕╡р╕вр╕з\nтАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕Ьр╕ер╣Др╕бр╣Йр╕лр╕зр╕▓р╕Щр╕Ир╕▒р╕Ф\nтАв р╣Бр╕Ър╣Ир╕Зр╕нр╕▓р╕лр╕▓р╕гр╣Ар╕Ыр╣Зр╕Щ 5-6 р╕бр╕╖р╣Йр╕нр╣Ар╕ер╣Зр╕Б';
        
        if (latestSugar) {
          if (latestSugar.blood_sugar > 180) {
            response += `\nЁЯЪи р╕Щр╣Йр╕│р╕Хр╕▓р╕ер╕ер╣Ир╕▓р╕кр╕╕р╕Ф ${latestSugar.blood_sugar} mg/dL р╕кр╕╣р╕Зр╕бр╕▓р╕Б р╕Др╕зр╕гр╕Юр╕Ър╣Бр╕Юр╕Чр╕вр╣Мр╕Фр╣Ир╕зр╕Щ`;
          } else if (latestSugar.blood_sugar > 140) {
            response += `\nтЪая╕П р╕Щр╣Йр╕│р╕Хр╕▓р╕ер╕ер╣Ир╕▓р╕кр╕╕р╕Ф ${latestSugar.blood_sugar} mg/dL р╕кр╕╣р╕Зр╕Бр╕зр╣Ир╕▓р╕Ыр╕Бр╕Хр╕┤ р╕гр╕░р╕зр╕▒р╕Зр╕нр╕▓р╕лр╕▓р╕г`;
          }
        }
      }
      
      return response;
    }
    
    // р╕Др╕│р╕Цр╕▓р╕бр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ър╕нр╕▓р╕лр╕▓р╕гр╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░р╕кр╕б
    if (message.includes('р╕нр╕▓р╕лр╕▓р╕гр╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░') || message.includes('р╕нр╕▓р╕лр╕▓р╕гр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Йр╕▒р╕Щ') || message.includes('р╕Др╕зр╕гр╕Бр╕┤р╕Щр╕нр╕░р╣Др╕г')) {
      let response = 'ЁЯН╜я╕П р╣Бр╕Ьр╕Щр╕нр╕▓р╕лр╕▓р╕гр╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕╕р╕У:\n\n';
      
      if (hasCondition('р╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ')) {
        response += 'ЁЯНп р╕нр╕▓р╕лр╕▓р╕гр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕╣р╣Йр╣Ар╕Ыр╣Зр╕Щр╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ:\n';
        response += 'тЬЕ р╕Др╕зр╕гр╕Бр╕┤р╕Щ:\n';
        response += 'тАв р╕Вр╣Йр╕▓р╕зр╕Бр╕ер╣Йр╕нр╕З р╕Вр╣Йр╕▓р╕зр╕Лр╣Йр╕нр╕бр╕бр╕╖р╕н\n';
        response += 'тАв р╕Ьр╕▒р╕Бр╣Гр╕Ър╣Ар╕Вр╕╡р╕вр╕зр╣Ар╕Вр╣Йр╕б\n';
        response += 'тАв р╣Ар╕Щр╕╖р╣Йр╕нр╕Ыр╕ер╕▓ р╣Др╕Бр╣Ир╣Др╕бр╣Ир╕Хр╕┤р╕Фр╕лр╕Щр╕▒р╕З\n';
        response += 'тАв р╕Цр╕▒р╣Ир╕зр╣Ар╕бр╕ер╣Зр╕Фр╣Бр╕лр╣Йр╕З\n';
        response += 'тАв р╕Ьр╕ер╣Др╕бр╣Йр╕гр╕кр╣Ар╕Ыр╕гр╕╡р╣Йр╕вр╕з (р╣Бр╕нр╕Ыр╣Ар╕Ыр╕┤р╣Йр╕е р╕кр╣Йр╕б)\n\n';
        response += 'тЭМ р╕Др╕зр╕гр╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕З:\n';
        response += 'тАв р╕Вр╣Йр╕▓р╕зр╕Вр╕▓р╕з р╣Бр╕Ыр╣Йр╕Зр╕Вр╕▓р╕з\n';
        response += 'тАв р╕Вр╕Щр╕бр╕лр╕зр╕▓р╕Щ р╕Щр╣Йр╕│р╕нр╕▒р╕Фр╕ер╕б\n';
        response += 'тАв р╕Ьр╕ер╣Др╕бр╣Йр╕лр╕зр╕▓р╕Щ (р╕Чр╕╕р╣Ар╕гр╕╡р╕вр╕Щ р╕нр╕Зр╕╕р╣Ир╕Щ)\n';
        response += 'тАв р╕нр╕▓р╕лр╕▓р╕гр╕Чр╕нр╕Ф р╕нр╕▓р╕лр╕▓р╕гр╣Бр╕Ыр╕гр╕гр╕╣р╕Ы\n\n';
      }
      
      if (hasCondition('р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З')) {
        response += 'ЁЯТЧ р╕нр╕▓р╕лр╕▓р╕гр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕╣р╣Йр╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З:\n';
        response += 'тЬЕ р╕Др╕зр╕гр╕Бр╕┤р╕Щ:\n';
        response += 'тАв р╕Ьр╕▒р╕Бр╣Гр╕Ър╣Ар╕Вр╕╡р╕вр╕з р╕Ьр╕ер╣Др╕бр╣Йр╕кр╕Ф\n';
        response += 'тАв р╕Ыр╕ер╕▓р╕Чр╕░р╣Ар╕е р╕нр╕▒р╕ер╕бр╕нр╕Щр╕Фр╣М\n';
        response += 'тАв р╣Вр╕нр╣Кр╕Хр╕бр╕╡р╕е р╕Шр╕▒р╕Нр╕Юр╕╖р╕Кр╣Ар╕Хр╣Зр╕бр╣Ар╕бр╕ер╣Зр╕Ф\n';
        response += 'тАв р╕Бр╕ер╣Йр╕зр╕в р╕нр╣Вр╕зр╕Др╕▓р╣Вр╕Ф (р╕бр╕╡р╣Вр╕Юр╣Бр╕Чр╕кр╣Ар╕Лр╕╡р╕вр╕б)\n\n';
        response += 'тЭМ р╕Др╕зр╕гр╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕З:\n';
        response += 'тАв р╣Ар╕Бр╕ер╕╖р╕н р╕Щр╣Йр╕│р╕Ыр╕ер╕▓ р╕Лр╕╡р╕нр╕┤р╣Кр╕з\n';
        response += 'тАв р╕нр╕▓р╕лр╕▓р╕гр╕Бр╕гр╕░р╕Ыр╣Лр╕нр╕З р╣Др╕кр╣Йр╕Бр╕гр╕нр╕Б\n';
        response += 'тАв р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕Фр╕╖р╣Ир╕бр╣Бр╕нр╕ер╕Бр╕нр╕ор╕нр╕ер╣М\n';
        response += 'тАв р╕Бр╕▓р╣Бр╕Яр╣Ар╕Вр╣Йр╕бр╕Вр╣Йр╕Щ\n\n';
      }
      
      if (hasCondition('р╣Вр╕гр╕Др╕лр╕▒р╕зр╣Гр╕И')) {
        response += 'ЁЯТУ р╕нр╕▓р╕лр╕▓р╕гр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕╣р╣Йр╣Вр╕гр╕Др╕лр╕▒р╕зр╣Гр╕И:\n';
        response += 'тЬЕ р╕Др╕зр╕гр╕Бр╕┤р╕Щ:\n';
        response += 'тАв р╕Ыр╕ер╕▓р╣Бр╕Лр╕ер╕бр╕нр╕Щ р╕Ыр╕ер╕▓р╕Чр╕╣р╕Щр╣Ир╕▓\n';
        response += 'тАв р╕нр╕▒р╕ер╕бр╕нр╕Щр╕Фр╣М р╕зр╕нр╕ер╕Щр╕▒р╕Ч\n';
        response += 'тАв р╕Щр╣Йр╕│р╕бр╕▒р╕Щр╕бр╕░р╕Бр╕нр╕Б\n';
        response += 'тАв р╕Ьр╕▒р╕Бр╣Гр╕Ър╣Ар╕Вр╕╡р╕вр╕з р╕Ьр╕ер╣Ар╕Ър╕нр╕гр╕╡р╣И\n\n';
        response += 'тЭМ р╕Др╕зр╕гр╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕З:\n';
        response += 'тАв р╣Др╕Вр╕бр╕▒р╕Щр╕нр╕┤р╣Ир╕бр╕Хр╕▒р╕з (р╣Ар╕Щр╕╖р╣Йр╕нр╣Бр╕Фр╕З)\n';
        response += 'тАв р╕нр╕▓р╕лр╕▓р╕гр╕Чр╕нр╕Ф\n';
        response += 'тАв р╣Ар╕Щр╕в р╕бр╕▓р╕гр╣Мр╕Бр╕▓р╕гр╕╡р╕Щ\n';
        response += 'тАв р╕Вр╕нр╕Зр╕лр╕зр╕▓р╕Щр╕бр╕▓р╕Бр╣Ар╕Бр╕┤р╕Щр╣Др╕Ы\n\n';
      }
      
      if (!hasCondition('р╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ') && !hasCondition('р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З') && !hasCondition('р╣Вр╕гр╕Др╕лр╕▒р╕зр╣Гр╕И')) {
        response += 'ЁЯМЯ р╕нр╕▓р╕лр╕▓р╕гр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕Щр╕Чр╕▒р╣Ир╕зр╣Др╕Ы:\n';
        response += 'тАв р╕Бр╕┤р╕Щр╕Др╕гр╕Ъ 5 р╕лр╕бр╕╣р╣Ир╣Гр╕Щр╕кр╕▒р╕Фр╕кр╣Ир╕зр╕Щр╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░р╕кр╕б\n';
        response += 'тАв р╕Ьр╕▒р╕Бр╕Ьр╕ер╣Др╕бр╣Й 5-9 р╕кр╣Ир╕зр╕Щ/р╕зр╕▒р╕Щ\n';
        response += 'тАв р╕Шр╕▒р╕Нр╕Юр╕╖р╕Кр╣Ар╕Хр╣Зр╕бр╣Ар╕бр╕ер╣Зр╕Ф\n';
        response += 'тАв р╣Вр╕Ыр╕гр╕Хр╕╡р╕Щр╕Ир╕▓р╕Бр╕Ыр╕ер╕▓ р╣Ар╕Щр╕╖р╣Йр╕нр╕Вр╕▓р╕з\n';
        response += 'тАв р╕Щр╕бр╣Бр╕ер╕░р╕Ьр╕ер╕┤р╕Хр╕ар╕▒р╕Ур╕Ср╣Мр╕Щр╕бр╣Др╕Вр╕бр╕▒р╕Щр╕Хр╣Ир╕│\n\n';
      }
      
      response += 'ЁЯТб р╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│р╕Чр╕▒р╣Ир╕зр╣Др╕Ы:\n';
      response += 'тАв р╕Бр╕┤р╕Щр╕нр╕▓р╕лр╕▓р╕г 3 р╕бр╕╖р╣Йр╕нр╕лр╕ер╕▒р╕Б 2 р╕зр╣Ир╕▓р╕З\n';
      response += 'тАв р╕Фр╕╖р╣Ир╕бр╕Щр╣Йр╕│ 8-10 р╣Бр╕Бр╣Йр╕з/р╕зр╕▒р╕Щ\n';
      response += 'тАв р╣Ар╕Др╕╡р╣Йр╕вр╕зр╕нр╕▓р╕лр╕▓р╕гр╣Гр╕лр╣Йр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф\n';
      response += 'тАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕нр╕▓р╕лр╕▓р╕гр╕Бр╣Ир╕нр╕Щр╕Щр╕нр╕Щ 2 р╕Кр╕▒р╣Ир╕зр╣Вр╕бр╕З';
      
      return response;
    }
    
    // р╕Др╕│р╕Цр╕▓р╕бр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ър╕Бр╕▓р╕гр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╣Ар╕Йр╕Юр╕▓р╕░р╕Ър╕╕р╕Др╕Др╕е
    if (message.includes('р╕Бр╕▓р╕гр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Йр╕▒р╕Щ') || message.includes('р╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╕нр╕вр╣Ир╕▓р╕Зр╣Др╕г') || message.includes('exercise р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Йр╕▒р╕Щ')) {
      let response = 'ЁЯПГтАНтЩВя╕П р╣Бр╕Ьр╕Щр╕Бр╕▓р╕гр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕╕р╕У:\n\n';
      
      if (hasCondition('р╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ')) {
        response += 'ЁЯНп р╕Бр╕▓р╕гр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕╣р╣Йр╣Ар╕Ыр╣Зр╕Щр╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ:\n';
        response += 'тП░ р╕Кр╣Ир╕зр╕Зр╣Ар╕зр╕ер╕▓: р╕лр╕ер╕▒р╕Зр╕нр╕▓р╕лр╕▓р╕г 1-2 р╕Кр╕▒р╣Ир╕зр╣Вр╕бр╕З\n';
        response += 'ЁЯОп р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в: 150 р╕Щр╕▓р╕Чр╕╡/р╕кр╕▒р╕Ыр╕Фр╕▓р╕лр╣М\n\n';
        response += 'тЬЕ р╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕бр╕Чр╕╡р╣Ир╣Бр╕Щр╕░р╕Щр╕│:\n';
        response += 'тАв р╣Ар╕Фр╕┤р╕Щр╣Ар╕гр╣Зр╕з 30 р╕Щр╕▓р╕Чр╕╡/р╕зр╕▒р╕Щ\n';
        response += 'тАв р╕зр╣Ир╕▓р╕вр╕Щр╣Йр╕│ 3 р╕Др╕гр╕▒р╣Йр╕З/р╕кр╕▒р╕Ыр╕Фр╕▓р╕лр╣М\n';
        response += 'тАв р╕вр╕╖р╕Фр╣Ар╕кр╣Йр╕Щр╕вр╕╖р╕Фр╕кр╕▓р╕в\n';
        response += 'тАв р╣Вр╕вр╕Др╕░ р╣Др╕Чр╣Йр╣Ар╕Бр╣Кр╕Б\n\n';
        response += 'тЪая╕П р╕Вр╣Йр╕нр╕Др╕зр╕гр╕гр╕░р╕зр╕▒р╕З:\n';
        response += 'тАв р╕Хр╕гр╕зр╕Ир╕Щр╣Йр╕│р╕Хр╕▓р╕ер╕Бр╣Ир╕нр╕Щ-р╕лр╕ер╕▒р╕Зр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕в\n';
        response += 'тАв р╕лр╕вр╕╕р╕Фр╕лр╕▓р╕Бр╕Щр╣Йр╕│р╕Хр╕▓р╕ер╕Хр╣Ир╕│р╕Бр╕зр╣Ир╕▓ 100 mg/dL\n';
        response += 'тАв р╕Юр╕Бр╕Вр╕Щр╕бр╕лр╕гр╕╖р╕нр╕Щр╣Йр╕│р╕лр╕зр╕▓р╕Щр╕Хр╕┤р╕Фр╕Хр╕▒р╕з\n';
        response += 'тАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╕лр╕Щр╕▒р╕Бр╕Ир╕▒р╕Ф\n\n';
      }
      
      if (hasCondition('р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З')) {
        response += 'ЁЯТЧ р╕Бр╕▓р╕гр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕╣р╣Йр╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З:\n';
        response += 'тП░ р╕Кр╣Ир╕зр╕Зр╣Ар╕зр╕ер╕▓: р╕Кр╣Ир╕зр╕Зр╣Ар╕Кр╣Йр╕▓р╕лр╕гр╕╖р╕нр╣Ар╕вр╣Зр╕Щ\n';
        response += 'ЁЯОп р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в: 30 р╕Щр╕▓р╕Чр╕╡/р╕зр╕▒р╕Щ 5 р╕зр╕▒р╕Щ/р╕кр╕▒р╕Ыр╕Фр╕▓р╕лр╣М\n\n';
        response += 'тЬЕ р╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕бр╕Чр╕╡р╣Ир╣Бр╕Щр╕░р╕Щр╕│:\n';
        response += 'тАв р╣Ар╕Фр╕┤р╕Щ р╕Ир╣Кр╕нр╕Бр╕Бр╕┤р╣Йр╕Зр╣Ар╕Ър╕▓р╣Ж\n';
        response += 'тАв р╕Ыр╕▒р╣Ир╕Щр╕Ир╕▒р╕Бр╕гр╕вр╕▓р╕Щ\n';
        response += 'тАв р╕зр╣Ир╕▓р╕вр╕Щр╣Йр╕│\n';
        response += 'тАв р╣Ар╕Хр╣Йр╕Щр╣Бр╕нр╣Вр╕гр╕Ър╕┤р╕Б\n\n';
        response += 'тЭМ р╕Др╕зр╕гр╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕З:\n';
        response += 'тАв р╕вр╕Бр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╕лр╕Щр╕▒р╕Б\n';
        response += 'тАв р╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕бр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕ер╕▒р╣Йр╕Щр╕ер╕бр╕лр╕▓р╕вр╣Гр╕И\n';
        response += 'тАв р╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╣Гр╕Щр╕нр╕▓р╕Бр╕▓р╕ир╕гр╣Йр╕нр╕Щр╕Ир╕▒р╕Ф\n\n';
        response += 'тЪая╕П р╕Вр╣Йр╕нр╕Др╕зр╕гр╕гр╕░р╕зр╕▒р╕З:\n';
        response += 'тАв р╕зр╕▒р╕Фр╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕Бр╣Ир╕нр╕Щ-р╕лр╕ер╕▒р╕Зр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕в\n';
        response += 'тАв р╕лр╕вр╕╕р╕Фр╕лр╕▓р╕Бр╕бр╕╡р╕нр╕▓р╕Бр╕▓р╕гр╕зр╕┤р╕Зр╣Ар╕зр╕╡р╕вр╕Щ\n';
        response += 'тАв р╕Фр╕╖р╣Ир╕бр╕Щр╣Йр╕│р╣Ар╕Ыр╣Зр╕Щр╕Ыр╕гр╕░р╕Ир╕│\n\n';
      }
      
      if (hasCondition('р╣Вр╕гр╕Др╕лр╕▒р╕зр╣Гр╕И')) {
        response += 'ЁЯТУ р╕Бр╕▓р╕гр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕╣р╣Йр╣Вр╕гр╕Др╕лр╕▒р╕зр╣Гр╕И:\n';
        response += 'тЪая╕П р╕кр╕│р╕Др╕▒р╕Н: р╕Хр╣Йр╕нр╕Зр╕Ыр╕гр╕╢р╕Бр╕йр╕▓р╣Бр╕Юр╕Чр╕вр╣Мр╕Бр╣Ир╕нр╕Щ\n';
        response += 'ЁЯОп р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в: р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ 10-15 р╕Щр╕▓р╕Чр╕╡/р╕зр╕▒р╕Щ\n\n';
        response += 'тЬЕ р╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕бр╕Чр╕╡р╣Ир╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в:\n';
        response += 'тАв р╣Ар╕Фр╕┤р╕Щр╣Ар╕Ър╕▓р╣Ж\n';
        response += 'тАв р╣Вр╕вр╕Др╕░ р╕кр╕Хр╕┤р╣Ар╕Чр╕Кр╕▒р╣Ир╕Щ\n';
        response += 'тАв р╕вр╕╖р╕Фр╣Ар╕кр╣Йр╕Щр╕вр╕╖р╕Фр╕кр╕▓р╕в\n';
        response += 'тАв р╕Бр╕▓р╕вр╕ар╕▓р╕Юр╕Ър╕│р╕Ър╕▒р╕Фр╕Хр╕▓р╕бр╣Бр╕Юр╕Чр╕вр╣Мр╣Бр╕Щр╕░р╕Щр╕│\n\n';
        response += 'ЁЯЪл р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╕лр╣Йр╕▓р╕бр╕Чр╕│:\n';
        response += 'тАв р╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╕лр╕Щр╕▒р╕Бр╕Ир╕▒р╕Ф\n';
        response += 'тАв р╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕бр╕Чр╕╡р╣Ир╣Бр╕Вр╣Ир╕Зр╕Вр╕▒р╕Щ\n';
        response += 'тАв р╕вр╕Бр╕Вр╕нр╕Зр╕лр╕Щр╕▒р╕Б\n\n';
        response += 'тЪая╕П р╕лр╕вр╕╕р╕Фр╕Чр╕▒р╕Щр╕Чр╕╡р╕лр╕▓р╕Б:\n';
        response += 'тАв р╣Ар╕Ир╣Зр╕Ър╕лр╕Щр╣Йр╕▓р╕нр╕Б р╕лр╕▓р╕вр╣Гр╕Ир╕ер╕│р╕Ър╕▓р╕Б\n';
        response += 'тАв р╕зр╕┤р╕Зр╣Ар╕зр╕╡р╕вр╕Щ р╕Др╕ер╕╖р╣Ир╕Щр╣Др╕кр╣Й\n';
        response += 'тАв р╣Гр╕Ир╕кр╕▒р╣Ир╕Щр╕Ьр╕┤р╕Фр╕Ыр╕Бр╕Хр╕┤\n\n';
      }
      
      if (!hasCondition('р╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ') && !hasCondition('р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З') && !hasCondition('р╣Вр╕гр╕Др╕лр╕▒р╕зр╣Гр╕И')) {
        response += 'ЁЯМЯ р╕Бр╕▓р╕гр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕Щр╕Чр╕▒р╣Ир╕зр╣Др╕Ы:\n';
        response += 'ЁЯОп р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в: 150 р╕Щр╕▓р╕Чр╕╡/р╕кр╕▒р╕Ыр╕Фр╕▓р╕лр╣М\n\n';
        response += 'ЁЯПГтАНтЩВя╕П р╣Бр╕нр╣Вр╕гр╕Ър╕┤р╕Б (4-5 р╕зр╕▒р╕Щ/р╕кр╕▒р╕Ыр╕Фр╕▓р╕лр╣М):\n';
        response += 'тАв р╣Ар╕Фр╕┤р╕Щ р╕Ир╣Кр╕нр╕Бр╕Бр╕┤р╣Йр╕З р╕зр╕┤р╣Ир╕З\n';
        response += 'тАв р╕зр╣Ир╕▓р╕вр╕Щр╣Йр╕│ р╕Ыр╕▒р╣Ир╕Щр╕Ир╕▒р╕Бр╕гр╕вр╕▓р╕Щ\n';
        response += 'тАв р╣Ар╕Хр╣Йр╕Щр╣Бр╕нр╣Вр╕гр╕Ър╕┤р╕Б р╕Бр╕╡р╕мр╕▓р╕Хр╣Ир╕▓р╕Зр╣Ж\n\n';
        response += 'ЁЯТк р╕Бр╕ер╣Йр╕▓р╕бр╣Ар╕Щр╕╖р╣Йр╕н (2-3 р╕зр╕▒р╕Щ/р╕кр╕▒р╕Ыр╕Фр╕▓р╕лр╣М):\n';
        response += 'тАв р╕вр╕Бр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б\n';
        response += 'тАв р╣Бр╕Ьр╕ер╕Щр╕Др╣М р╕кр╕Др╕зр╕нр╕Ч\n';
        response += 'тАв р╕Фр╕▒р╕бр╣Ар╕Ър╕е р╕вр╕▓р╕Зр╕вр╕╖р╕Ф\n\n';
        response += 'ЁЯзШтАНтЩАя╕П р╕вр╕╖р╕Фр╕лр╕вр╕╕р╣Ир╕Щ (р╕Чр╕╕р╕Бр╕зр╕▒р╕Щ):\n';
        response += 'тАв р╕вр╕╖р╕Фр╣Ар╕кр╣Йр╕Щр╕вр╕╖р╕Фр╕кр╕▓р╕в\n';
        response += 'тАв р╣Вр╕вр╕Др╕░ р╕Юр╕┤р╕ер╕▓р╕Чр╕┤р╕к\n\n';
      }
      
      response += 'ЁЯТб р╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│р╕Чр╕▒р╣Ир╕зр╣Др╕Ы:\n';
      response += 'тАв р╕зр╕нр╕гр╣Мр╕бр╕нр╕▒р╕Ю 5-10 р╕Щр╕▓р╕Чр╕╡р╕Бр╣Ир╕нр╕Щр╣Ар╕гр╕┤р╣Ир╕б\n';
      response += 'тАв р╕Др╕╣р╕ер╕Фр╕▓р╕зр╕Щр╣Мр╕лр╕ер╕▒р╕Зр╣Ар╕кр╕гр╣Зр╕И\n';
      response += 'тАв р╣Ар╕Юр╕┤р╣Ир╕бр╕Др╕зр╕▓р╕бр╕лр╕Щр╕▒р╕Бр╕Др╣Ир╕нр╕вр╣Ар╕Ыр╣Зр╕Щр╕Др╣Ир╕нр╕вр╣Др╕Ы\n';
      response += 'тАв р╕Юр╕▒р╕Бр╕Ьр╣Ир╕нр╕Щр╣Гр╕лр╣Йр╣Ар╕Юр╕╡р╕вр╕Зр╕Юр╕н\n';
      response += 'тАв р╕Фр╕╖р╣Ир╕бр╕Щр╣Йр╕│р╕Бр╣Ир╕нр╕Щ р╕гр╕░р╕лр╕зр╣Ир╕▓р╕З р╣Бр╕ер╕░р╕лр╕ер╕▒р╕Зр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕в';
      
      return response;
    }
    
    if (message.includes('р╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕в') || message.includes('exercise')) {
      let response = 'р╕Бр╕▓р╕гр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╕Чр╕╡р╣Ир╣Бр╕Щр╕░р╕Щр╕│: \nтАв р╕Др╕Щр╕Чр╕▒р╣Ир╕зр╣Др╕Ы: 150 р╕Щр╕▓р╕Чр╕╡/р╕кр╕▒р╕Ыр╕Фр╕▓р╕лр╣М \nтАв р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ: 30 р╕Щр╕▓р╕Чр╕╡/р╕зр╕▒р╕Щ 5 р╕зр╕▒р╕Щ/р╕кр╕▒р╕Ыр╕Фр╕▓р╕лр╣М \nтАв р╕Др╕зр╕гр╕бр╕╡р╕Чр╕▒р╣Йр╕Зр╣Бр╕нр╣Вр╕гр╕Ър╕┤р╕Бр╣Бр╕ер╕░р╕Бр╕ер╣Йр╕▓р╕бр╣Ар╕Щр╕╖р╣Йр╕н \nтАв р╕зр╕нр╕гр╣Мр╕бр╕нр╕▒р╕Юр╕Бр╣Ир╕нр╕Щр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕в \nЁЯТк р╣Ар╕гр╕┤р╣Ир╕бр╣Ар╕Ър╕▓р╣Ж р╣Бр╕ер╣Йр╕зр╕Др╣Ир╕нр╕вр╣Ар╕Юр╕┤р╣Ир╕бр╕Др╕зр╕▓р╕бр╕лр╕Щр╕▒р╕Б';
      
      if (hasCondition('р╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ') || hasCondition('diabetes')) {
        response += '\n\nЁЯСд р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕╣р╣Йр╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ:\nтАв р╣Ар╕Фр╕┤р╕Щр╣Ар╕гр╣Зр╕з 30 р╕Щр╕▓р╕Чр╕╡/р╕зр╕▒р╕Щ\nтАв р╕Хр╕гр╕зр╕Ир╕Щр╣Йр╕│р╕Хр╕▓р╕ер╕Бр╣Ир╕нр╕Щ-р╕лр╕ер╕▒р╕Зр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕в\nтАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╕лр╕Щр╕▒р╕Бр╣Ар╕Бр╕┤р╕Щр╣Др╕Ы\nтАв р╕Фр╕╖р╣Ир╕бр╕Щр╣Йр╕│р╣Гр╕лр╣Йр╣Ар╕Юр╕╡р╕вр╕Зр╕Юр╕н';
      }
      
      if (hasCondition('р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З') || hasCondition('hypertension')) {
        response += '\n\nЁЯСд р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕╣р╣Йр╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З:\nтАв р╣Ар╕Фр╕┤р╕Щ р╕зр╣Ир╕▓р╕вр╕Щр╣Йр╕│ р╕Ыр╕▒р╣Ир╕Щр╕Ир╕▒р╕Бр╕гр╕вр╕▓р╕Щ\nтАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕вр╕Бр╕Вр╕нр╕Зр╕лр╕Щр╕▒р╕Б\nтАв р╣Др╕бр╣Ир╕Др╕зр╕гр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╕лр╕Щр╕▒р╕Бр╕Ир╕▒р╕Ф\nтАв р╕лр╕вр╕╕р╕Фр╕Юр╕▒р╕Бр╕лр╕▓р╕Бр╕бр╕╡р╕нр╕▓р╕Бр╕▓р╕гр╕зр╕┤р╕Зр╣Ар╕зр╕╡р╕вр╕Щ';
      }
      
      return response;
    }
    
    // р╕кр╣Ир╕зр╕Щр╕нр╕╖р╣Ир╕Щр╣Ж р╕Др╕Зр╣Ар╕Фр╕┤р╕б...
    if (message.includes('paracetamol') || message.includes('р╕Юр╕▓р╕гр╕▓р╣Ар╕Лр╕Хр╕▓р╕бр╕нр╕е') || message.includes('р╣Бр╕Бр╣Йр╕Ыр╕зр╕Ф')) {
      return 'Paracetamol (р╕Юр╕▓р╕гр╕▓р╣Ар╕Лр╕Хр╕▓р╕бр╕нр╕е) - р╕вр╕▓р╣Бр╕Бр╣Йр╕Ыр╕зр╕Фр╕ер╕Фр╣Др╕Вр╣Й: \nЁЯТК р╕Вр╕Щр╕▓р╕Ф: р╕Ьр╕╣р╣Йр╣Гр╕лр╕Нр╣И 500-1000 mg р╕Чр╕╕р╕Б 4-6 р╕Кр╕▒р╣Ир╕зр╣Вр╕бр╕З \nЁЯУК р╕кр╕╣р╕Зр╕кр╕╕р╕Ф: р╣Др╕бр╣Ир╣Ар╕Бр╕┤р╕Щ 4000 mg р╕Хр╣Ир╕нр╕зр╕▒р╕Щ (8 р╣Ар╕бр╣Зр╕Ф 500mg) \nтЪая╕П р╕гр╕░р╕зр╕▒р╕З: р╕нр╕▒р╕Щр╕Хр╕гр╕▓р╕вр╕Хр╣Ир╕нр╕Хр╕▒р╕Ър╕лр╕▓р╕Бр╣Гр╕Кр╣Йр╣Ар╕Бр╕┤р╕Щр╕Вр╕Щр╕▓р╕Ф \nтЬЕ р╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕вр╕кр╕│р╕лр╕гр╕▒р╕Ър╣Ар╕Фр╣Зр╕Бр╣Бр╕ер╕░р╕лр╕Нр╕┤р╕Зр╕Хр╕▒р╣Йр╕Зр╕Др╕гр╕гр╕ар╣М \nЁЯН║ р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╣Бр╕нр╕ер╕Бр╕нр╕ор╕нр╕ер╣Мр╕Вр╕Ур╕░р╣Гр╕Кр╣Йр╕вр╕▓';
    }
    
    if (message.includes('simvastatin') || message.includes('р╕Лр╕┤р╕бр╕зр╕▓р╕кр╣Бр╕Хр╕Хр╕┤р╕Щ') || message.includes('р╕вр╕▓р╕Др╕нр╣Ар╕ер╕кр╣Ар╕Хр╕нр╕гр╕нр╕е')) {
      return 'Simvastatin (р╕Лр╕┤р╕бр╕зр╕▓р╕кр╣Бр╕Хр╕Хр╕┤р╕Щ) - р╕вр╕▓р╕ер╕Фр╕Др╕нр╣Ар╕ер╕кр╣Ар╕Хр╕нр╕гр╕нр╕е: \nЁЯТК р╣Гр╕Кр╣Йр╕кр╕│р╕лр╕гр╕▒р╕Ъ: р╕ер╕Фр╣Др╕Вр╕бр╕▒р╕Щр╣Гр╕Щр╣Ар╕ер╕╖р╕нр╕Ф р╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╣Вр╕гр╕Др╕лр╕▒р╕зр╣Гр╕И \nЁЯМЩ р╕зр╕┤р╕Шр╕╡р╣Гр╕Кр╣Й: р╕Бр╕┤р╕Щр╕Хр╕нр╕Щр╣Ар╕вр╣Зр╕Щр╕лр╕гр╕╖р╕нр╕Бр╣Ир╕нр╕Щр╕Щр╕нр╕Щ \nтЪая╕П р╕Ьр╕ер╕Вр╣Йр╕▓р╕Зр╣Ар╕Др╕╡р╕вр╕З: р╕Ыр╕зр╕Фр╕Бр╕ер╣Йр╕▓р╕бр╣Ар╕Щр╕╖р╣Йр╕н р╕нр╣Ир╕нр╕Щр╣Ар╕Юр╕ер╕╡р╕в \nтЭЧ р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕кр╣Йр╕бр╣Вр╕н р╕Ьр╕ер╣Др╕бр╣Йр╕Хр╕гр╕░р╕Бр╕╣р╕ер╕кр╣Йр╕б \nЁЯПе р╕Хр╕гр╕зр╕Ир╣Ар╕ер╕╖р╕нр╕Фр╕Хр╕┤р╕Фр╕Хр╕▓р╕б CK, LFT';
    }
    
    if (message.includes('aspirin') || message.includes('р╣Бр╕нр╕кр╣Др╕Юр╕гр╕┤р╕Щ')) {
      return 'Aspirin (р╣Бр╕нр╕кр╣Др╕Юр╕гр╕┤р╕Щ) - р╕вр╕▓р╕Хр╣Йр╕▓р╕Щр╕Бр╕▓р╕гр╣Бр╕Вр╣Зр╕Зр╕Хр╕▒р╕зр╕Вр╕нр╕Зр╣Ар╕ер╕╖р╕нр╕Ф: \nЁЯТК р╣Гр╕Кр╣Йр╕кр╕│р╕лр╕гр╕▒р╕Ъ: р╣Бр╕Бр╣Йр╕Ыр╕зр╕Ф р╕ер╕Фр╣Др╕Вр╣Й р╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╕ер╕┤р╣Ир╕бр╣Ар╕ер╕╖р╕нр╕Ф \nтЪб р╕Вр╕Щр╕▓р╕Фр╕Хр╣Ир╕│ (81-100 mg): р╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╣Вр╕гр╕Др╕лр╕▒р╕зр╣Гр╕И \nтЪая╕П р╕Ьр╕ер╕Вр╣Йр╕▓р╕Зр╣Ар╕Др╕╡р╕вр╕З: р╕гр╕░р╕Др╕▓р╕вр╣Ар╕Др╕╖р╕нр╕Зр╕Бр╕гр╕░р╣Ар╕Юр╕▓р╕░ р╣Ар╕кр╕╡р╣Ир╕вр╕Зр╣Ар╕ер╕╖р╕нр╕Фр╕нр╕нр╕Б \nтЭЧ р╣Др╕бр╣Ир╕Др╕зр╕гр╣Гр╕лр╣Йр╣Ар╕Фр╣Зр╕Бр╕нр╕▓р╕вр╕╕р╕Хр╣Ир╕│р╕Бр╕зр╣Ир╕▓ 16 р╕Ыр╕╡ \nЁЯН╜я╕П р╕Бр╕┤р╕Щр╕лр╕ер╕▒р╕Зр╕нр╕▓р╕лр╕▓р╕гр╣Ар╕Юр╕╖р╣Ир╕нр╕ер╕Фр╕Бр╕▓р╕гр╕гр╕░р╕Др╕▓р╕вр╣Ар╕Др╕╖р╕нр╕З';
    }
    
    if (message.includes('omeprazole') || message.includes('р╣Вр╕нр╣Ар╕бр╕Юр╕гр╕▓р╣Вр╕Лр╕е') || message.includes('р╕вр╕▓р╕Бр╕гр╕Фр╣Др╕лр╕ер╕вр╣Йр╕нр╕Щ')) {
      return 'Omeprazole (р╣Вр╕нр╣Ар╕бр╕Юр╕гр╕▓р╣Вр╕Лр╕е) - р╕вр╕▓р╕ер╕Фр╕Бр╕гр╕Фр╣Гр╕Щр╕Бр╕гр╕░р╣Ар╕Юр╕▓р╕░: \nЁЯТК р╣Гр╕Кр╣Йр╕кр╕│р╕лр╕гр╕▒р╕Ъ: р╣Бр╕Бр╣Йр╕Бр╕гр╕Фр╣Др╕лр╕ер╕вр╣Йр╕нр╕Щ р╣Бр╕Ьр╕ер╣Гр╕Щр╕Бр╕гр╕░р╣Ар╕Юр╕▓р╕░ \nЁЯН╜я╕П р╕зр╕┤р╕Шр╕╡р╣Гр╕Кр╣Й: р╕Бр╕┤р╕Щр╕Бр╣Ир╕нр╕Щр╕нр╕▓р╕лр╕▓р╕гр╣Ар╕Кр╣Йр╕▓ 30-60 р╕Щр╕▓р╕Чр╕╡ \nтП░ р╕гр╕░р╕вр╕░р╣Ар╕зр╕ер╕▓: р╣Др╕бр╣Ир╕Др╕зр╕гр╣Гр╕Кр╣Йр╕Щр╕▓р╕Щр╣Ар╕Бр╕┤р╕Щ 8 р╕кр╕▒р╕Ыр╕Фр╕▓р╕лр╣М \nтЪая╕П р╕Ьр╕ер╕Вр╣Йр╕▓р╕Зр╣Ар╕Др╕╡р╕вр╕З: р╕Ыр╕зр╕Фр╕лр╕▒р╕з р╕Чр╣Йр╕нр╕Зр╣Ар╕кр╕╡р╕в \nЁЯТб р╣Гр╕Кр╣Йр╕Щр╕▓р╕Щр╕нр╕▓р╕Ир╕кр╣Ир╕Зр╕Ьр╕ер╕Хр╣Ир╕нр╕Бр╕▓р╕гр╕Фр╕╣р╕Фр╕Лр╕╢р╕бр╣Бр╕Др╕ер╣Ар╕Лр╕╡р╕вр╕б';
    }
    
    // р╕Др╕│р╕Хр╕нр╕Ър╣Бр╕Ър╕Ър╕Зр╣Ир╕▓р╕вр╣Ж р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕│р╕Цр╕▓р╕бр╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Чр╕▒р╣Ир╕зр╣Др╕Ы
    if (message.includes('р╕Ыр╕зр╕Фр╕лр╕▒р╕з')) {
      return 'р╕кр╕│р╕лр╕гр╕▒р╕Ър╕нр╕▓р╕Бр╕▓р╕гр╕Ыр╕зр╕Фр╕лр╕▒р╕з р╣Бр╕Щр╕░р╕Щр╕│р╣Гр╕лр╣Й: \nтАв р╕Юр╕▒р╕Бр╕Ьр╣Ир╕нр╕Щр╣Гр╕лр╣Йр╣Ар╕Юр╕╡р╕вр╕Зр╕Юр╕н \nтАв р╕Фр╕╖р╣Ир╕бр╕Щр╣Йр╕│р╣Гр╕лр╣Йр╕бр╕▓р╕Б \nтАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╣Бр╕кр╕Зр╣Бр╕гр╕З \nтАв р╕Щр╕зр╕Фр╣Ар╕Ър╕▓р╣Ж р╕Чр╕╡р╣Ир╕Вр╕бр╕▒р╕Ъ \nтЪая╕П р╕лр╕▓р╕Бр╕Ыр╕зр╕Фр╕лр╕▒р╕зр╕гр╕╕р╕Щр╣Бр╕гр╕Зр╕лр╕гр╕╖р╕нр╕Щр╕▓р╕Щр╣Ар╕Бр╕┤р╕Щ 3 р╕зр╕▒р╕Щ р╕Др╕зр╕гр╕Ыр╕гр╕╢р╕Бр╕йр╕▓р╣Бр╕Юр╕Чр╕вр╣М';
    }

    // р╕Бр╕▓р╕гр╕ер╕Фр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б
    if (message.includes('р╕ер╕Фр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б') || message.includes('р╕Ьр╕нр╕б') || message.includes('р╕ер╕Ф weight')) {
      let response = 'тЪЦя╕П р╕зр╕┤р╕Шр╕╡р╕Бр╕▓р╕гр╕ер╕Фр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╕Чр╕╡р╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З:\n\n';
      response += 'ЁЯН╜я╕П р╕Бр╕▓р╕гр╕Бр╕┤р╕Щ:\n';
      response += 'тАв р╕ер╕Фр╣Бр╕Др╕ер╕нр╕гр╕╡р╣И 500-750 kcal/р╕зр╕▒р╕Щ\n';
      response += 'тАв р╕Бр╕┤р╕Щр╕Вр╣Йр╕▓р╕зр╕Бр╕ер╣Йр╕нр╕З р╣Бр╕Чр╕Щр╕Вр╣Йр╕▓р╕зр╕Вр╕▓р╕з\n';
      response += 'тАв р╣Ар╕Юр╕┤р╣Ир╕бр╕Ьр╕▒р╕Б р╕Ьр╕ер╣Др╕бр╣Й р╣Вр╕Ыр╕гр╕Хр╕╡р╕Щр╣Др╕бр╣Ир╕Хр╕┤р╕Фр╕бр╕▒р╕Щ\n';
      response += 'тАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕Вр╕нр╕Зр╕Чр╕▓р╕Щ р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕Фр╕╖р╣Ир╕бр╕лр╕зр╕▓р╕Щ\n';
      response += 'тАв р╕Бр╕┤р╕Щр╕Щр╣Йр╕нр╕вр╕бр╕╖р╣Йр╕н р╕Ър╣Ир╕нр╕вр╕Др╕гр╕▒р╣Йр╕З\n\n';
      
      response += 'ЁЯПГтАНтЩАя╕П р╕Бр╕▓р╕гр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕З:\n';
      response += 'тАв р╣Ар╕Фр╕┤р╕Щ-р╕зр╕┤р╣Ир╕З 30-45 р╕Щр╕▓р╕Чр╕╡/р╕зр╕▒р╕Щ\n';
      response += 'тАв р╕вр╕Бр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б 2-3 р╕зр╕▒р╕Щ/р╕кр╕▒р╕Ыр╕Фр╕▓р╕лр╣М\n';
      response += 'тАв р╣Ар╕Хр╣Йр╕Щр╣Бр╕нр╣Вр╕гр╕Ър╕┤р╕Д р╕кр╕зр╕┤р╕бр╕бр╕┤р╣Ир╕З\n\n';
      
      response += 'ЁЯУК р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в: р╕ер╕Ф 0.5-1 р╕Бр╕Б./р╕кр╕▒р╕Ыр╕Фр╕▓р╕лр╣М\n';
      response += 'ЁЯТз р╕Фр╕╖р╣Ир╕бр╕Щр╣Йр╕│ 3-4 р╕ер╕┤р╕Хр╕г/р╕зр╕▒р╕Щ\n';
      response += 'ЁЯШ┤ р╕Щр╕нр╕Щр╕лр╕ер╕▒р╕Ъ 7-8 р╕Кр╕▒р╣Ир╕зр╣Вр╕бр╕З/р╕Др╕╖р╕Щ';
      
      return response;
    }

    // р╕зр╕┤р╕Хр╕▓р╕бр╕┤р╕Щр╣Бр╕ер╕░р╕кр╕▓р╕гр╕нр╕▓р╕лр╕▓р╕г
    if (message.includes('р╕зр╕┤р╕Хр╕▓р╕бр╕┤р╕Щ') || message.includes('vitamin') || message.includes('р╕кр╕▓р╕гр╕нр╕▓р╕лр╕▓р╕г')) {
      let response = 'ЁЯТК р╕зр╕┤р╕Хр╕▓р╕бр╕┤р╕Щр╕Чр╕╡р╣Ир╕гр╣Ир╕▓р╕Зр╕Бр╕▓р╕вр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕г:\n\n';
      response += 'тШАя╕П р╕зр╕┤р╕Хр╕▓р╕бр╕┤р╕Щ D:\n';
      response += 'тАв р╕кр╕│р╕Др╕▒р╕Нр╕Хр╣Ир╕нр╕Бр╕гр╕░р╕Фр╕╣р╕Б р╕ар╕╣р╕бр╕┤р╕Др╕╕р╣Йр╕бр╕Бр╕▒р╕Щ\n';
      response += 'тАв р╣Бр╕лр╕ер╣Ир╕З: р╣Бр╕кр╕Зр╣Бр╕Фр╕Ф р╕Щр╕б р╕Ыр╕ер╕▓\n';
      response += 'тАв р╕Вр╕Щр╕▓р╕Ф: 800-1000 IU/р╕зр╕▒р╕Щ\n\n';
      
      response += 'ЁЯНК р╕зр╕┤р╕Хр╕▓р╕бр╕┤р╕Щ C:\n';
      response += 'тАв р╕Хр╣Йр╕▓р╕Щр╕нр╕Щр╕╕р╕бр╕╣р╕ер╕нр╕┤р╕кр╕гр╕░ р╕Кр╣Ир╕зр╕вр╕кр╕гр╣Йр╕▓р╕Зр╕Др╕нр╕ер╕ер╕▓р╣Ар╕Ир╕Щ\n';
      response += 'тАв р╣Бр╕лр╕ер╣Ир╕З: р╕кр╣Йр╕б р╕бр╕░р╕Щр╕▓р╕з р╕Эр╕гр╕▒р╣Ир╕З р╕Юр╕гр╕┤р╕Бр╕лр╕зр╕▓р╕Щ\n';
      response += 'тАв р╕Вр╕Щр╕▓р╕Ф: 90 mg/р╕зр╕▒р╕Щ (р╕Кр╕▓р╕в) 75 mg/р╕зр╕▒р╕Щ (р╕лр╕Нр╕┤р╕З)\n\n';
      
      response += 'ЁЯРЯ р╣Вр╕нр╣Ар╕бр╕Бр╣Йр╕▓ 3:\n';
      response += 'тАв р╕Фр╕╡р╕Хр╣Ир╕нр╕лр╕▒р╕зр╣Гр╕И р╕кр╕бр╕нр╕З\n';
      response += 'тАв р╣Бр╕лр╕ер╣Ир╕З: р╕Ыр╕ер╕▓р╕Чр╕░р╣Ар╕е р╕Цр╕▒р╣Ир╕зр╕зр╕нр╕ер╕Щр╕▒р╕Ч р╣Ар╕бр╕ер╣Зр╕Фр╣Ар╕Кр╕╡р╕в\n';
      response += 'тАв р╕Вр╕Щр╕▓р╕Ф: 250-500 mg/р╕зр╕▒р╕Щ\n\n';
      
      response += 'ЁЯем р╕Бр╕гр╕Фр╣Вр╕Яр╕ер╕┤р╕Д:\n';
      response += 'тАв р╕кр╕│р╕Др╕▒р╕Нр╕Хр╣Ир╕нр╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕Зр╣Ар╕бр╣Зр╕Фр╣Ар╕ер╕╖р╕нр╕Ф\n';
      response += 'тАв р╣Бр╕лр╕ер╣Ир╕З: р╕Ьр╕▒р╕Бр╣Гр╕Ър╣Ар╕Вр╕╡р╕вр╕з р╕Цр╕▒р╣Ир╕з\n';
      response += 'тАв р╕Вр╕Щр╕▓р╕Ф: 400 mcg/р╕зр╕▒р╕Щ';
      
      return response;
    }

    // р╕Др╕зр╕▓р╕бр╣Ар╕Др╕гр╕╡р╕вр╕Фр╣Бр╕ер╕░р╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Ир╕┤р╕Х
    if (message.includes('р╣Ар╕Др╕гр╕╡р╕вр╕Ф') || message.includes('stress') || message.includes('р╕Ир╕┤р╕Хр╣Гр╕И') || message.includes('р╕Лр╕╢р╕бр╣Ар╕ир╕гр╣Йр╕▓')) {
      return 'ЁЯза р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Др╕зр╕▓р╕бр╣Ар╕Др╕гр╕╡р╕вр╕Фр╣Бр╕ер╕░р╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Ир╕┤р╕Х:\n\n' +
             'ЁЯШМ р╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕ер╕Фр╣Ар╕Др╕гр╕╡р╕вр╕Ф:\n' +
             'тАв р╕лр╕▓р╕вр╣Гр╕Ир╕ер╕╢р╕Бр╣Ж 4-7-8 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡\n' +
             'тАв р╕кр╕бр╕▓р╕Шр╕┤ р╕Чр╕│р╣Гр╕Ир╣Гр╕лр╣Йр╕зр╣Ир╕▓р╕З 10-15 р╕Щр╕▓р╕Чр╕╡/р╕зр╕▒р╕Щ\n' +
             'тАв р╕Яр╕▒р╕Зр╣Ар╕Юр╕ер╕З р╕нр╣Ир╕▓р╕Щр╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕н\n' +
             'тАв р╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╕кр╕бр╣Ир╕│р╣Ар╕кр╕бр╕н\n\n' +
             'ЁЯдЭ р╕Бр╕▓р╕гр╕кр╕╖р╣Ир╕нр╕кр╕▓р╕г:\n' +
             'тАв р╕Юр╕╣р╕Фр╕Др╕╕р╕вр╕Бр╕▒р╕Ър╕Др╕Щр╣Гр╕Бр╕ер╣Йр╕Кр╕┤р╕Ф\n' +
             'тАв р╣Ар╕Вр╕╡р╕вр╕Щр╣Др╕Фр╕нр╕▓р╕гр╕╡р╣Ир╕гр╕░р╕Ър╕▓р╕вр╕Др╕зр╕▓р╕бр╕гр╕╣р╣Йр╕кр╕╢р╕Б\n' +
             'тАв р╕лр╕▓р╣Ар╕зр╕ер╕▓р╕Чр╕│р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╕Кр╕нр╕Ъ\n\n' +
             'тЪая╕П р╕лр╕▓р╕Бр╕бр╕╡р╕нр╕▓р╕Бр╕▓р╕г:\n' +
             'тАв р╣Ар╕ир╕гр╣Йр╕▓р╕Щр╕▓р╕Щр╣Ар╕Бр╕┤р╕Щ 2 р╕кр╕▒р╕Ыр╕Фр╕▓р╕лр╣М\n' +
             'тАв р╕Щр╕нр╕Щр╣Др╕бр╣Ир╕лр╕ер╕▒р╕Ъ р╕Бр╕┤р╕Щр╣Др╕бр╣Ир╣Др╕Фр╣Й\n' +
             'тАв р╕Др╕┤р╕Фр╕гр╣Йр╕▓р╕в р╕Др╕┤р╕Фр╕Чр╕│р╕гр╣Йр╕▓р╕вр╕Хр╕▒р╕зр╣Ар╕нр╕З\n' +
             'тЮбя╕П р╕Др╕зр╕гр╕Ыр╕гр╕╢р╕Бр╕йр╕▓р╕Ир╕┤р╕Хр╣Бр╕Юр╕Чр╕вр╣Мр╕Чр╕▒р╕Щр╕Чр╕╡';
    }

    // р╕Ьр╕┤р╕зр╕лр╕Щр╕▒р╕З
    if (message.includes('р╕Ьр╕┤р╕з') || message.includes('skin') || message.includes('р╕кр╕┤р╕з') || message.includes('р╕Ьр╕б')) {
      return 'тЬи р╕Бр╕▓р╕гр╕Фр╕╣р╣Бр╕ер╕Ьр╕┤р╕зр╕лр╕Щр╕▒р╕Зр╣Бр╕ер╕░р╣Ар╕кр╣Йр╕Щр╕Ьр╕б:\n\n' +
             'ЁЯз┤ р╕Ьр╕┤р╕зр╕лр╕Щр╣Йр╕▓:\n' +
             'тАв р╕ер╣Йр╕▓р╕Зр╕лр╕Щр╣Йр╕▓р╕зр╕▒р╕Щр╕ер╕░ 2 р╕Др╕гр╕▒р╣Йр╕З\n' +
             'тАв р╣Гр╕Кр╣Йр╕Др╕гр╕╡р╕бр╕Бр╕▒р╕Щр╣Бр╕Фр╕Ф SPF 30+ р╕Чр╕╕р╕Бр╕зр╕▒р╕Щ\n' +
             'тАв р╕бр╕нр╕вр╕кр╣Мр╣Ар╕Ир╕нр╣Др╕гр╣Ар╕Лр╕нр╕гр╣Мр╕Хр╕▓р╕бр╕Ыр╕гр╕░р╣Ар╕ар╕Чр╕Ьр╕┤р╕з\n' +
             'тАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╣Бр╕Хр╣Ир╕Зр╕лр╕Щр╣Йр╕▓р╕Др╣Йр╕▓р╕Зр╕Др╕╖р╕Щ\n\n' +
             'ЁЯз┤ р╣Ар╕кр╣Йр╕Щр╕Ьр╕б:\n' +
             'тАв р╕кр╕гр╕░р╕Ьр╕бр╕Чр╕╕р╕Бр╕зр╕▒р╕Щр╕лр╕гр╕╖р╕нр╕зр╕▒р╕Щр╣Ар╕зр╣Йр╕Щр╕зр╕▒р╕Щ\n' +
             'тАв р╣Гр╕Кр╣Йр╣Бр╕Кр╕бр╕Юр╕╣р╣Ар╕лр╕бр╕▓р╕░р╕Бр╕▒р╕Ър╕кр╕ар╕▓р╕Юр╕Ьр╕б\n' +
             'тАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕Щр╣Йр╕│р╕гр╣Йр╕нр╕Щр╕Ир╕▒р╕Ф\n' +
             'тАв р╕Чр╕гр╕╡р╕Чр╣Ар╕бр╕Щр╕Чр╣Мр╕кр╕▒р╕Ыр╕Фр╕▓р╕лр╣Мр╕ер╕░ 1-2 р╕Др╕гр╕▒р╣Йр╕З\n\n' +
             'ЁЯНО р╕нр╕▓р╕лр╕▓р╕гр╕Чр╕╡р╣Ир╕Фр╕╡р╕Хр╣Ир╕нр╕Ьр╕┤р╕з:\n' +
             'тАв р╕Ьр╕ер╣Др╕бр╣Йр╕кр╕╡р╕кр╣Йр╕б р╕зр╕┤р╕Хр╕▓р╕бр╕┤р╕Щ A\n' +
             'тАв р╕Цр╕▒р╣Ир╕з р╕зр╕┤р╕Хр╕▓р╕бр╕┤р╕Щ E\n' +
             'тАв р╕Ыр╕ер╕▓ р╣Вр╕нр╣Ар╕бр╕Бр╣Йр╕▓ 3\n' +
             'тАв р╕Щр╣Йр╕│ 8-10 р╣Бр╕Бр╣Йр╕з/р╕зр╕▒р╕Щ';
    }

    // р╕ар╕╣р╕бр╕┤р╣Бр╕Юр╣Й
    if (message.includes('р╕ар╕╣р╕бр╕┤р╣Бр╕Юр╣Й') || message.includes('р╣Бр╕Юр╣Й') || message.includes('allergy') || message.includes('р╕Др╕▒р╕Щ')) {
      return 'ЁЯдз р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕ар╕╣р╕бр╕┤р╣Бр╕Юр╣Й:\n\n' +
             'ЁЯФН р╕ар╕╣р╕бр╕┤р╣Бр╕Юр╣Йр╕нр╕▓р╕лр╕▓р╕г:\n' +
             'тАв р╕Хр╕┤р╕Фр╕Хр╕▓р╕бр╕нр╕▓р╕лр╕▓р╕гр╕Чр╕╡р╣Ир╕Бр╕┤р╕Щ\n' +
             'тАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕Бр╕╕р╣Йр╕З р╕Ыр╕╣ р╕лр╕нр╕в р╕Цр╕▒р╣Ир╕з\n' +
             'тАв р╕нр╣Ир╕▓р╕Щр╕Йр╕ер╕▓р╕Бр╕нр╕▓р╕лр╕▓р╕гр╕нр╕вр╣Ир╕▓р╕Зр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф\n' +
             'тАв р╕Юр╕Б EpiPen р╕Цр╣Йр╕▓р╣Бр╕Юр╣Йр╕гр╕╕р╕Щр╣Бр╕гр╕З\n\n' +
             'ЁЯМ╕ р╕ар╕╣р╕бр╕┤р╣Бр╕Юр╣Йр╕ер╕░р╕нр╕нр╕Зр╕Яр╕╣р╕Щ:\n' +
             'тАв р╕Ыр╕┤р╕Фр╕лр╕Щр╣Йр╕▓р╕Хр╣Ир╕▓р╕Зр╣Гр╕Щр╕Кр╣Ир╕зр╕Зр╣Ар╕Кр╣Йр╕▓\n' +
             'тАв р╣Гр╕Кр╣Йр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕Яр╕нр╕Бр╕нр╕▓р╕Бр╕▓р╕и\n' +
             'тАв р╕ер╣Йр╕▓р╕Зр╕лр╕Щр╣Йр╕▓р╕лр╕ер╕▒р╕Зр╕Бр╕ер╕▒р╕Ър╕Ър╣Йр╕▓р╕Щ\n' +
             'тАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕нр╕нр╕Бр╕Щр╕нр╕Бр╕Ър╣Йр╕▓р╕Щр╣Ар╕Кр╣Йр╕▓р╕Хр╕гр╕╣р╣И\n\n' +
             'ЁЯПа р╕Эр╕╕р╣Ир╕Щ р╣Др╕гр╕Эр╕╕р╣Ир╕Щ:\n' +
             'тАв р╕Фр╕╣р╕Фр╕Эр╕╕р╣Ир╕Щр╕Чр╕╡р╣Ир╕Щр╕нр╕Щр╕Чр╕╕р╕Бр╕кр╕▒р╕Ыр╕Фр╕▓р╕лр╣М\n' +
             'тАв р╕Лр╕▒р╕Бр╕Ьр╣Йр╕▓р╕Ыр╕╣р╕Чр╕╡р╣Ир╕Щр╕нр╕Щр╕Щр╣Йр╕│р╕гр╣Йр╕нр╕Щ\n' +
             'тАв р╕ер╕Фр╕Хр╕╕р╣Кр╕Бр╕Хр╕▓ р╕лр╕бр╕нр╕Щ\n' +
             'ЁЯТК р╕вр╕▓р╣Бр╕Бр╣Йр╣Бр╕Юр╣Й: Antihistamine';
    }

    // р╣Вр╕гр╕Др╕Ыр╕гр╕░р╕Ир╕│р╕др╕Фр╕╣
    if (message.includes('р╣Вр╕гр╕Др╕Ыр╕гр╕░р╕Ир╕│р╕др╕Фр╕╣') || message.includes('р╣Др╕Вр╣Йр╕лр╕зр╕▒р╕Ф') || message.includes('р╣Др╕Вр╣Йр╣Ар╕ер╕╖р╕нр╕Фр╕нр╕нр╕Б') || message.includes('р╕бр╕╖р╕нр╣Ар╕Чр╣Йр╕▓р╕Ыр╕▓р╕Б')) {
      return 'ЁЯМзя╕П р╣Вр╕гр╕Др╕Ыр╕гр╕░р╕Ир╕│р╕др╕Фр╕╣р╣Бр╕ер╕░р╕Бр╕▓р╕гр╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щ:\n\n' +
             'ЁЯжа р╣Др╕Вр╣Йр╕лр╕зр╕▒р╕Ф:\n' +
             'тАв р╕ер╣Йр╕▓р╕Зр╕бр╕╖р╕нр╕Ър╣Ир╕нр╕вр╣Ж\n' +
             'тАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕Др╕Щр╕Ыр╣Ир╕зр╕в\n' +
             'тАв р╕гр╕▒р╕Ър╕Ыр╕гр╕░р╕Чр╕▓р╕Щр╕зр╕┤р╕Хр╕▓р╕бр╕┤р╕Щ C\n' +
             'тАв р╕Юр╕▒р╕Бр╕Ьр╣Ир╕нр╕Щр╣Ар╕Юр╕╡р╕вр╕Зр╕Юр╕н\n\n' +
             'ЁЯжЯ р╣Др╕Вр╣Йр╣Ар╕ер╕╖р╕нр╕Фр╕нр╕нр╕Б:\n' +
             'тАв р╕Бр╕│р╕Ир╕▒р╕Фр╣Бр╕лр╕ер╣Ир╕Зр╕Щр╣Йр╕│р╕Вр╕▒р╕З\n' +
             'тАв р╣Гр╕Кр╣Йр╕бр╕╕р╣Йр╕З р╕вр╕▓р╣Др╕ер╣Ир╕вр╕╕р╕З\n' +
             'тАв р╕кр╕▒р╕Зр╣Ар╕Бр╕Хр╕нр╕▓р╕Бр╕▓р╕гр╣Др╕Вр╣Й р╕Ыр╕зр╕Фр╕лр╕▒р╕з\n' +
             'тАв р╕Фр╕╖р╣Ир╕бр╕Щр╣Йр╕│р╣Ар╕вр╕нр╕░р╣Ж\n\n' +
             'ЁЯС╢ р╕бр╕╖р╕нр╣Ар╕Чр╣Йр╕▓р╕Ыр╕▓р╕Б:\n' +
             'тАв р╣Ар╕Фр╣Зр╕Бр╣Ар╕ер╣Зр╕Бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З\n' +
             'тАв р╕ер╣Йр╕▓р╕Зр╕бр╕╖р╕нр╕Бр╣Ир╕нр╕Щ-р╕лр╕ер╕▒р╕Зр╕кр╕▒р╕бр╕Ьр╕▒р╕кр╣Ар╕Фр╣Зр╕Б\n' +
             'тАв р╕Чр╕│р╕Др╕зр╕▓р╕бр╕кр╕░р╕нр╕▓р╕Фр╕Вр╕нр╕Зр╣Ар╕ер╣Ир╕Щ\n' +
             'тАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕Чр╕╡р╣Ир╣Бр╕нр╕нр╕▒р╕Ф\n\n' +
             'тЪая╕П р╕бр╕╡р╣Др╕Вр╣Йр╕кр╕╣р╕З р╕Ыр╕зр╕Фр╕лр╕▒р╕зр╕гр╕╕р╕Щр╣Бр╕гр╕З тЮбя╕П р╕Юр╕Ър╣Бр╕Юр╕Чр╕вр╣М';
    }

    // р╕кр╕бр╕╕р╕Щр╣Др╕Юр╕г
    if (message.includes('р╕кр╕бр╕╕р╕Щр╣Др╕Юр╕г') || message.includes('herb') || message.includes('р╕Вр╕бр╕┤р╣Йр╕Щ') || message.includes('р╕Вр╕┤р╕З')) {
      return 'ЁЯМ┐ р╕кр╕бр╕╕р╕Щр╣Др╕Юр╕гр╣Ар╕Юр╕╖р╣Ир╕нр╕кр╕╕р╕Вр╕ар╕▓р╕Ю:\n\n' +
             'ЁЯЯб р╕Вр╕бр╕┤р╣Йр╕Щр╕Кр╕▒р╕Щ:\n' +
             'тАв р╕Хр╣Йр╕▓р╕Щр╕Бр╕▓р╕гр╕нр╕▒р╕Бр╣Ар╕кр╕Ъ\n' +
             'тАв р╕Кр╣Ир╕зр╕вр╕вр╣Ир╕нр╕вр╕нр╕▓р╕лр╕▓р╕г\n' +
             'тАв р╕зр╕┤р╕Шр╕╡р╣Гр╕Кр╣Й: р╕Кр╕Зр╕Щр╣Йр╕│р╕Фр╕╖р╣Ир╕б р╕Ьр╕кр╕бр╕Щр╕б\n\n' +
             'ЁЯЯд р╕Вр╕┤р╕З:\n' +
             'тАв р╣Бр╕Бр╣Йр╕Др╕ер╕╖р╣Ир╕Щр╣Др╕кр╣Й р╕лр╕зр╕Ф\n' +
             'тАв р╕Бр╕гр╕░р╕Хр╕╕р╣Йр╕Щр╕Бр╕▓р╕гр╣Др╕лр╕ер╣Ар╕зр╕╡р╕вр╕Щр╣Ар╕ер╕╖р╕нр╕Ф\n' +
             'тАв р╕зр╕┤р╕Шр╕╡р╣Гр╕Кр╣Й: р╕Кр╕Зр╕Кр╕▓ р╕Ыр╕гр╕╕р╕Зр╕нр╕▓р╕лр╕▓р╕г\n\n' +
             'ЁЯНп р╕Щр╣Йр╕│р╕Ьр╕╢р╣Йр╕З:\n' +
             'тАв р╣Бр╕Бр╣Йр╣Др╕н р╕Ър╕гр╕гр╣Ар╕Чр╕▓р╕нр╕▓р╕Бр╕▓р╕гр╕Др╕нр╕нр╕▒р╕Бр╣Ар╕кр╕Ъ\n' +
             'тАв р╕зр╕┤р╕Шр╕╡р╣Гр╕Кр╣Й: р╕Ьр╕кр╕бр╕Щр╣Йр╕│р╕нр╕╕р╣Ир╕Щ р╕бр╕░р╕Щр╕▓р╕з\n\n' +
             'ЁЯМ▒ р╣Гр╕Ър╕Ър╕▒р╕зр╕Ър╕Б:\n' +
             'тАв р╕Ър╕│р╕гр╕╕р╕Зр╕кр╕бр╕нр╕З р╣Ар╕Юр╕┤р╣Ир╕бр╕Др╕зр╕▓р╕бр╕Ир╕│\n' +
             'тАв р╕зр╕┤р╕Шр╕╡р╣Гр╕Кр╣Й: р╕Кр╕Зр╕Кр╕▓р╕Фр╕╖р╣Ир╕б\n\n' +
             'тЪая╕П р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕лр╕▓р╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Чр╣Йр╕нр╕З\n' +
             'ЁЯТК р╕лр╕▓р╕Бр╕Бр╕┤р╕Щр╕вр╕▓ р╕Др╕зр╕гр╕Ыр╕гр╕╢р╕Бр╕йр╕▓р╣Бр╕Юр╕Чр╕вр╣М';
    }

    // р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕╕р╕Вр╕ар╕▓р╕Ю
    if (message.includes('р╕Хр╕гр╕зр╕Ир╕кр╕╕р╕Вр╕ар╕▓р╕Ю') || message.includes('health check') || message.includes('р╕Хр╕гр╕зр╕Ир╕Ыр╕гр╕░р╕Ир╕│р╕Ыр╕╡')) {
      let response = 'ЁЯПе р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Н:\n\n';
      response += 'ЁЯУЕ р╕Хр╕гр╕зр╕Ир╕Ыр╕гр╕░р╕Ир╕│р╕Ыр╕╡ (р╕нр╕▓р╕вр╕╕ 35+ р╕Ыр╕╡):\n';
      response += 'тАв р╕Хр╕гр╕зр╕Ир╣Ар╕ер╕╖р╕нр╕Фр╕Др╕гр╕Ъ CBC, LFT, RFT\n';
      response += 'тАв р╣Др╕Вр╕бр╕▒р╕Щр╣Гр╕Щр╣Ар╕ер╕╖р╕нр╕Ф Lipid profile\n';
      response += 'тАв р╕Щр╣Йр╕│р╕Хр╕▓р╕ер╣Гр╕Щр╣Ар╕ер╕╖р╕нр╕Ф FBS\n';
      response += 'тАв р╕Хр╕гр╕зр╕Ир╕Ыр╕▒р╕кр╕кр╕▓р╕зр╕░ Urine\n';
      response += 'тАв р╣Ар╕нр╣Зр╕Бр╕Лр╣Ар╕гр╕вр╣Мр╕Чр╕гр╕зр╕Зр╕нр╕Б\n\n';
      
      response += 'ЁЯОп р╕Хр╕гр╕зр╕Ир╣Ар╕Йр╕Юр╕▓р╕░р╕Бр╕ер╕╕р╣Ир╕б:\n';
      response += 'тАв р╕Ьр╕╣р╣Йр╕лр╕Нр╕┤р╕З: Pap smear, р╕бр╕░р╣Ар╕гр╣Зр╕Зр╣Ар╕Хр╣Йр╕▓р╕Щр╕б\n';
      response += 'тАв р╕Ьр╕╣р╣Йр╕Кр╕▓р╕в: PSA (р╕нр╕▓р╕вр╕╕ 50+ р╕Ыр╕╡)\n';
      response += 'тАв р╕Фр╕зр╕Зр╕Хр╕▓: р╕Хр╕гр╕зр╕Ир╕Чр╕╕р╕Б 2 р╕Ыр╕╡\n';
      response += 'тАв р╕Яр╕▒р╕Щ: р╕Чр╕│р╕Др╕зр╕▓р╕бр╕кр╕░р╕нр╕▓р╕Фр╕Чр╕╕р╕Б 6 р╣Ар╕Фр╕╖р╕нр╕Щ\n\n';
      
      response += 'ЁЯФН р╕лр╕▓р╕Бр╕бр╕╡р╣Вр╕гр╕Др╕Ыр╕гр╕░р╕Ир╕│р╕Хр╕▒р╕з:\n';
      response += 'тАв р╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ: HbA1c р╕Чр╕╕р╕Б 3 р╣Ар╕Фр╕╖р╕нр╕Щ\n';
      response += 'тАв р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З: р╕зр╕▒р╕Фр╕Чр╕╕р╕Бр╕зр╕▒р╕Щ\n';
      response += 'тАв р╕лр╕▒р╕зр╣Гр╕И: Echo, EKG р╕Хр╕▓р╕бр╣Бр╕Юр╕Чр╕вр╣М\n';
      response += 'ЁЯТб р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕Кр╣Ир╕зр╕вр╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╣Вр╕гр╕Др╣Др╕Фр╣Йр╕Фр╕╡';
      
      return response;
    }

    // р╕нр╕▓р╕лр╕▓р╕гр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕╣р╣Йр╕Ыр╣Ир╕зр╕в
    if (message.includes('р╕нр╕▓р╕лр╕▓р╕гр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕╣р╣Йр╕Ыр╣Ир╕зр╕в') || message.includes('р╕нр╕▓р╕лр╕▓р╕гр╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ') || message.includes('р╕нр╕▓р╕лр╕▓р╕гр╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щ')) {
      let response = 'ЁЯН╜я╕П р╣Бр╕Щр╕░р╕Щр╕│р╕нр╕▓р╕лр╕▓р╕гр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕╣р╣Йр╕Ыр╣Ир╕зр╕в:\n\n';
      
      if (hasCondition('р╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ')) {
        response += 'ЁЯНп р╕нр╕▓р╕лр╕▓р╕гр╕кр╕│р╕лр╕гр╕▒р╕Ър╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ:\n';
        response += 'тЬЕ р╕Др╕зр╕гр╕Бр╕┤р╕Щ:\n';
        response += 'тАв р╕Вр╣Йр╕▓р╕зр╕Бр╕ер╣Йр╕нр╕З р╣Бр╕Ыр╣Йр╕Зр╣Др╕бр╣Ир╕Вр╕▒р╕Фр╕кр╕╡\n';
        response += 'тАв р╕Ыр╕ер╕▓ р╣Ар╕Щр╕╖р╣Йр╕нр╣Др╕бр╣Ир╕Хр╕┤р╕Фр╕бр╕▒р╕Щ\n';
        response += 'тАв р╕Ьр╕▒р╕Бр╣Гр╕Ър╣Ар╕Вр╕╡р╕вр╕з\n';
        response += 'тАв р╕Цр╕▒р╣Ир╕з р╣Ар╕бр╕ер╣Зр╕Фр╕Шр╕▒р╕Нр╕Юр╕╖р╕К\n\n';
        response += 'тЭМ р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕З:\n';
        response += 'тАв р╕Вр╕Щр╕бр╕лр╕зр╕▓р╕Щ р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕Фр╕╖р╣Ир╕бр╕лр╕зр╕▓р╕Щ\n';
        response += 'тАв р╕Вр╣Йр╕▓р╕зр╕Вр╕▓р╕з р╣Бр╕Ыр╣Йр╕Зр╕Вр╕▒р╕Фр╕кр╕╡\n';
        response += 'тАв р╕Ьр╕ер╣Др╕бр╣Йр╕лр╕зр╕▓р╕Щр╕бр╕▓р╕Б\n';
        response += 'тАв р╕нр╕▓р╕лр╕▓р╕гр╕Чр╕нр╕Ф р╕бр╕▒р╕Щр╣Ар╕вр╕нр╕░\n\n';
      }
      
      if (hasCondition('р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З')) {
        response += 'ЁЯТЧ р╕нр╕▓р╕лр╕▓р╕гр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З:\n';
        response += 'тЬЕ р╕Др╕зр╕гр╕Бр╕┤р╕Щ:\n';
        response += 'тАв р╕Ьр╕▒р╕Бр╕Ьр╕ер╣Др╕бр╣Й р╕бр╕╡р╣Вр╕Юр╣Бр╕Чр╕кр╣Ар╕Лр╕╡р╕вр╕б\n';
        response += 'тАв р╕Ыр╕ер╕▓ р╕Щр╕б р╣Вр╕вр╣Ар╕Бр╕┤р╕гр╣Мр╕Х\n';
        response += 'тАв р╕Шр╕▒р╕Нр╕Юр╕╖р╕Кр╣Ар╕Хр╣Зр╕бр╣Ар╕бр╕ер╣Зр╕Ф\n';
        response += 'тАв р╕Щр╣Йр╕│р╕бр╕▒р╕Щр╕бр╕░р╕Бр╕нр╕Б\n\n';
        response += 'тЭМ р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕З:\n';
        response += 'тАв р╣Ар╕Бр╕ер╕╖р╕н р╕Щр╣Йр╕│р╕Ыр╕ер╕▓ р╕Лр╕нр╕кр╣Бр╕Ыр╕гр╕гр╕╣р╕Ы\n';
        response += 'тАв р╕нр╕▓р╕лр╕▓р╕гр╕Бр╕гр╕░р╕Ыр╣Лр╕нр╕З\n';
        response += 'тАв р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕Фр╕╖р╣Ир╕бр╣Бр╕нр╕ер╕Бр╕нр╕ор╕нр╕ер╣М\n';
        response += 'тАв р╕нр╕▓р╕лр╕▓р╕гр╕Яр╕▓р╕кр╕Хр╣Мр╕Яр╕╣р╕Ф\n\n';
      }
      
      response += 'ЁЯеЧ р╕лр╕ер╕▒р╕Бр╕Бр╕▓р╕гр╕Бр╕┤р╕Щр╕Чр╕▒р╣Ир╕зр╣Др╕Ы:\n';
      response += 'тАв р╕Бр╕┤р╕Щр╕Др╕гр╕Ъ 5 р╕лр╕бр╕╣р╣И р╣Гр╕Щр╕кр╕▒р╕Фр╕кр╣Ир╕зр╕Щр╣Ар╕лр╕бр╕▓р╕░р╕кр╕б\n';
      response += 'тАв р╕Фр╕╖р╣Ир╕бр╕Щр╣Йр╕│ 8-10 р╣Бр╕Бр╣Йр╕з/р╕зр╕▒р╕Щ\n';
      response += 'тАв р╕Бр╕┤р╕Щр╕Вр╣Йр╕▓р╕зр╕Щр╣Йр╕нр╕вр╕ер╕З р╕Ьр╕▒р╕Бр╣Ар╕вр╕нр╕░р╕Вр╕╢р╣Йр╕Щ\n';
      response += 'тАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕нр╕▓р╕лр╕▓р╕гр╣Бр╕Ыр╕гр╕гр╕╣р╕Ы';
      
      return response;
    }

    if (message.includes('р╣Бр╕Др╕ер╣Ар╕Лр╕╡р╕вр╕б') || message.includes('calcium')) {
      return 'р╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ър╣Бр╕Др╕ер╣Ар╕Лр╕╡р╕вр╕б: \nтАв р╕Др╕зр╕▓р╕бр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕г: 1000-1200 mg/р╕зр╕▒р╕Щ \nтАв р╣Бр╕лр╕ер╣Ир╕Зр╕Шр╕гр╕гр╕бр╕Кр╕▓р╕Хр╕┤: р╕Щр╕б, р╕Ыр╕ер╕▓р╣Ар╕ер╣Зр╕Бр╕Ыр╕ер╕▓р╕Щр╣Йр╕нр╕в, р╕Ьр╕▒р╕Бр╣Гр╕Ър╣Ар╕Вр╕╡р╕вр╕з \nтАв р╕Др╕зр╕гр╕гр╕▒р╕Ър╕Ыр╕гр╕░р╕Чр╕▓р╕Щр╕Юр╕гр╣Йр╕нр╕бр╕зр╕┤р╕Хр╕▓р╕бр╕┤р╕Щ D \nтАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕Бр╕▓р╣Бр╕Яр╕бр╕▓р╕Бр╣Ар╕Бр╕┤р╕Щр╣Др╕Ы \nтШАя╕П р╣Бр╕кр╕Зр╣Бр╕Фр╕Фр╕Кр╣Ир╕зр╕вр╕Бр╕▓р╕гр╕Фр╕╣р╕Фр╕Лр╕╢р╕б';
    }
    
    if (message.includes('р╕Щр╕нр╕Щ') || message.includes('sleep')) {
      return 'р╕Бр╕▓р╕гр╕Щр╕нр╕Щр╕лр╕ер╕▒р╕Ър╕Чр╕╡р╣Ир╕Фр╕╡: \nтАв р╕Ьр╕╣р╣Йр╣Гр╕лр╕Нр╣И: 7-9 р╕Кр╕▒р╣Ир╕зр╣Вр╕бр╕З/р╕Др╕╖р╕Щ \nтАв р╣Ар╕Вр╣Йр╕▓р╕Щр╕нр╕Щр╣Ар╕зр╕ер╕▓р╣Ар╕Фр╕┤р╕бр╕Чр╕╕р╕Бр╕зр╕▒р╕Щ \nтАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕лр╕Щр╣Йр╕▓р╕Ир╕нр╕Бр╣Ир╕нр╕Щр╕Щр╕нр╕Щ 1 р╕Кр╕б \nтАв р╕лр╣Йр╕нр╕Зр╣Ар╕вр╣Зр╕Щ р╕бр╕╖р╕Ф р╣Ар╕Зр╕╡р╕вр╕Ъ \nЁЯШ┤ р╕Зр╕╡р╕Ър╕Бр╕ер╕▓р╕Зр╕зр╕▒р╕Щр╣Др╕бр╣Ир╣Ар╕Бр╕┤р╕Щ 30 р╕Щр╕▓р╕Чр╕╡';
    }
    
    // р╕Др╕│р╕Чр╕▒р╕Бр╕Чр╕▓р╕в
    if (message.includes('р╕кр╕зр╕▒р╕кр╕Фр╕╡') || message.includes('р╕лр╕зр╕▒р╕Фр╕Фр╕╡') || message.includes('hello') || 
        message.includes('hi') || message.includes('р╕Фр╕╡р╕Ир╣Йр╕▓') || message.includes('р╕Фр╕╡р╕Др╕гр╕▒р╕Ъ')) {
      let greeting = 'р╕кр╕зр╕▒р╕кр╕Фр╕╡р╕Др╕гр╕▒р╕Ъ! р╕вр╕┤р╕Щр╕Фр╕╡р╣Гр╕лр╣Йр╕Др╕│р╕Ыр╕гр╕╢р╕Бр╕йр╕▓р╣Ар╕гр╕╖р╣Ир╕нр╕Зр╕кр╕╕р╕Вр╕ар╕▓р╕Юр╣Бр╕ер╕░р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕вр╕▓ ЁЯТК\n\nЁЯФН р╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Цр╕▓р╕бр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ъ:\nтАв р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕вр╕▓р╕Чр╕▒р╣Ир╕зр╣Др╕Ы\nтАв р╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│р╕кр╕╕р╕Вр╕ар╕▓р╕Ю\nтАв р╕Др╣Ир╕▓р╕Ыр╕Бр╕Хр╕┤р╕Вр╕нр╕Зр╕гр╣Ир╕▓р╕Зр╕Бр╕▓р╕в';
      
      if (userProfile?.medical_conditions || userProfile?.medications) {
        greeting += '\n\nЁЯСд р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Вр╕нр╕Зр╕Др╕╕р╕У:';
        if (userProfile.medical_conditions) {
          greeting += `\nтАв р╣Вр╕гр╕Др╕Ыр╕гр╕░р╕Ир╕│р╕Хр╕▒р╕з: ${userProfile.medical_conditions}`;
        }
        if (userProfile.medications) {
          greeting += `\nтАв р╕вр╕▓р╕Чр╕╡р╣Ир╣Гр╕Кр╣Й: ${userProfile.medications}`;
        }
        greeting += '\nЁЯТб р╕Йр╕▒р╕Щр╕Ир╕░р╣Гр╕лр╣Йр╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│р╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░р╕Бр╕▒р╕Ър╕кр╕ар╕▓р╕Юр╕Др╕╕р╕Ур╣Вр╕Фр╕вр╣Ар╕Йр╕Юр╕▓р╕░';
      }
      
      greeting += '\n\nр╕бр╕╡р╕нр╕░р╣Др╕гр╕нр╕вр╕▓р╕Бр╕кр╕нр╕Ър╕Цр╕▓р╕бр╣Др╕лр╕бр╕Др╕гр╕▒р╕Ъ?';
      return greeting;
    }

    // р╕Др╕│р╕Хр╕нр╕Ър╕Чр╕▒р╣Ир╕зр╣Др╕Ыр╕Чр╕╡р╣Ир╕Йр╕ер╕▓р╕Фр╕Вр╕╢р╣Йр╕Щ - р╣Гр╕Кр╣Й AI р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╕Др╕│р╕Хр╕нр╕Ър╕Чр╕╡р╣Ир╕Др╕гр╕нр╕Ър╕Др╕ер╕╕р╕б
    const smartResponses = [
      // р╕Др╕│р╕Цр╕▓р╕бр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ър╕Бр╕▓р╕гр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕в
      {
        keywords: ['р╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕в', 'exercise', 'р╕зр╕┤р╣Ир╕З', 'р╣Ар╕Фр╕┤р╕Щ', 'р╕вр╕┤р╕б', 'р╣Вр╕вр╕Др╕░', 'р╕зр╣Ир╕▓р╕вр╕Щр╣Йр╕│'],
        response: () => {
          let response = 'ЁЯПГтАНтЩАя╕П р╣Бр╕Щр╕░р╕Щр╕│р╕Бр╕▓р╕гр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕в:\n\n';
          response += 'тП░ р╕Др╕зр╕▓р╕бр╕Цр╕╡р╣И: р╕нр╕вр╣Ир╕▓р╕Зр╕Щр╣Йр╕нр╕в 150 р╕Щр╕▓р╕Чр╕╡/р╕кр╕▒р╕Ыр╕Фр╕▓р╕лр╣М\n';
          response += 'тАв р╕Др╕▓р╕гр╣Мр╕Фр╕┤р╣Вр╕н 3-5 р╕зр╕▒р╕Щ/р╕кр╕▒р╕Ыр╕Фр╕▓р╕лр╣М\n';
          response += 'тАв р╕вр╕Бр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б 2-3 р╕зр╕▒р╕Щ/р╕кр╕▒р╕Ыр╕Фр╕▓р╕лр╣М\n';
          response += 'тАв р╕вр╕╖р╕Фр╣Ар╕лр╕вр╕╡р╕вр╕Ф р╕Чр╕╕р╕Бр╕зр╕▒р╕Щ\n\n';
          
          if (userProfile?.age) {
            const age = parseInt(userProfile.age);
            if (age >= 65) {
              response += 'ЁЯС╡ р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕╣р╣Йр╕кр╕╣р╕Зр╕нр╕▓р╕вр╕╕:\n';
              response += 'тАв р╣Ар╕Фр╕┤р╕Щр╣Ар╕гр╣Зр╕з р╕Щр╣Йр╕│р╕Хр╣Йр╕▓р╕Щ р╕Хр╕ер╕▓р╕Фр╕Щр╣Йр╕│\n';
              response += 'тАв р╣Др╕Чр╣Ар╕Бр╣Зр╕Б р╣Вр╕вр╕Др╕░\n';
              response += 'тАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕ер╣Йр╕б\n\n';
            } else if (age <= 40) {
              response += 'ЁЯТк р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕Щр╕лр╕Щр╕╕р╣Ир╕бр╕кр╕▓р╕з:\n';
              response += 'тАв HIIT р╕зр╣Ир╕▓р╕вр╕Щр╣Йр╕│ р╕Ыр╕▒р╣Ир╕Щр╕Ир╕▒р╕Бр╕гр╕вр╕▓р╕Щ\n';
              response += 'тАв р╕вр╕Бр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б р╕Ър╕┤р╕Фр╣Вр╕Фр╣Др╕Яр╣Др╕Щр╕Чр╣М\n';
              response += 'тАв р╕Бр╕╡р╕мр╕▓р╕Ыр╕гр╕░р╣Ар╕ар╕Чр╕Хр╣Ир╕▓р╕Зр╣Ж\n\n';
            }
          }
          
          if (hasCondition('р╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ')) {
            response += 'ЁЯНп р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕╣р╣Йр╕Ыр╣Ир╕зр╕вр╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ:\n';
            response += 'тАв р╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕лр╕ер╕▒р╕Зр╕нр╕▓р╕лр╕▓р╕г 30 р╕Щр╕▓р╕Ч\n';
            response += 'тАв р╕Хр╕гр╕зр╕Ир╕Щр╣Йр╕│р╕Хр╕▓р╕ер╕Бр╣Ир╕нр╕Щ-р╕лр╕ер╕▒р╕З\n';
            response += 'тАв р╕Юр╕Бр╕нр╕▓р╕лр╕▓р╕гр╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╕Щр╣Йр╕│р╕Хр╕▓р╕ер╕Хр╣Ир╕│\n\n';
          }
          
          if (hasCondition('р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З')) {
            response += 'ЁЯТЧ р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕╣р╣Йр╕Ыр╣Ир╕зр╕вр╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З:\n';
            response += 'тАв р╣Ар╕Фр╕┤р╕Щ р╕зр╕┤р╣Ир╕Зр╣Ар╕Ър╕▓р╣Ж р╕зр╣Ир╕▓р╕вр╕Щр╣Йр╕│\n';
            response += 'тАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕вр╕Бр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╕лр╕Щр╕▒р╕Б\n';
            response += 'тАв р╕зр╕нр╕гр╣Мр╕бр╕нр╕▒р╕Ю р╕Др╕╣р╕ер╕Фр╕▓р╕зр╕Щр╣Мр╣Гр╕лр╣Йр╕Фр╕╡\n\n';
          }
          
          response += 'тЪая╕П р╣Ар╕гр╕┤р╣Ир╕бр╕Ир╕▓р╕Бр╕Щр╣Йр╕нр╕вр╣Др╕Ыр╕бр╕▓р╕Б р╕лр╕вр╕╕р╕Фр╕лр╕▓р╕Бр╣Ар╕Ир╣Зр╕Ъ';
          return response;
        }
      },
      
      // р╕Др╕│р╕Цр╕▓р╕бр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ър╕нр╕▓р╕лр╕▓р╕г
      {
        keywords: ['р╕нр╕▓р╕лр╕▓р╕г', 'р╕Бр╕┤р╕Щ', 'food', 'р╕Чр╕▓р╕Щ', 'р╕гр╕▒р╕Ър╕Ыр╕гр╕░р╕Чр╕▓р╕Щ', 'nutrition'],
        response: () => {
          let response = 'ЁЯН╜я╕П р╣Бр╕Щр╕░р╕Щр╕│р╕Бр╕▓р╕гр╕гр╕▒р╕Ър╕Ыр╕гр╕░р╕Чр╕▓р╕Щр╕нр╕▓р╕лр╕▓р╕г:\n\n';
          response += 'ЁЯМИ р╕нр╕▓р╕лр╕▓р╕г 5 р╕лр╕бр╕╣р╣И:\n';
          response += 'тАв р╕лр╕бр╕╣р╣И 1: р╕Вр╣Йр╕▓р╕зр╕Бр╕ер╣Йр╕нр╕З р╕Вр╕Щр╕бр╕Ир╕╡р╕Щ (25%)\n';
          response += 'тАв р╕лр╕бр╕╣р╣И 2: р╕Ьр╕▒р╕Б р╣Гр╕Ър╣Ар╕Вр╕╡р╕вр╕з (25%)\n';
          response += 'тАв р╕лр╕бр╕╣р╣И 3: р╕Ыр╕ер╕▓ р╣Др╕Вр╣И р╕Цр╕▒р╣Ир╕з (25%)\n';
          response += 'тАв р╕лр╕бр╕╣р╣И 4: р╕Ьр╕ер╣Др╕бр╣Й (15%)\n';
          response += 'тАв р╕лр╕бр╕╣р╣И 5: р╕Щр╕б р╕Фр╕╖р╣Ир╕бр╕Щр╕б (10%)\n\n';
          
          response += 'тП░ р╣Ар╕зр╕ер╕▓р╕Чр╕▓р╕Щр╕нр╕▓р╕лр╕▓р╕г:\n';
          response += 'тАв р╣Ар╕Кр╣Йр╕▓: 6-8 р╣Вр╕бр╕З (25% р╣Бр╕Др╕ер╕нр╕гр╕╡р╣И)\n';
          response += 'тАв р╕Бр╕ер╕▓р╕Зр╕зр╕▒р╕Щ: 12-13 р╣Вр╕бр╕З (40%)\n';
          response += 'тАв р╣Ар╕вр╣Зр╕Щ: 18-19 р╣Вр╕бр╕З (35%)\n';
          response += 'тАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕Бр╕┤р╕Щр╕Фр╕╢р╕Бр╕лр╕ер╕▒р╕З 20.00\n\n';
          
          if (hasCondition('р╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ')) {
            response += 'ЁЯНп р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ:\n';
            response += 'тАв р╕Бр╕┤р╕Щр╕Др╕гр╕Ъ 3 р╕бр╕╖р╣Йр╕н р╕Хр╕гр╕Зр╣Ар╕зр╕ер╕▓\n';
            response += 'тАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕Щр╣Йр╕│р╕Хр╕▓р╕ер╣Ар╕Юр╕┤р╣Ир╕б\n';
            response += 'тАв р╣Ар╕ер╕╖р╕нр╕Бр╕Вр╣Йр╕▓р╕зр╕Бр╕ер╣Йр╕нр╕З р╣Бр╕Ыр╣Йр╕Зр╣Др╕бр╣Ир╕Вр╕▒р╕Фр╕кр╕╡\n\n';
          }
          
          if (hasCondition('р╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З')) {
            response += 'ЁЯТЧ р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕зр╕▓р╕бр╕Фр╕▒р╕Щр╕кр╕╣р╕З:\n';
            response += 'тАв р╕ер╕Фр╣Ар╕Бр╕ер╕╖р╕н < 6 р╕Бр╕гр╕▒р╕б/р╕зр╕▒р╕Щ\n';
            response += 'тАв р╣Ар╕Юр╕┤р╣Ир╕бр╣Вр╕Юр╣Бр╕Чр╕кр╣Ар╕Лр╕╡р╕вр╕б (р╕Бр╕ер╣Йр╕зр╕в)\n';
            response += 'тАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕нр╕▓р╕лр╕▓р╕гр╣Бр╕Ыр╕гр╕гр╕╣р╕Ы\n\n';
          }
          
          response += 'ЁЯТз р╕Фр╕╖р╣Ир╕бр╕Щр╣Йр╕│ 8-10 р╣Бр╕Бр╣Йр╕з/р╕зр╕▒р╕Щ\n';
          response += 'ЁЯЪл р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕З: р╕Чр╕нр╕Ф р╕бр╕▒р╕Щр╣Ар╕вр╕нр╕░ р╕лр╕зр╕▓р╕Щр╕Ир╕▒р╕Ф р╣Ар╕Др╣Зр╕бр╕Ир╕▒р╕Ф';
          return response;
        }
      },
      
      // р╕Др╕│р╕Цр╕▓р╕бр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ър╕Бр╕▓р╕гр╕Щр╕нр╕Щ
      {
        keywords: ['р╕Щр╕нр╕Щ', 'sleep', 'р╕лр╕ер╕▒р╕Ъ', 'р╕Щр╕нр╕Щр╣Др╕бр╣Ир╕лр╕ер╕▒р╕Ъ', 'insomnia'],
        response: () => {
          let response = 'ЁЯШ┤ р╕Бр╕▓р╕гр╕Щр╕нр╕Щр╕лр╕ер╕▒р╕Ър╕Чр╕╡р╣Ир╕бр╕╡р╕Др╕╕р╕Ур╕ар╕▓р╕Ю:\n\n';
          response += 'тП░ р╕Кр╕▒р╣Ир╕зр╣Вр╕бр╕Зр╕Бр╕▓р╕гр╕Щр╕нр╕Щ:\n';
          response += 'тАв р╕Ьр╕╣р╣Йр╣Гр╕лр╕Нр╣И: 7-9 р╕Кр╕▒р╣Ир╕зр╣Вр╕бр╕З/р╕Др╕╖р╕Щ\n';
          response += 'тАв р╕Ьр╕╣р╣Йр╕кр╕╣р╕Зр╕нр╕▓р╕вр╕╕: 7-8 р╕Кр╕▒р╣Ир╕зр╣Вр╕бр╕З/р╕Др╕╖р╕Щ\n';
          response += 'тАв р╣Ар╕Вр╣Йр╕▓р╕Щр╕нр╕Щ 22.00-23.00 р╕Щ.\n';
          response += 'тАв р╕Хр╕╖р╣Ир╕Щ 6.00-7.00 р╕Щ.\n\n';
          
          response += 'ЁЯЫПя╕П р╣Ар╕Хр╕гр╕╡р╕вр╕бр╕Бр╕▓р╕гр╕Щр╕нр╕Щ:\n';
          response += 'тАв р╕лр╣Йр╕нр╕Зр╣Ар╕вр╣Зр╕Щ 18-22┬░C\n';
          response += 'тАв р╕бр╕╖р╕Ф р╣Ар╕Зр╕╡р╕вр╕Ъ р╕кр╕░р╕Фр╕зр╕Бр╕кр╕Ър╕▓р╕в\n';
          response += 'тАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╣Бр╕кр╕Зр╕Щр╣Йр╕│р╣Ар╕Зр╕┤р╕Щ 1 р╕Кр╕б.р╕Бр╣Ир╕нр╕Щр╕Щр╕нр╕Щ\n';
          response += 'тАв р╕нр╣Ир╕▓р╕Щр╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕н р╕Яр╕▒р╕Зр╣Ар╕Юр╕ер╕Зр╣Ар╕Ър╕▓р╣Ж\n\n';
          
          response += 'тШХ р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╕Др╕зр╕гр╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕З:\n';
          response += 'тАв р╕Др╕▓р╣Ар╕Яр╕нр╕╡р╕Щр╕лр╕ер╕▒р╕З 14.00 р╕Щ.\n';
          response += 'тАв р╣Бр╕нр╕ер╕Бр╕нр╕ор╕нр╕ер╣Мр╕Бр╣Ир╕нр╕Щр╕Щр╕нр╕Щ\n';
          response += 'тАв р╕нр╕▓р╕лр╕▓р╕гр╕лр╕Щр╕▒р╕Бр╕Бр╣Ир╕нр╕Щр╕Щр╕нр╕Щ 3 р╕Кр╕б.\n';
          response += 'тАв р╕Зр╕╡р╕Ър╕Бр╕ер╕▓р╕Зр╕зр╕▒р╕Щр╣Ар╕Бр╕┤р╕Щ 30 р╕Щр╕▓р╕Чр╕╡\n\n';
          
          response += 'ЁЯзШтАНтЩАя╕П р╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕Кр╣Ир╕зр╕вр╕лр╕ер╕▒р╕Ъ:\n';
          response += 'тАв р╕лр╕▓р╕вр╣Гр╕Ир╕ер╕╢р╕Б 4-7-8\n';
          response += 'тАв р╕Чр╕│р╕кр╕бр╕▓р╕Шр╕┤\n';
          response += 'тАв р╕нр╣Ир╕▓р╕Щр╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕н\n';
          response += 'тЪая╕П р╕Щр╕нр╕Щр╣Др╕бр╣Ир╕лр╕ер╕▒р╕Ъ >2 р╕кр╕▒р╕Ыр╕Фр╕▓р╕лр╣М р╕Др╕зр╕гр╕Ыр╕гр╕╢р╕Бр╕йр╕▓р╣Бр╕Юр╕Чр╕вр╣М';
          return response;
        }
      },
      
      // р╕Др╕│р╕Цр╕▓р╕бр╕Бр╕▓р╕гр╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╣Вр╕гр╕Д
      {
        keywords: ['р╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щ', 'prevent', 'р╣Др╕бр╣Ир╣Гр╕лр╣Йр╣Ар╕Ыр╣Зр╕Щр╣Вр╕гр╕Д', 'р╕гр╕▒р╕Бр╕йр╕▓р╕кр╕╕р╕Вр╕ар╕▓р╕Ю'],
        response: () => {
          let response = 'ЁЯЫбя╕П р╕Бр╕▓р╕гр╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╣Вр╕гр╕Др╣Бр╕ер╕░р╕гр╕▒р╕Бр╕йр╕▓р╕кр╕╕р╕Вр╕ар╕▓р╕Ю:\n\n';
          response += 'ЁЯТЙ р╕Бр╕▓р╕гр╕Йр╕╡р╕Фр╕зр╕▒р╕Др╕Лр╕╡р╕Щ:\n';
          response += 'тАв р╣Др╕Вр╣Йр╕лр╕зр╕▒р╕Фр╣Гр╕лр╕Нр╣И р╕Чр╕╕р╕Бр╕Ыр╕╡\n';
          response += 'тАв р╕Ър╕▓р╕Фр╕Чр╕░р╕вр╕▒р╕Б р╕Чр╕╕р╕Б 10 р╕Ыр╕╡\n';
          response += 'тАв р╣Вр╕Др╕зр╕┤р╕Ф-19 р╕Хр╕▓р╕бр╣Бр╕Юр╕Чр╕вр╣Мр╣Бр╕Щр╕░р╕Щр╕│\n';
          response += 'тАв р╣Др╕Вр╣Йр╕лр╕зр╕▒р╕Фр╕Щр╕Б р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕ер╕╕р╣Ир╕бр╣Ар╕кр╕╡р╣Ир╕вр╕З\n\n';
          
          response += 'ЁЯз╝ р╕кр╕╕р╕Вр╕ер╕▒р╕Бр╕йр╕Ур╕░р╕кр╣Ир╕зр╕Щр╕Ър╕╕р╕Др╕Др╕е:\n';
          response += 'тАв р╕ер╣Йр╕▓р╕Зр╕бр╕╖р╕н 20 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡\n';
          response += 'тАв р╣Бр╕Ыр╕гр╕Зр╕Яр╕▒р╕Щр╕зр╕▒р╕Щр╕ер╕░ 2 р╕Др╕гр╕▒р╣Йр╕З\n';
          response += 'тАв р╕нр╕▓р╕Ър╕Щр╣Йр╕│р╕кр╕░р╕нр╕▓р╕Ф\n';
          response += 'тАв р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Ар╕кр╕╖р╣Йр╕нр╕Ьр╣Йр╕▓р╕Чр╕╕р╕Бр╕зр╕▒р╕Щ\n\n';
          
          response += 'ЁЯПГтАНтЩАя╕П р╕зр╕┤р╕Цр╕╡р╕Кр╕╡р╕зр╕┤р╕Хр╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Фр╕╡:\n';
          response += 'тАв р╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕вр╕кр╕бр╣Ир╕│р╣Ар╕кр╕бр╕н\n';
          response += 'тАв р╕Бр╕┤р╕Щр╕нр╕▓р╕лр╕▓р╕гр╕Др╕гр╕Ъ 5 р╕лр╕бр╕╣р╣И\n';
          response += 'тАв р╕Щр╕нр╕Щр╕лр╕ер╕▒р╕Ър╣Ар╕Юр╕╡р╕вр╕Зр╕Юр╕н\n';
          response += 'тАв р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Др╕зр╕▓р╕бр╣Ар╕Др╕гр╕╡р╕вр╕Ф\n';
          response += 'тАв р╕лр╕ер╕╡р╕Бр╣Ар╕ер╕╡р╣Ир╕вр╕Зр╕Ър╕╕р╕лр╕гр╕╡р╣И р╣Ар╕лр╕ер╣Йр╕▓\n\n';
          
          response += 'ЁЯПе р╕Хр╕гр╕зр╕Ир╕кр╕╕р╕Вр╕ар╕▓р╕Ю:\n';
          response += 'тАв р╕Ыр╕гр╕░р╕Ир╕│р╕Ыр╕╡ р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕Щр╕Ыр╕Бр╕Хр╕┤\n';
          response += 'тАв р╕Чр╕╕р╕Б 6 р╣Ар╕Фр╕╖р╕нр╕Щ р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕╣р╣Йр╕Ыр╣Ир╕зр╕вр╣Ар╕гр╕╖р╣Йр╕нр╕гр╕▒р╕З\n';
          response += 'тАв р╕Хр╕гр╕зр╕Ир╕бр╕░р╣Ар╕гр╣Зр╕З р╕Хр╕▓р╕бр╕нр╕▓р╕вр╕╕р╣Ар╕лр╕бр╕▓р╕░р╕кр╕б\n';
          response += 'ЁЯТб р╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╕Фр╕╡р╕Бр╕зр╣Ир╕▓р╕гр╕▒р╕Бр╕йр╕▓!';
          return response;
        }
      }
    ];

    // р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Хр╕гр╕Зр╕Бр╕▒р╕Ъ smart responses р╕лр╕гр╕╖р╕нр╣Др╕бр╣И
    for (const smartResponse of smartResponses) {
      if (smartResponse.keywords.some(keyword => message.includes(keyword))) {
        return smartResponse.response();
      }
    }

    // р╕Др╕│р╕Хр╕нр╕Ър╕Чр╕▒р╣Ир╕зр╣Др╕Ы
    return 'р╕Вр╕нр╕Ър╕Др╕╕р╕Ур╕кр╕│р╕лр╕гр╕▒р╕Ър╕Др╕│р╕Цр╕▓р╕бр╕Др╕гр╕▒р╕Ъ! р╕Ьр╕бр╣Гр╕лр╣Йр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕▒р╣Ир╕зр╣Др╕Ыр╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕вр╕▓р╣Ар╕Йр╕Юр╕▓р╕░р╕Ър╕╕р╕Др╕Др╕е р╣Бр╕Щр╕░р╕Щр╕│р╣Гр╕лр╣Йр╕Ыр╕гр╕╢р╕Бр╕йр╕▓р╣Ар╕ар╕кр╕▒р╕Кр╕Бр╕гр╕лр╕гр╕╖р╕нр╣Бр╕Юр╕Чр╕вр╣Мр╕Др╕гр╕▒р╕Ъ \n\nЁЯУЮ р╕лр╕▓р╕Бр╕бр╕╡р╕нр╕▓р╕Бр╕▓р╕гр╕Йр╕╕р╕Бр╣Ар╕Йр╕┤р╕Щ р╣Вр╕Чр╕г 1669 \nЁЯПе р╕лр╕▓р╕Бр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│р╣Ар╕Йр╕Юр╕▓р╕░р╕Ър╕╕р╕Др╕Др╕е р╕Др╕зр╕гр╕Юр╕Ър╣Бр╕Юр╕Чр╕вр╣М \nЁЯТК р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕вр╕▓: р╕Ыр╕гр╕╢р╕Бр╕йр╕▓р╣Ар╕ар╕кр╕▒р╕Кр╕Бр╕г\n\nЁЯТб р╕ер╕нр╕Зр╕Цр╕▓р╕бр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ъ:\nтАв "р╕кр╕╕р╕Вр╕ар╕▓р╕Юр╕Вр╕нр╕Зр╕Йр╕▒р╕Щ" - р╕Фр╕╣р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╣Ир╕зр╕Щр╕Хр╕▒р╕з\nтАв "р╕ер╕Фр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б" - р╕зр╕┤р╕Шр╕╡р╕ер╕Фр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╕Чр╕╡р╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З\nтАв "р╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕Зр╕Бр╕▓р╕в" - р╣Бр╕Щр╕░р╕Щр╕│р╕Бр╕▓р╕гр╕нр╕нр╕Бр╕Бр╕│р╕ер╕▒р╕З\nтАв "р╕нр╕▓р╕лр╕▓р╕гр╣Ар╕Ър╕▓р╕лр╕зр╕▓р╕Щ" - р╕нр╕▓р╕лр╕▓р╕гр╕кр╕│р╕лр╕гр╕▒р╕Ър╣Вр╕гр╕Др╕Хр╣Ир╕▓р╕Зр╣Ж';
  };

  const handleSendMessage = () => {
    if (!inputText.trim()) return;

    const userMessage = {
      id: Date.now(),
      text: inputText,
      sender: 'user',
      timestamp: new Date()
    };

    setMessages(prev => [...prev, userMessage]);
    setInputText('');
    setIsTyping(true);

    // р╕Ир╕│р╕ер╕нр╕Зр╕Бр╕▓р╕гр╕Юр╕┤р╕бр╕Юр╣Мр╕Вр╕нр╕Зр╕Ър╕нр╕Ч
    setTimeout(() => {
      const botResponse = {
        id: Date.now() + 1,
        text: getHealthAdvice(inputText),
        sender: 'bot',
        timestamp: new Date()
      };
      setMessages(prev => [...prev, botResponse]);
      setIsTyping(false);
    }, 1500);
  };

  const handleQuickResponse = (response) => {
    setInputText(response);
  };

  const handleKeyPress = (e) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      handleSendMessage();
    }
  };

  return (
    <>
      {/* Floating Chat Icon */}
      <div 
        className="fixed bottom-4 sm:bottom-6 right-4 sm:right-6 z-50"
        style={{ zIndex: 1000 }}
      >
        <button
          onClick={() => setIsOpen(!isOpen)}
          className="bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white p-3 sm:p-4 rounded-full shadow-2xl transition-all duration-300 transform hover:scale-110 border-4 border-white"
        >
          <span className="text-xl sm:text-2xl">ЁЯТм</span>
          {!isOpen && (
            <div className="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 sm:w-6 sm:h-6 flex items-center justify-center font-bold animate-pulse">
              !
            </div>
          )}
        </button>
      </div>

      {/* Chat Popup */}
      {isOpen && (
        <div 
          className="fixed bottom-16 sm:bottom-24 right-2 sm:right-6 w-[calc(100vw-1rem)] max-w-md sm:w-96 h-[34rem] sm:h-[38rem] bg-white rounded-2xl shadow-2xl border-2 border-blue-200 flex flex-col z-50"
          style={{ zIndex: 1000 }}
        >
          {/* Header */}
          <div className="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-3 sm:p-4 rounded-t-2xl flex items-center justify-between">
            <div className="flex items-center space-x-2">
              <span className="text-lg sm:text-xl">ЁЯПе</span>
              <div>
                <h3 className="font-bold text-xs sm:text-sm">р╕Ьр╕╣р╣Йр╕Кр╣Ир╕зр╕вр╕кр╕╕р╕Вр╕ар╕▓р╕Ю AI</h3>
                <p className="text-xs text-blue-100">р╕Юр╕гр╣Йр╕нр╕бр╣Гр╕лр╣Йр╕Др╕│р╕Ыр╕гр╕╢р╕Бр╕йр╕▓ 24/7</p>
              </div>
            </div>
            <button
              onClick={() => setIsOpen(false)}
              className="text-white hover:text-gray-200 text-lg sm:text-xl font-bold min-w-[44px] min-h-[44px] flex items-center justify-center"
            >
              ├Ч
            </button>
          </div>

          {/* Messages */}
          <div className="flex-1 overflow-y-auto p-3 sm:p-4 space-y-2 sm:space-y-3 bg-gradient-to-b from-blue-50/30 to-white touch-scroll">
            {messages.map((message) => (
              <div
                key={message.id}
                className={`flex ${message.sender === 'user' ? 'justify-end' : 'justify-start'}`}
              >
                <div
                  className={`max-w-[85%] sm:max-w-xs px-3 sm:px-4 py-2 rounded-xl text-xs sm:text-sm shadow-sm ${
                    message.sender === 'user'
                      ? 'bg-blue-500 text-white rounded-br-md'
                      : 'bg-white text-gray-800 rounded-bl-md border border-gray-200'
                  }`}
                >
                  <p className="whitespace-pre-line leading-relaxed">{message.text}</p>
                  <span className="text-xs opacity-70 block mt-1">
                    {message.timestamp.toLocaleTimeString('th-TH', { 
                      hour: '2-digit', 
                      minute: '2-digit' 
                    })}
                  </span>
                </div>
              </div>
            ))}
            
            {isTyping && (
              <div className="flex justify-start">
                <div className="bg-white text-gray-800 px-3 sm:px-4 py-2 rounded-xl rounded-bl-md text-xs sm:text-sm border border-gray-200 shadow-sm">
                  <span className="inline-flex space-x-1">
                    <span className="animate-bounce">тЧП</span>
                    <span className="animate-bounce delay-100">тЧП</span>
                    <span className="animate-bounce delay-200">тЧП</span>
                  </span>
                </div>
              </div>
            )}
            <div ref={messagesEndRef} />
          </div>

          {/* Quick Responses */}
          <div className="px-2 sm:px-3 py-2 border-t border-gray-200 bg-gray-50">
            <div className="text-xs text-gray-600 mb-2 font-medium">ЁЯТб р╕Др╕│р╕Цр╕▓р╕бр╣Бр╕Щр╕░р╕Щр╕│ (р╕Др╕ер╕┤р╕Бр╣Ар╕Юр╕╖р╣Ир╕нр╕Цр╕▓р╕б):</div>
            <div className="flex flex-wrap gap-1 max-h-20 overflow-y-auto">
              {quickResponses.map((response, index) => (
                <button
                  key={index}
                  onClick={() => handleQuickResponse(response)}
                  className="text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded-full hover:bg-blue-100 transition-colors border border-blue-200 min-h-[28px] hover:shadow-sm"
                >
                  {response}
                </button>
              ))}
            </div>
          </div>

          {/* Input */}
          <div className="p-3 sm:p-4 border-t border-gray-200 rounded-b-2xl bg-white">
            <div className="flex space-x-2">
              <input
                type="text"
                value={inputText}
                onChange={(e) => setInputText(e.target.value)}
                onKeyPress={handleKeyPress}
                placeholder="р╕Юр╕┤р╕бр╕Юр╣Мр╕Др╕│р╕Цр╕▓р╕бр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ър╕кр╕╕р╕Вр╕ар╕▓р╕Ю..."
                className="flex-1 px-3 sm:px-4 py-2 border border-gray-300 rounded-xl text-sm focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all"
              />
              <button
                onClick={handleSendMessage}
                disabled={!inputText.trim()}
                className="bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white px-3 sm:px-4 py-2 rounded-xl text-sm transition-colors shadow-sm min-w-[44px] min-h-[44px] flex items-center justify-center"
              >
                ЁЯУд
              </button>
            </div>
          </div>
        </div>
      )}
    </>
  );
};

export default HealthChatbot;
